---
title: "RBC - Bifactor models paper"
author: "Mauricio Hoffmann & Giovanni Salum"
date: "07/13/2020"
output: html_document
editor_options: 
  chunk_output_type: console
---

# Settings
```{r settings, message=FALSE, warning=FALSE}

#L ibraries
library(tidyverse); library(rio); library(naniar); library(dplyr); library(gridExtra); library(sjlabelled)

# Set WD
setwd("~/Dropbox/new data/RBC - P-factor paper/rbc-pfactor")

# Import data

#BHRC_SDQ_dom <- import(file="HRC_SDQ_YSI_dataset.sav")
#BHRC_CBCL_dom <- import(file="HRC_CBCL_dataset.sav")
#BHRC_data <- left_join(BHRC_SDQ_dom, BHRC_CBCL_dom, by=c("subjectid", "redcap_event_name"))


```

# Renaming variables for merging data in HBN
```{r Renaming variables for merging data in HBN, message=F, warning=F}
# Data
#HBN_data<-import(file="HBN_CBCL.csv")
HBN_data<-import(file="HBNdata_2020_12_03.csv") %>% as.data.frame()
HBN_data$EID <- str_replace(HBN_data$Identifiers, ",assessment", "")
HBN_data$EID <- str_replace(HBN_data$EID, ",", "")
HBN_data$EID <- str_replace(HBN_data$EID, "'", "")

#HBN_ksads <- read_csv("RAW_KSADS_v2.csv")  %>% as.data.frame() #PatientType= P=Parent Interview	T=Teen Interview	D=Clinician Consensus
#names(HBN_ksads) <- paste0("Q", names(HBN_ksads))
#HBN_ksads<-dplyr::rename(HBN_ksads,EID=QGUID)
#HBN_ksads<-dplyr::rename(HBN_ksads,Informant_KSADS=QPatientType)
#HBN_ksads <- HBN_ksads %>% dplyr::select(EID, Informant_KSADS, Q95, Q97, Q99, Q117, Q121, Q130, Q132, Q134, Q140, Q141, Q143, Q146, Q147, Q148, Q149, Q150, Q151, Q152, Q153, Q154, Q158, Q160, Q161, Q162, Q169, Q177, Q178, Q179, Q180, Q182, Q183, Q184, Q185, Q198, Q203, Q205, Q206, Q208, Q212, Q213, Q215, Q217, Q280, Q288, Q318, Q320, Q327, Q329, Q560, Q564, Q620, Q622, Q623, Q625, Q626, Q680, Q681, Q682, Q690, Q691, Q692, Q699, Q725, Q726, Q727, Q742, Q751, Q754, Q757, Q762, Q771, Q1348, Q1359, Q1360, Q1382, Q1466, Q1469, Q1497, Q1500, Q1505, Q1885)

## Code to recode all response variables to numeric levels or NAs
#HBN_ksads <- HBN_ksads %>% mutate_at(vars(starts_with("Q")),dplyr::funs(case_when(.=="No" ~ 0,.=="Yes" ~ 1)))

#HBN_ksads_T <- HBN_ksads %>% filter(Informant_KSADS=="T") %>% dplyr::select(-Informant_KSADS)
#names(HBN_ksads_T) <- paste0("KSADS_Self_", names(HBN_ksads_T))
#HBN_ksads_T<-dplyr::rename(HBN_ksads_T,EID=KSADS_Self_EID)

#HBN_ksads_D <- HBN_ksads %>% filter(Informant_KSADS=="D") %>% dplyr::select(-Informant_KSADS)
#names(HBN_ksads_D) <- paste0("KSADS_Clinician_", names(HBN_ksads_D))
#HBN_ksads_D<-dplyr::rename(HBN_ksads_D,EID=KSADS_Clinician_EID)

#HBN_ksads_P <- HBN_ksads %>% filter(Informant_KSADS=="P") %>% dplyr::select(-Informant_KSADS)
#names(HBN_ksads_P) <- paste0("KSADS_Parent_", names(HBN_ksads_P))
#HBN_ksads_P<-dplyr::rename(HBN_ksads_P,EID=KSADS_Parent_EID)

#HBN_data <- left_join(HBN_data, HBN_ksads_P, by="EID")
#HBN_data <- left_join(HBN_data, HBN_ksads_D, by="EID")
#HBN_data <- left_join(HBN_data, HBN_ksads_T, by="EID")
#rm(HBN_KSADS, HBN_KSADS_D, HBN_KSADS_P, HBN_KSADS_T)
# HBN demographics
#colnames(HBN_data)<-str_replace(colnames(HBN_data), "CBCL,EID", "EID")
colnames(HBN_data)<-str_replace(colnames(HBN_data), "Basic_Demos,Age", "Age"); HBN_data$Age <- as.numeric(HBN_data$Age)
HBN_data$Selection<-"Referred"
HBN_data<-HBN_data %>% mutate(Age_group_3cat = case_when(Age>=5 & Age<11 ~ "5_to_10", 
                                                      Age>=11& Age<15 ~ "11_to_14",
                                                      Age>=15 ~ "15_or_higher"))
HBN_data$Age_group_3cat <- ordered(HBN_data$Age_group_3cat, levels = c("5_to_10", "11_to_14", "15_or_higher")) 

colnames(HBN_data)<-str_replace(colnames(HBN_data), "Basic_Demos,Sex", "Gender")
HBN_data<-HBN_data %>% mutate(Gender = case_when(Gender=="0" ~ "Male", Gender=="1"~ "Female"))
HBN_data$Gender <- as.factor(HBN_data$Gender)

colnames(HBN_data)<-str_replace(colnames(HBN_data), "Basic_Demos,Study_Site", "Site")
HBN_data<-HBN_data %>% mutate(Site = case_when(Site=="1" ~ "HBN-1",
                                     Site=="2" ~ "HBN-2",
                                     Site=="3" ~ "HBN-3",
                                     Site=="4" ~ "HBN-4",
                                     Site=="5" ~ "HBN-5"))

HBN_data$Study<-"HBN"
#colnames(HBN_data)<-str_replace(colnames(HBN_data), "CBCL,Study", "Study")

HBN_data<-dplyr::rename(HBN_data,Child_race=`PreInt_Demos_Fam,Child_Race`)
HBN_data$Child_race <- as.numeric(HBN_data$Child_race)
summary.factor(HBN_data$Child_race)
HBN_data <- HBN_data %>% mutate(Child_race=car::recode(Child_race,"0='White';1='Black'; 2='Mixed';3='Asian';4='Asian'; 5='Native'; 6='Native'; 7='Native'; 8='Mixed'; 9='Other'; 10='Unknown'; 11='Other'"))
#0= White/Caucasian
#1= Black/African American
#8= Two or more races
#5= Native American Indian
#6= American Indian/Alaskan Native
#7= Native Hawaiian/Other Pacific Islander
#3= Asian
#9= Other race
#2= Hispanic
#4= Indian
#10= Unknown

# Rename ASEBA instruments
colnames(HBN_data)<-str_replace(colnames(HBN_data), "CBCL_Pre,CBCLpre", "CBCL_Pre")
colnames(HBN_data)<-str_replace(colnames(HBN_data), "CBCL_Pre,CBCLPre", "CBCL_Pre")
colnames(HBN_data)<-str_replace(colnames(HBN_data), "CBCL_Pre_0", "CBCL_Pre_")
colnames(HBN_data)<-str_replace(colnames(HBN_data), "CBCL,CBCL", "CBCL")
colnames(HBN_data)<-str_replace(colnames(HBN_data), "CBCL_0", "CBCL_")
HBN_data <-  HBN_data %>% mutate_at(vars(starts_with("CBCL")),as.numeric)  
colnames(HBN_data)<-str_replace(colnames(HBN_data), "TRF_Pre,TRF_P", "TRF_Pre")
colnames(HBN_data)<-str_replace(colnames(HBN_data), "TRF_Pre_0", "TRF_Pre_")
colnames(HBN_data)<-str_replace(colnames(HBN_data), "TRF,TRF", "TRF")
colnames(HBN_data)<-str_replace(colnames(HBN_data), "TRF_0", "TRF_")
HBN_data <-  HBN_data %>% mutate_at(vars(starts_with("TRF")),as.numeric)  
colnames(HBN_data)<-str_replace(colnames(HBN_data), "YSR,YSR", "YSR")
colnames(HBN_data)<-str_replace(colnames(HBN_data), "YSR_0", "YSR_")
HBN_data <-  HBN_data %>% mutate_at(vars(starts_with("YSR")),as.numeric)  

# Split files to harmonize ASEBA instruments to further merge them
HBN_data_key <- HBN_data %>% dplyr::select(EID, Age:Site, `ConsensusDx,DX_01`:`SDQ,Year`, `WAIS,WAIS_BD_SCALE`:`WISC,WISC_complete`, `demographics,DoB`:Study, CBCL_AB:CBCL_WD_T, CBCL_Pre_AB:CBCL_Pre_WD_T, TRF_AB:TRF_WD_T, TRF_Pre_AB:TRF_Pre_WD_T,  YSR_AB:YSR_WD_T)
HBN_data_key <- HBN_data_key[complete.cases(HBN_data_key[ ,4]),]

HBN_data_cbcl <- HBN_data %>% dplyr::select(EID, CBCL_1:CBCL_99)
HBN_data_cbcl <- HBN_data_cbcl[complete.cases(HBN_data_cbcl[ ,2]),]

HBN_data_cbclpre <- HBN_data %>% dplyr::select(EID, CBCL_Pre_1:CBCL_Pre_99)
HBN_data_cbclpre <- HBN_data_cbclpre[complete.cases(HBN_data_cbclpre[ ,2]),]

HBN_data_trf <- HBN_data %>% dplyr::select(EID, TRF_1:TRF_99)
HBN_data_trf <- HBN_data_trf[complete.cases(HBN_data_trf[ ,2]),]

HBN_data_trfpre <- HBN_data %>% dplyr::select(EID, TRF_Pre_1:TRF_Pre_99)
HBN_data_trfpre <- HBN_data_trfpre[complete.cases(HBN_data_trfpre[ ,2]),]

HBN_data_ysr <- HBN_data %>% dplyr::select(EID, YSR_1:YSR_99)
HBN_data_ysr <- HBN_data_ysr[complete.cases(HBN_data_ysr[ ,2]),]
# Merge CBCL and CBCL_pre and order items
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_1=CBCL_Pre_2)
HBN_data_cbclpre$CBCL_2<-NA
HBN_data_cbclpre$CBCL_3<-NA
HBN_data_cbclpre$CBCL_4<-NA
HBN_data_cbclpre$CBCL_5<-NA
HBN_data_cbclpre$CBCL_6<-NA
HBN_data_cbclpre$CBCL_7<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_8=CBCL_Pre_5)
HBN_data_cbclpre$CBCL_9<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_10=CBCL_Pre_6)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_11=CBCL_Pre_10)
HBN_data_cbclpre$CBCL_12<-NA
HBN_data_cbclpre$CBCL_13<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_14=CBCL_Pre_13)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_15=CBCL_Pre_14)
HBN_data_cbclpre$CBCL_16<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_17=CBCL_Pre_95)
HBN_data_cbclpre$CBCL_18<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_19=CBCL_Pre_96)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_20=CBCL_Pre_17)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_21=CBCL_Pre_18)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_22=CBCL_Pre_20)
HBN_data_cbclpre$CBCL_23<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_24=CBCL_Pre_22)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_25=CBCL_Pre_25)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_26=CBCL_Pre_27)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_27=CBCL_Pre_30)
HBN_data_cbclpre$CBCL_28<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_29=CBCL_Pre_32)
HBN_data_cbclpre$CBCL_30<-NA
HBN_data_cbclpre$CBCL_31<-NA
HBN_data_cbclpre$CBCL_32<-NA
HBN_data_cbclpre$CBCL_33<-NA
HBN_data_cbclpre$CBCL_34<-NA
HBN_data_cbclpre$CBCL_35<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_36=CBCL_Pre_34)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_37=CBCL_Pre_35)
HBN_data_cbclpre$CBCL_38<-NA
HBN_data_cbclpre$CBCL_39<-NA
HBN_data_cbclpre$CBCL_40<-NA
HBN_data_cbclpre$CBCL_41<-NA
HBN_data_cbclpre$CBCL_42<-NA
HBN_data_cbclpre$CBCL_43<-NA
HBN_data_cbclpre$CBCL_44<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_45=CBCL_Pre_47)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_46=CBCL_Pre_46)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_47=CBCL_Pre_48)
HBN_data_cbclpre$CBCL_48<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_49=CBCL_Pre_12)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_50=CBCL_Pre_87)
HBN_data_cbclpre$CBCL_51<-NA
HBN_data_cbclpre$CBCL_52<-NA
HBN_data_cbclpre$CBCL_53<-NA
HBN_data_cbclpre$CBCL_54<-NA
HBN_data_cbclpre$CBCL_55<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_56A=CBCL_Pre_1)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_56B=CBCL_Pre_39)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_56C=CBCL_Pre_45)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_56D=CBCL_Pre_57)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_56E=CBCL_Pre_60)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_56F=CBCL_Pre_78)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_56G=CBCL_Pre_93)
HBN_data_cbclpre<-HBN_data_cbclpre %>% mutate(CBCL_Pre_19 = car::recode(CBCL_Pre_19, "NA=99"))
HBN_data_cbclpre<-HBN_data_cbclpre %>% mutate(CBCL_Pre_52 = car::recode(CBCL_Pre_52, "NA=99"))
HBN_data_cbclpre <- HBN_data_cbclpre %>%  mutate(CBCL_56H=
            case_when(CBCL_Pre_19==99 & CBCL_Pre_52==99 ~ NA_real_,
                      (CBCL_Pre_19==2 | CBCL_Pre_52==2) ~ 2,
                      (CBCL_Pre_19==1 | CBCL_Pre_52==1) & 
                       (CBCL_Pre_19!=2 | CBCL_Pre_52!=2) ~ 1,
                      TRUE ~ 0))
HBN_data_cbclpre<-HBN_data_cbclpre %>% mutate(CBCL_19 = car::recode(CBCL_Pre_19, "NA=99"))
HBN_data_cbclpre<-HBN_data_cbclpre %>% mutate(CBCL_52 = car::recode(CBCL_Pre_52, "NA=99"))
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_57=CBCL_Pre_53)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_58=CBCL_Pre_54)
HBN_data_cbclpre$CBCL_59<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_60=CBCL_Pre_55)
HBN_data_cbclpre$CBCL_61<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_62=CBCL_Pre_56)
HBN_data_cbclpre$CBCL_63<-NA
HBN_data_cbclpre$CBCL_64<-NA
HBN_data_cbclpre$CBCL_65<-NA
HBN_data_cbclpre$CBCL_66<-NA
HBN_data_cbclpre$CBCL_67<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_68=CBCL_Pre_66)
HBN_data_cbclpre$CBCL_69<-NA
HBN_data_cbclpre$CBCL_70<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_71=CBCL_Pre_68)
HBN_data_cbclpre$CBCL_72<-NA
HBN_data_cbclpre$CBCL_73<-NA
HBN_data_cbclpre$CBCL_74<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_75=CBCL_Pre_73)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_76=CBCL_Pre_74)
HBN_data_cbclpre$CBCL_77<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_78=CBCL_Pre_59)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_79=CBCL_Pre_76)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_80=CBCL_Pre_77)
HBN_data_cbclpre$CBCL_81<-NA
HBN_data_cbclpre$CBCL_82<-NA
HBN_data_cbclpre$CBCL_83<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_84=CBCL_Pre_80)
HBN_data_cbclpre$CBCL_85<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_86=CBCL_Pre_81)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_87=CBCL_Pre_82)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_88=CBCL_Pre_83)
HBN_data_cbclpre$CBCL_89<-NA
HBN_data_cbclpre$CBCL_90<-NA
HBN_data_cbclpre$CBCL_91<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_92=CBCL_Pre_84)
HBN_data_cbclpre$CBCL_93<-NA
HBN_data_cbclpre$CBCL_94<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_95=CBCL_Pre_85)
HBN_data_cbclpre$CBCL_96<-NA
HBN_data_cbclpre$CBCL_97<-NA
HBN_data_cbclpre$CBCL_98<-NA
HBN_data_cbclpre$CBCL_99<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_100=CBCL_Pre_38)
HBN_data_cbclpre$CBCL_101<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_102=CBCL_Pre_89)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_103=CBCL_Pre_90)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_104=CBCL_Pre_91)
HBN_data_cbclpre$CBCL_105<-NA
HBN_data_cbclpre$CBCL_106<-NA
HBN_data_cbclpre$CBCL_107<-NA
HBN_data_cbclpre$CBCL_108<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_109=CBCL_Pre_97)
HBN_data_cbclpre$CBCL_110<-NA
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_111=CBCL_Pre_98)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_112=CBCL_Pre_99)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_113A=CBCL_Pre_100a)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_113B=CBCL_Pre_100b)
HBN_data_cbclpre<-dplyr::rename(HBN_data_cbclpre,CBCL_113C=CBCL_Pre_100c)

cbcl_var_list <- list(names(HBN_data_cbcl)); cbcl_var_list <- cbcl_var_list[[1]]
HBN_data_cbclpre<- HBN_data_cbclpre %>% dplyr::select(cbcl_var_list)
HBN_data_cbcl <- rbind(HBN_data_cbcl, HBN_data_cbclpre)

# Merge TRF and TRF_pre and order items

HBN_data_trf<-dplyr::rename(HBN_data_trf,TRF_56A=TRF_56a)
HBN_data_trf<-dplyr::rename(HBN_data_trf,TRF_56B=TRF_56b)
HBN_data_trf<-dplyr::rename(HBN_data_trf,TRF_56C=TRF_56c)
HBN_data_trf<-dplyr::rename(HBN_data_trf,TRF_56D=TRF_56d)
HBN_data_trf<-dplyr::rename(HBN_data_trf,TRF_56E=TRF_56e)
HBN_data_trf<-dplyr::rename(HBN_data_trf,TRF_56F=TRF_56f)
HBN_data_trf<-dplyr::rename(HBN_data_trf,TRF_56G=TRF_56g)
HBN_data_trf<-dplyr::rename(HBN_data_trf,TRF_56H=TRF_56h)
HBN_data_trf<-dplyr::rename(HBN_data_trf,TRF_113A=TRF_113a)
HBN_data_trf<-dplyr::rename(HBN_data_trf,TRF_113B=TRF_113b)
HBN_data_trf<-dplyr::rename(HBN_data_trf,TRF_113C=TRF_113c)

HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_1=TRF_Pre_2)
HBN_data_trfpre$TRF_2<-NA
HBN_data_trfpre$TRF_3<-NA
HBN_data_trfpre$TRF_4<-NA
HBN_data_trfpre$TRF_5<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_6=TRF_Pre_15)
HBN_data_trfpre$TRF_7<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_8=TRF_Pre_5)
HBN_data_trfpre$TRF_9<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_10=TRF_Pre_6)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_11=TRF_Pre_10)
HBN_data_trfpre$TRF_12<-NA
HBN_data_trfpre$TRF_13<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_14=TRF_Pre_13)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_15=TRF_Pre_51)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_16=TRF_Pre_22)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_17=TRF_Pre_19)
HBN_data_trfpre$TRF_18<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_19=TRF_Pre_96)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_20=TRF_Pre_17)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_21=TRF_Pre_18)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_22=TRF_Pre_24)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_23=TRF_Pre_20)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_24=TRF_Pre_28)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_25=TRF_Pre_25)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_26=TRF_Pre_27)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_27=TRF_Pre_30)
HBN_data_trfpre$TRF_28<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_29=TRF_Pre_32)
HBN_data_trfpre$TRF_30<-NA
HBN_data_trfpre$TRF_31<-NA
HBN_data_trfpre$TRF_32<-NA
HBN_data_trfpre$TRF_33<-NA
HBN_data_trfpre$TRF_34<-NA
HBN_data_trfpre$TRF_35<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_36=TRF_Pre_34)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_37=TRF_Pre_35)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_38=TRF_Pre_52)
HBN_data_trfpre$TRF_39<-NA
HBN_data_trfpre$TRF_40<-NA
HBN_data_trfpre$TRF_41<-NA
HBN_data_trfpre$TRF_42<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_43=TRF_Pre_65)
HBN_data_trfpre$TRF_44<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_45=TRF_Pre_47)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_46=TRF_Pre_46)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_47=TRF_Pre_79)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_48=TRF_Pre_74)
HBN_data_trfpre$TRF_49<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_50=TRF_Pre_87)
HBN_data_trfpre$TRF_51<-NA
HBN_data_trfpre$TRF_52<-NA
HBN_data_trfpre$TRF_53<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_54=TRF_Pre_50)
HBN_data_trfpre$TRF_55<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_56A=TRF_Pre_1)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_56B=TRF_Pre_39)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_56C=TRF_Pre_45)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_56D=TRF_Pre_57)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_56E=TRF_Pre_60)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_56F=TRF_Pre_78)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_56G=TRF_Pre_93)
HBN_data_trfpre$TRF_56H<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_57=TRF_Pre_53)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_58=TRF_Pre_54)
HBN_data_trfpre$TRF_59<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_60=TRF_Pre_12)
HBN_data_trfpre$TRF_61<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_62=TRF_Pre_56)
HBN_data_trfpre$TRF_63<-NA
HBN_data_trfpre$TRF_64<-NA
HBN_data_trfpre$TRF_65<-NA
HBN_data_trfpre$TRF_66<-NA
HBN_data_trfpre$TRF_67<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_68=TRF_Pre_66)
HBN_data_trfpre$TRF_69<-NA
HBN_data_trfpre$TRF_70<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_71=TRF_Pre_68)
HBN_data_trfpre$TRF_72<-NA
HBN_data_trfpre$TRF_73<-NA
HBN_data_trfpre$TRF_74<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_75=TRF_Pre_73)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_76=TRF_Pre_38)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_77=TRF_Pre_16)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_78=TRF_Pre_64)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_79=TRF_Pre_76)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_80=TRF_Pre_77)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_81=TRF_Pre_33)
HBN_data_trfpre$TRF_82<-NA
HBN_data_trfpre$TRF_83<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_84=TRF_Pre_80)
HBN_data_trfpre$TRF_85<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_86=TRF_Pre_81)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_87=TRF_Pre_82)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_88=TRF_Pre_83)
HBN_data_trfpre$TRF_89<-NA
HBN_data_trfpre$TRF_90<-NA
HBN_data_trfpre$TRF_91<-NA
HBN_data_trfpre$TRF_92<-NA
HBN_data_trfpre$TRF_93<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_94=TRF_Pre_84)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_95=TRF_Pre_85)
HBN_data_trfpre$TRF_96<-NA
HBN_data_trfpre$TRF_97<-NA
HBN_data_trfpre$TRF_98<-NA
HBN_data_trfpre$TRF_99<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_100=TRF_Pre_48)
HBN_data_trfpre$TRF_101<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_102=TRF_Pre_89)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_103=TRF_Pre_90)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_104=TRF_Pre_91)
HBN_data_trfpre$TRF_105<-NA
HBN_data_trfpre$TRF_106<-NA
HBN_data_trfpre$TRF_107<-NA
HBN_data_trfpre$TRF_108<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_109=TRF_Pre_97)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_110=TRF_Pre_94)
HBN_data_trfpre$TRF_111<-NA
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_112=TRF_Pre_98)
HBN_data_trfpre<-dplyr::rename(HBN_data_trfpre,TRF_113A=TRF_Pre_99)
HBN_data_trfpre$TRF_113B<-NA
HBN_data_trfpre$TRF_113C<-NA

trf_var_list <- list(names(HBN_data_trf)); trf_var_list <- trf_var_list[[1]]
HBN_data_trfpre <- HBN_data_trfpre %>% dplyr::select(trf_var_list)
HBN_data_trf <- rbind(HBN_data_trf, HBN_data_trfpre)

# RowBIND data sets

HBN_data_aseba <- left_join(HBN_data_cbcl, HBN_data_trf, by="EID")
HBN_data_aseba <- left_join(HBN_data_aseba, HBN_data_ysr, by="EID")
HBN_data <- left_join(HBN_data_key, HBN_data_aseba, by="EID")
rm(HBN_data_key, HBN_data_cbcl, HBN_data_cbclpre, HBN_data_trf, HBN_data_trfpre, HBN_data_ysr, HBN_data_aseba, cbcl_var_list, trf_var_list)


#CBCL
HBN_data<-HBN_data %>% mutate(CBCL_113A = car::recode(CBCL_113A, "NA=99"))
HBN_data<-HBN_data %>% mutate(CBCL_113B = car::recode(CBCL_113B, "NA=99"))
HBN_data<-HBN_data %>% mutate(CBCL_113C = car::recode(CBCL_113C, "NA=99"))
HBN_data <- HBN_data %>%  mutate(CBCL_113=
            case_when((CBCL_1!=1 & CBCL_1!=2 & CBCL_1!=0) & CBCL_113A==99 &CBCL_113B==99 &CBCL_113C==99 ~ NA_real_,
                      (CBCL_1==1 | CBCL_1==2 | CBCL_1==0) & CBCL_113A==99 &CBCL_113B==99 &CBCL_113C==99 ~ 0,
                      CBCL_113A==0 & CBCL_113B==0 & CBCL_113C==0 ~ 0,
                      CBCL_113A==2 |CBCL_113B==2 |CBCL_113C==2 ~ 2,
                      (CBCL_113A==1 |CBCL_113B==1 |CBCL_113C==1) & 
                      (CBCL_113A!=2 |CBCL_113B!=2 |CBCL_113C!=2) ~ 1))
HBN_data<-HBN_data %>% mutate(CBCL_113A = car::recode(CBCL_113A, "99=NA"))
HBN_data<-HBN_data %>% mutate(CBCL_113B = car::recode(CBCL_113B, "99=NA"))
HBN_data<-HBN_data %>% mutate(CBCL_113C = car::recode(CBCL_113C, "99=NA"))

HBN_data<-HBN_data %>% mutate(CBCL_56A = car::recode(CBCL_56A, "NA=99"))
HBN_data<-HBN_data %>% mutate(CBCL_56B = car::recode(CBCL_56B, "NA=99"))
HBN_data<-HBN_data %>% mutate(CBCL_56C = car::recode(CBCL_56C, "NA=99"))
HBN_data<-HBN_data %>% mutate(CBCL_56D = car::recode(CBCL_56D, "NA=99"))
HBN_data<-HBN_data %>% mutate(CBCL_56E = car::recode(CBCL_56E, "NA=99"))
HBN_data<-HBN_data %>% mutate(CBCL_56F = car::recode(CBCL_56F, "NA=99"))
HBN_data<-HBN_data %>% mutate(CBCL_56G = car::recode(CBCL_56G, "NA=99"))
HBN_data<-HBN_data %>% mutate(CBCL_56H = car::recode(CBCL_56H, "NA=99"))
HBN_data <- HBN_data %>%  mutate(CBCL_56=
            case_when(CBCL_56A==99 &CBCL_56B==99 &CBCL_56C==99 &CBCL_56D==99 &
                       CBCL_56E==99 &CBCL_56F==99 &CBCL_56G==99 &CBCL_56H==99 ~ NA_real_,
                      (CBCL_56A==2 |CBCL_56B==2 |CBCL_56C==2 |CBCL_56D==2 |
                       CBCL_56E==2 |CBCL_56F==2 |CBCL_56G==2 |CBCL_56H==2) ~ 2,
                      (CBCL_56A==1 |CBCL_56B==1 |CBCL_56C==1 |CBCL_56D==1 |
                       CBCL_56E==1 |CBCL_56F==1 |CBCL_56G==1 |CBCL_56H==1) & 
                       (CBCL_56A!=2 |CBCL_56B!=2 |CBCL_56C!=2 |CBCL_56D!=2 |
                       CBCL_56E!=2 |CBCL_56F!=2 |CBCL_56G!=2 |CBCL_56H!=2) ~ 1,
                       CBCL_56A==0 &CBCL_56B==0 &CBCL_56C==0 &CBCL_56D==0 &
                       CBCL_56E==0 &CBCL_56F==0 &CBCL_56G==0 &CBCL_56H==0 ~ 0))
HBN_data<-HBN_data %>% mutate(CBCL_56A = car::recode(CBCL_56A, "99=NA"))
HBN_data<-HBN_data %>% mutate(CBCL_56B = car::recode(CBCL_56B, "99=NA"))
HBN_data<-HBN_data %>% mutate(CBCL_56C = car::recode(CBCL_56C, "99=NA"))
HBN_data<-HBN_data %>% mutate(CBCL_56D = car::recode(CBCL_56D, "99=NA"))
HBN_data<-HBN_data %>% mutate(CBCL_56E = car::recode(CBCL_56E, "99=NA"))
HBN_data<-HBN_data %>% mutate(CBCL_56F = car::recode(CBCL_56F, "99=NA"))
HBN_data<-HBN_data %>% mutate(CBCL_56G = car::recode(CBCL_56G, "99=NA"))

HBN_data<-HBN_data %>% mutate(CBCL_56 = car::recode(CBCL_56, "NA=99"))
HBN_data <- HBN_data %>% mutate(CBCL_56H= 
                case_when(CBCL_56H==1 ~ 1,
                          CBCL_56H==2 ~ 2,
                          CBCL_56H==0 ~ 0,
                          CBCL_56!=99 & CBCL_56H==99  ~ 0,
                          CBCL_56==99 & CBCL_56H==99  ~ NA_real_))
HBN_data<-HBN_data %>% mutate(CBCL_56 = car::recode(CBCL_56, "99=NA"))
HBN_data<-HBN_data %>% mutate(CBCL_56H = car::recode(CBCL_56H, "99=NA"))
HBN_data<-HBN_data %>% mutate(CBCL_19 = car::recode(CBCL_19, "99=NA"))
HBN_data <- HBN_data %>%mutate_at(vars(starts_with("CBCL")),ordered) 

#TRF 

HBN_data<-HBN_data %>% mutate(TRF_113A = car::recode(TRF_113A, "NA=99"))
HBN_data<-HBN_data %>% mutate(TRF_113B = car::recode(TRF_113B, "NA=99"))
HBN_data<-HBN_data %>% mutate(TRF_113C = car::recode(TRF_113C, "NA=99"))
HBN_data <- HBN_data %>%  mutate(TRF_113=
            case_when((TRF_1!=1 & TRF_1!=2 & TRF_1!=0) & TRF_113A==99 &TRF_113B==99 &TRF_113C==99 ~ NA_real_,
                      (TRF_1==1 | TRF_1==2 | TRF_1==0) & TRF_113A==99 &TRF_113B==99 &TRF_113C==99 ~ 0,
                      TRF_113A==0 & TRF_113B==0 & TRF_113C==0 ~ 0,
                      TRF_113A==2 |TRF_113B==2 |TRF_113C==2 ~ 2,
                      (TRF_113A==1 |TRF_113B==1 |TRF_113C==1) & 
                      (TRF_113A!=2 |TRF_113B!=2 |TRF_113C!=2) ~ 1))
HBN_data<-HBN_data %>% mutate(TRF_113A = car::recode(TRF_113A, "99=NA"))
HBN_data<-HBN_data %>% mutate(TRF_113B = car::recode(TRF_113B, "99=NA"))
HBN_data<-HBN_data %>% mutate(TRF_113C = car::recode(TRF_113C, "99=NA"))

HBN_data<-HBN_data %>% mutate(TRF_56A = car::recode(TRF_56A, "NA=99"))
HBN_data<-HBN_data %>% mutate(TRF_56B = car::recode(TRF_56B, "NA=99"))
HBN_data<-HBN_data %>% mutate(TRF_56C = car::recode(TRF_56C, "NA=99"))
HBN_data<-HBN_data %>% mutate(TRF_56D = car::recode(TRF_56D, "NA=99"))
HBN_data<-HBN_data %>% mutate(TRF_56E = car::recode(TRF_56E, "NA=99"))
HBN_data<-HBN_data %>% mutate(TRF_56F = car::recode(TRF_56F, "NA=99"))
HBN_data<-HBN_data %>% mutate(TRF_56G = car::recode(TRF_56G, "NA=99"))
HBN_data<-HBN_data %>% mutate(TRF_56H = car::recode(TRF_56H, "NA=99"))
HBN_data <- HBN_data %>%  mutate(TRF_56=
            case_when(TRF_56A==99 &TRF_56B==99 &TRF_56C==99 &TRF_56D==99 &
                       TRF_56E==99 &TRF_56F==99 &TRF_56G==99 &TRF_56H==99 ~ NA_real_,
                      (TRF_56A==2 |TRF_56B==2 |TRF_56C==2 |TRF_56D==2 |
                       TRF_56E==2 |TRF_56F==2 |TRF_56G==2 |TRF_56H==2) ~ 2,
                      (TRF_56A==1 |TRF_56B==1 |TRF_56C==1 |TRF_56D==1 |
                       TRF_56E==1 |TRF_56F==1 |TRF_56G==1 |TRF_56H==1) & 
                       (TRF_56A!=2 |TRF_56B!=2 |TRF_56C!=2 |TRF_56D!=2 |
                       TRF_56E!=2 |TRF_56F!=2 |TRF_56G!=2 |TRF_56H!=2) ~ 1,
                      TRUE ~ 0))
HBN_data<-HBN_data %>% mutate(TRF_56A = car::recode(TRF_56A, "99=NA"))
HBN_data<-HBN_data %>% mutate(TRF_56B = car::recode(TRF_56B, "99=NA"))
HBN_data<-HBN_data %>% mutate(TRF_56C = car::recode(TRF_56C, "99=NA"))
HBN_data<-HBN_data %>% mutate(TRF_56D = car::recode(TRF_56D, "99=NA"))
HBN_data<-HBN_data %>% mutate(TRF_56E = car::recode(TRF_56E, "99=NA"))
HBN_data<-HBN_data %>% mutate(TRF_56F = car::recode(TRF_56F, "99=NA"))
HBN_data<-HBN_data %>% mutate(TRF_56G = car::recode(TRF_56G, "99=NA"))

HBN_data<-HBN_data %>% mutate(TRF_56 = car::recode(TRF_56, "NA=99"))
HBN_data <- HBN_data %>% mutate(TRF_56H= 
                case_when(TRF_56H==1 ~ 1,
                          TRF_56H==2 ~ 2,
                          TRF_56H==0 ~ 0,
                          TRF_56!=99 & TRF_56H==99  ~ 0,
                          TRF_56==99 & TRF_56H==99  ~ NA_real_))
HBN_data<-HBN_data %>% mutate(TRF_56 = car::recode(TRF_56, "99=NA"))
HBN_data<-HBN_data %>% mutate(TRF_56H = car::recode(TRF_56H, "99=NA"))
HBN_data <- HBN_data %>%mutate_at(vars(starts_with("TRF")),ordered) 

#YSR
HBN_data<-dplyr::rename(HBN_data,YSR_56A=YSR_56a)
HBN_data<-dplyr::rename(HBN_data,YSR_56B=YSR_56b)
HBN_data<-dplyr::rename(HBN_data,YSR_56C=YSR_56c)
HBN_data<-dplyr::rename(HBN_data,YSR_56D=YSR_56d)
HBN_data<-dplyr::rename(HBN_data,YSR_56E=YSR_56e)
HBN_data<-dplyr::rename(HBN_data,YSR_56F=YSR_56f)
HBN_data<-dplyr::rename(HBN_data,YSR_56G=YSR_56g)
HBN_data<-dplyr::rename(HBN_data,YSR_56H=YSR_56h)

HBN_data<-HBN_data %>% mutate(YSR_56A = car::recode(YSR_56A, "NA=99"))
HBN_data<-HBN_data %>% mutate(YSR_56B = car::recode(YSR_56B, "NA=99"))
HBN_data<-HBN_data %>% mutate(YSR_56C = car::recode(YSR_56C, "NA=99"))
HBN_data<-HBN_data %>% mutate(YSR_56D = car::recode(YSR_56D, "NA=99"))
HBN_data<-HBN_data %>% mutate(YSR_56E = car::recode(YSR_56E, "NA=99"))
HBN_data<-HBN_data %>% mutate(YSR_56F = car::recode(YSR_56F, "NA=99"))
HBN_data<-HBN_data %>% mutate(YSR_56G = car::recode(YSR_56G, "NA=99"))
HBN_data<-HBN_data %>% mutate(YSR_56H = car::recode(YSR_56H, "NA=99"))
HBN_data <- HBN_data %>%  mutate(YSR_56=
            case_when(YSR_56A==99 &YSR_56B==99 &YSR_56C==99 &YSR_56D==99 &
                       YSR_56E==99 &YSR_56F==99 &YSR_56G==99 &YSR_56H==99 ~ NA_real_,
                      (YSR_56A==2 |YSR_56B==2 |YSR_56C==2 |YSR_56D==2 |
                       YSR_56E==2 |YSR_56F==2 |YSR_56G==2 |YSR_56H==2) ~ 2,
                      (YSR_56A==1 |YSR_56B==1 |YSR_56C==1 |YSR_56D==1 |
                       YSR_56E==1 |YSR_56F==1 |YSR_56G==1 |YSR_56H==1) & 
                       (YSR_56A!=2 |YSR_56B!=2 |YSR_56C!=2 |YSR_56D!=2 |
                       YSR_56E!=2 |YSR_56F!=2 |YSR_56G!=2 |YSR_56H!=2) ~ 1,
                      TRUE ~ 0))
HBN_data<-HBN_data %>% mutate(YSR_56A = car::recode(YSR_56A, "99=NA"))
HBN_data<-HBN_data %>% mutate(YSR_56B = car::recode(YSR_56B, "99=NA"))
HBN_data<-HBN_data %>% mutate(YSR_56C = car::recode(YSR_56C, "99=NA"))
HBN_data<-HBN_data %>% mutate(YSR_56D = car::recode(YSR_56D, "99=NA"))
HBN_data<-HBN_data %>% mutate(YSR_56E = car::recode(YSR_56E, "99=NA"))
HBN_data<-HBN_data %>% mutate(YSR_56F = car::recode(YSR_56F, "99=NA"))
HBN_data<-HBN_data %>% mutate(YSR_56G = car::recode(YSR_56G, "99=NA"))

HBN_data<-HBN_data %>% mutate(YSR_56 = car::recode(YSR_56, "NA=99"))
HBN_data <- HBN_data %>% mutate(YSR_56H= 
                case_when(YSR_56H==1 ~ 1,
                          YSR_56H==2 ~ 2,
                          YSR_56H==0 ~ 0,
                          YSR_56!=99 & YSR_56H==99  ~ 0,
                          YSR_56==99 & YSR_56H==99  ~ NA_real_))
HBN_data<-HBN_data %>% mutate(YSR_56 = car::recode(YSR_56, "99=NA"))
HBN_data<-HBN_data %>% mutate(YSR_56H = car::recode(YSR_56H, "99=NA"))
HBN_data <- HBN_data %>%mutate_at(vars(starts_with("YSR")),ordered) 

#SDQ 
colnames(HBN_data)<-str_replace(colnames(HBN_data), "SDQ,SDQ_0", "pSDQ_")
colnames(HBN_data)<-str_replace(colnames(HBN_data), "SDQ,SDQ_", "pSDQ_")
HBN_data <-  HBN_data %>% mutate_at(vars(starts_with("pSDQ")),as.numeric)  
#HBN_data$pSDQ_7 <- 2-HBN_data$pSDQ_7 # seems already reverse coded
#HBN_data$pSDQ_21 <- 2-HBN_data$pSDQ_21 # seems already reverse coded
#HBN_data$pSDQ_25 <- 2-HBN_data$pSDQ_25 # seems already reverse coded
HBN_data <- HBN_data %>%  mutate(pSDQ_26b=
            case_when(pSDQ_28==0 ~ 0,
                      pSDQ_28==1 ~ 1,
                      pSDQ_28==2 ~ 2,
                      pSDQ_26==0 ~ 0)) # Distress
HBN_data <- HBN_data %>%  mutate(pSDQ_26c=
            case_when(pSDQ_29_a==0 ~ 0,
                      pSDQ_29_a==1 ~ 1,
                      pSDQ_29_a==2 ~ 2,
                      pSDQ_26==0 ~ 0)) # Home
HBN_data <- HBN_data %>%  mutate(pSDQ_26d=
            case_when(pSDQ_29_b==0 ~ 0,
                      pSDQ_29_b==1 ~ 1,
                      pSDQ_29_b==2 ~ 2,
                      pSDQ_26==0 ~ 0)) # Friendship
HBN_data <- HBN_data %>%  mutate(pSDQ_26e=
            case_when(pSDQ_29_c==0 ~ 0,
                      pSDQ_29_c==1 ~ 1,
                      pSDQ_29_c==2 ~ 2,
                      pSDQ_26==0 ~ 0)) # Classrom
HBN_data <- HBN_data %>%  mutate(pSDQ_26f=
            case_when(pSDQ_29_d==0 ~ 0,
                      pSDQ_29_d==1 ~ 1,
                      pSDQ_29_d==2 ~ 2,
                      pSDQ_26==0 ~ 0)) # Leisure

HBN_data <- HBN_data %>%mutate_at(vars(starts_with("pSDQ")),ordered) 

#Diagnosis Any
HBN_data$`Diagnosis_ClinicianConsensus,NoDX` <- as.numeric(HBN_data$`Diagnosis_ClinicianConsensus,NoDX`)
HBN_data<-dplyr::rename(HBN_data,DIAG_ANY=`Diagnosis_ClinicianConsensus,NoDX`)
HBN_data <- HBN_data %>% mutate(DIAG_ANY=car::recode(DIAG_ANY,"1=0;2=1;3=NA"))
#Diagnosis specifics
HBN_data<-dplyr::rename(HBN_data,DX_01=`Diagnosis_ClinicianConsensus,DX_01`)
HBN_data<-dplyr::rename(HBN_data,DX_02=`Diagnosis_ClinicianConsensus,DX_02`)
HBN_data<-dplyr::rename(HBN_data,DX_03=`Diagnosis_ClinicianConsensus,DX_03`)
HBN_data<-dplyr::rename(HBN_data,DX_04=`Diagnosis_ClinicianConsensus,DX_04`)
HBN_data<-dplyr::rename(HBN_data,DX_05=`Diagnosis_ClinicianConsensus,DX_05`)
HBN_data<-dplyr::rename(HBN_data,DX_06=`Diagnosis_ClinicianConsensus,DX_06`)
HBN_data<-dplyr::rename(HBN_data,DX_07=`Diagnosis_ClinicianConsensus,DX_07`)
HBN_data<-dplyr::rename(HBN_data,DX_08=`Diagnosis_ClinicianConsensus,DX_08`)
HBN_data<-dplyr::rename(HBN_data,DX_09=`Diagnosis_ClinicianConsensus,DX_09`)
HBN_data<-dplyr::rename(HBN_data,DX_10=`Diagnosis_ClinicianConsensus,DX_10`)

HBN_data <- HBN_data %>%  mutate(DIAG_SEP_ANX=
            case_when(DX_01=="Separation Anxiety"|DX_02=="Separation Anxiety"|
                       DX_03=="Separation Anxiety"|DX_04=="Separation Anxiety"|
                       DX_05=="Separation Anxiety"|DX_06=="Separation Anxiety"|
                       DX_07=="Separation Anxiety"|DX_08=="Separation Anxiety"|
                       DX_09=="Separation Anxiety"|DX_10=="Separation Anxiety" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 & (DX_01!="Separation Anxiety"&DX_02!="Separation Anxiety"&
                                     DX_03!="Separation Anxiety"&DX_04!="Separation Anxiety"&
                                     DX_05!="Separation Anxiety"&DX_06!="Separation Anxiety"&
                                     DX_07!="Separation Anxiety"&DX_08!="Separation Anxiety"&
                                     DX_09!="Separation Anxiety"&DX_10!="Separation Anxiety") ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

HBN_data <- HBN_data %>%  mutate(DIAG_SPEC_PHOB=
            case_when(DX_01=="Specific Phobia "|DX_02=="Specific Phobia "|DX_03=="Specific Phobia "|
                       DX_04=="Specific Phobia "|DX_05=="Specific Phobia "|DX_06=="Specific Phobia "|
                       DX_07=="Specific Phobia "|DX_08=="Specific Phobia "|DX_09=="Specific Phobia "|
                       DX_10=="Specific Phobia " ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 & (DX_01!="Specific Phobia "&DX_02!="Specific Phobia "&
                                      DX_03!="Specific Phobia "&DX_04!="Specific Phobia "&
                                      DX_05!="Specific Phobia "&DX_06!="Specific Phobia "&
                                      DX_07!="Specific Phobia "&DX_08!="Specific Phobia "&
                                      DX_09!="Specific Phobia "&DX_10!="Specific Phobia ") ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

HBN_data <- HBN_data %>%  mutate(DIAG_SOC_PHOB=
            case_when(DX_01=="Social Anxiety (Social Phobia)"|DX_02=="Social Anxiety (Social Phobia)"|
                       DX_03=="Social Anxiety (Social Phobia)"|DX_04=="Social Anxiety (Social Phobia)"|
                       DX_05=="Social Anxiety (Social Phobia)"|DX_06=="Social Anxiety (Social Phobia)"|
                       DX_07=="Social Anxiety (Social Phobia)"|DX_08=="Social Anxiety (Social Phobia)"|
                       DX_09=="Social Anxiety (Social Phobia)"|DX_10=="Social Anxiety (Social Phobia)" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 & (DX_01!="Social Anxiety (Social Phobia)"&
                                     DX_02!="Social Anxiety (Social Phobia)"&
                                     DX_03!="Social Anxiety (Social Phobia)"&
                                     DX_04!="Social Anxiety (Social Phobia)"&
                                     DX_05!="Social Anxiety (Social Phobia)"&
                                     DX_06!="Social Anxiety (Social Phobia)"&
                                     DX_07!="Social Anxiety (Social Phobia)"&
                                     DX_08!="Social Anxiety (Social Phobia)"&
                                     DX_09!="Social Anxiety (Social Phobia)"&
                                     DX_10!="Social Anxiety (Social Phobia)") ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

HBN_data <- HBN_data %>%  mutate(DIAG_PANIC=
            case_when(DX_01=="Panic Disorder"|DX_02=="Panic Disorder"|DX_03=="Panic Disorder"|
                       DX_04=="Panic Disorder"|DX_05=="Panic Disorder"|DX_06=="Panic Disorder"|
                       DX_07=="Panic Disorder"|DX_08=="Panic Disorder"|DX_09=="Panic Disorder"|
                       DX_10=="Panic Disorder" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 & (DX_01!="Panic Disorder"&DX_02!="Panic Disorder"&
                                     DX_03!="Panic Disorder"&DX_04!="Panic Disorder"&
                                     DX_05!="Panic Disorder"&DX_06!="Panic Disorder"&
                                     DX_07!="Panic Disorder"&DX_08!="Panic Disorder"&
                                     DX_09!="Panic Disorder"&DX_10!="Panic Disorder") ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

HBN_data <- HBN_data %>%  mutate(DIAG_AGORAPHOB=
            case_when(DX_01=="Agoraphobia"|DX_02=="Agoraphobia"|DX_03=="Agoraphobia"|
                       DX_04=="Agoraphobia"|DX_05=="Agoraphobia"|DX_06=="Agoraphobia"|
                       DX_07=="Agoraphobia"|DX_08=="Agoraphobia"|DX_09=="Agoraphobia"|
                       DX_10=="Agoraphobia" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 & (DX_01!="Agoraphobia"&DX_02!="Agoraphobia"&
                                     DX_03!="Agoraphobia"&DX_04!="Agoraphobia"&
                                     DX_05!="Agoraphobia"&DX_06!="Agoraphobia"&
                                     DX_07!="Agoraphobia"&DX_08!="Agoraphobia"&
                                     DX_09!="Agoraphobia"&DX_10!="Agoraphobia") ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

HBN_data <- HBN_data %>%  mutate(DIAG_GEN_ANX=
            case_when(DX_01=="Generalized Anxiety Disorder"|DX_02=="Generalized Anxiety Disorder"|
                       DX_03=="Generalized Anxiety Disorder"|DX_04=="Generalized Anxiety Disorder"|
                       DX_05=="Generalized Anxiety Disorder"|DX_06=="Generalized Anxiety Disorder"|
                       DX_07=="Generalized Anxiety Disorder"|DX_08=="Generalized Anxiety Disorder"|
                       DX_09=="Generalized Anxiety Disorder"|DX_10=="Generalized Anxiety Disorder" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 & (DX_01!="Generalized Anxiety Disorder"&
                                     DX_02!="Generalized Anxiety Disorder"&
                                     DX_03!="Generalized Anxiety Disorder"&
                                     DX_04!="Generalized Anxiety Disorder"&
                                     DX_05!="Generalized Anxiety Disorder"&
                                     DX_06!="Generalized Anxiety Disorder"&
                                     DX_07!="Generalized Anxiety Disorder"&
                                     DX_08!="Generalized Anxiety Disorder"&
                                     DX_09!="Generalized Anxiety Disorder"&DX_10!="Generalized Anxiety Disorder") ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

HBN_data <- HBN_data %>%  mutate(DIAG_PTSD=
            case_when(DX_01=="Posttraumatic Stress Disorder"|DX_02=="Posttraumatic Stress Disorder"|
                       DX_03=="Posttraumatic Stress Disorder"|
                       DX_04=="Posttraumatic Stress Disorder"|
                       DX_05=="Posttraumatic Stress Disorder"|
                       DX_06=="Posttraumatic Stress Disorder"|
                       DX_07=="Posttraumatic Stress Disorder"|
                       DX_08=="Posttraumatic Stress Disorder"|
                       DX_09=="Posttraumatic Stress Disorder"|
                       DX_10=="Posttraumatic Stress Disorder" ~ 1,
                      DX_01=="Other Specified Trauma- and Stressor-Related Disorder"|
                        DX_02=="Other Specified Trauma- and Stressor-Related Disorder"|
                        DX_03=="Other Specified Trauma- and Stressor-Related Disorder"|
                        DX_04=="Other Specified Trauma- and Stressor-Related Disorder"|
                        DX_05=="Other Specified Trauma- and Stressor-Related Disorder"|
                        DX_06=="Other Specified Trauma- and Stressor-Related Disorder"|
                        DX_07=="Other Specified Trauma- and Stressor-Related Disorder"|
                        DX_08=="Other Specified Trauma- and Stressor-Related Disorder"|
                        DX_09=="Other Specified Trauma- and Stressor-Related Disorder"|
                        DX_10=="Other Specified Trauma- and Stressor-Related Disorder" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 & ((DX_01!="Posttraumatic Stress Disorder"&
                                     DX_02!="Posttraumatic Stress Disorder"&
                                     DX_03!="Posttraumatic Stress Disorder"&
                                     DX_04!="Posttraumatic Stress Disorder"&
                                     DX_05!="Posttraumatic Stress Disorder"&
                                     DX_06!="Posttraumatic Stress Disorder"&
                                     DX_07!="Posttraumatic Stress Disorder"&
                                     DX_08!="Posttraumatic Stress Disorder"&
                                     DX_09!="Posttraumatic Stress Disorder"&
                                     DX_10!="Posttraumatic Stress Disorder") &
                       (DX_01!="Other Specified Trauma- and Stressor-Related Disorder"&
                          DX_02!="Other Specified Trauma- and Stressor-Related Disorder"&
                          DX_03!="Other Specified Trauma- and Stressor-Related Disorder"&
                          DX_04!="Other Specified Trauma- and Stressor-Related Disorder"&
                          DX_05!="Other Specified Trauma- and Stressor-Related Disorder"&
                          DX_06!="Other Specified Trauma- and Stressor-Related Disorder"&
                          DX_07!="Other Specified Trauma- and Stressor-Related Disorder"&
                          DX_08!="Other Specified Trauma- and Stressor-Related Disorder"&
                          DX_09!="Other Specified Trauma- and Stressor-Related Disorder"&
                          DX_10!="Other Specified Trauma- and Stressor-Related Disorder")) ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

HBN_data <- HBN_data %>%  mutate(DIAG_OCD=
            case_when(DX_01=="Obsessive-Compulsive Disorder"|
                       DX_02=="Obsessive-Compulsive Disorder"|
                       DX_03=="Obsessive-Compulsive Disorder"|
                       DX_04=="Obsessive-Compulsive Disorder"|
                       DX_05=="Obsessive-Compulsive Disorder"|
                       DX_06=="Obsessive-Compulsive Disorder"|
                       DX_07=="Obsessive-Compulsive Disorder"|
                       DX_08=="Obsessive-Compulsive Disorder"|
                       DX_09=="Obsessive-Compulsive Disorder"|
                       DX_10=="Obsessive-Compulsive Disorder" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 & (DX_01!="Obsessive-Compulsive Disorder"&
                                     DX_02!="Obsessive-Compulsive Disorder"&
                                     DX_03!="Obsessive-Compulsive Disorder"&
                                     DX_04!="Obsessive-Compulsive Disorder"&
                                     DX_05!="Obsessive-Compulsive Disorder"&
                                     DX_06!="Obsessive-Compulsive Disorder"&
                                     DX_07!="Obsessive-Compulsive Disorder"&
                                     DX_08!="Obsessive-Compulsive Disorder"&
                                     DX_09!="Obsessive-Compulsive Disorder"&
                                     DX_10!="Obsessive-Compulsive Disorder") ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

HBN_data <- HBN_data %>%  mutate(DIAG_DMDD=
            case_when(DX_01=="Disruptive Mood Dysregulation Disorder"|
                       DX_02=="Disruptive Mood Dysregulation Disorder"|
                       DX_03=="Disruptive Mood Dysregulation Disorder"|
                       DX_04=="Disruptive Mood Dysregulation Disorder"|
                       DX_05=="Disruptive Mood Dysregulation Disorder"|
                       DX_06=="Disruptive Mood Dysregulation Disorder"|
                       DX_07=="Disruptive Mood Dysregulation Disorder"|
                       DX_08=="Disruptive Mood Dysregulation Disorder"|
                       DX_09=="Disruptive Mood Dysregulation Disorder"|
                       DX_10=="Disruptive Mood Dysregulation Disorder" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 & (DX_01!="Disruptive Mood Dysregulation Disorder"&
                                     DX_02!="Disruptive Mood Dysregulation Disorder"&
                                     DX_03!="Disruptive Mood Dysregulation Disorder"&
                                     DX_04!="Disruptive Mood Dysregulation Disorder"&
                                     DX_05!="Disruptive Mood Dysregulation Disorder"&
                                     DX_06!="Disruptive Mood Dysregulation Disorder"&
                                     DX_07!="Disruptive Mood Dysregulation Disorder"&
                                     DX_08!="Disruptive Mood Dysregulation Disorder"&
                                     DX_09!="Disruptive Mood Dysregulation Disorder"&
                                     DX_10!="Disruptive Mood Dysregulation Disorder") ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

HBN_data <- HBN_data %>%  mutate(DIAG_ODD=
            case_when(DX_01=="Oppositional Defiant Disorder"|DX_02=="Oppositional Defiant Disorder"|
                       DX_03=="Oppositional Defiant Disorder"|DX_04=="Oppositional Defiant Disorder"|
                       DX_05=="Oppositional Defiant Disorder"|DX_06=="Oppositional Defiant Disorder"|
                       DX_07=="Oppositional Defiant Disorder"|DX_08=="Oppositional Defiant Disorder"|
                       DX_09=="Oppositional Defiant Disorder"|DX_10=="Oppositional Defiant Disorder" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 & (DX_01!="Oppositional Defiant Disorder"&
                                     DX_02!="Oppositional Defiant Disorder"&
                                     DX_03!="Oppositional Defiant Disorder"&
                                     DX_04!="Oppositional Defiant Disorder"&
                                     DX_05!="Oppositional Defiant Disorder"&
                                     DX_06!="Oppositional Defiant Disorder"&
                                     DX_07!="Oppositional Defiant Disorder"&
                                     DX_08!="Oppositional Defiant Disorder"&
                                     DX_09!="Oppositional Defiant Disorder"&
                                     DX_10!="Oppositional Defiant Disorder") ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

HBN_data <- HBN_data %>%  mutate(DIAG_MANIA=
            case_when(DX_01=="Bipolar I Disorder"|DX_02=="Bipolar I Disorder"|
                       DX_03=="Bipolar I Disorder"|DX_04=="Bipolar I Disorder"|
                       DX_05=="Bipolar I Disorder"|DX_06=="Bipolar I Disorder"|
                       DX_07=="Bipolar I Disorder"|DX_08=="Bipolar I Disorder"|
                       DX_09=="Bipolar I Disorder"|DX_10=="Bipolar I Disorder" ~ 1,
                      DX_01=="Bipolar II Disorder"|DX_02=="Bipolar II Disorder"|
                       DX_03=="Bipolar II Disorder"|DX_04=="Bipolar II Disorder"|
                       DX_05=="Bipolar II Disorder"|DX_06=="Bipolar II Disorder"|
                       DX_07=="Bipolar II Disorder"|DX_08=="Bipolar II Disorder"|
                       DX_09=="Bipolar II Disorder"|DX_10=="Bipolar II Disorder" ~ 1,
                      DX_01=="Cyclothymic Disorder"|DX_02=="Cyclothymic Disorder"|
                       DX_03=="Cyclothymic Disorder"|DX_04=="Cyclothymic Disorder"|
                       DX_05=="Cyclothymic Disorder"|DX_06=="Cyclothymic Disorder"|
                       DX_07=="Cyclothymic Disorder"|DX_08=="Cyclothymic Disorder"|
                       DX_09=="Cyclothymic Disorder"|DX_10=="Cyclothymic Disorder" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 &
                      ((DX_01!="Bipolar I Disorder"&DX_02!="Bipolar I Disorder"&
                         DX_03!="Bipolar I Disorder"&DX_04!="Bipolar I Disorder"&
                         DX_05!="Bipolar I Disorder"&DX_06!="Bipolar I Disorder"&
                         DX_07!="Bipolar I Disorder"&DX_08!="Bipolar I Disorder"&
                         DX_09!="Bipolar I Disorder"&DX_10!="Bipolar I Disorder") &
                       (DX_01!="Bipolar II Disorder"&DX_02!="Bipolar II Disorder"&
                        DX_03!="Bipolar II Disorder"&DX_04!="Bipolar II Disorder"&
                        DX_05!="Bipolar II Disorder"&DX_06!="Bipolar II Disorder"&
                        DX_07!="Bipolar II Disorder"&DX_08!="Bipolar II Disorder"&
                        DX_09!="Bipolar II Disorder"&DX_10!="Bipolar II Disorder")&
                       (DX_01!="Cyclothymic Disorder"&DX_02!="Cyclothymic Disorder"&
                        DX_03!="Cyclothymic Disorder"&DX_04!="Cyclothymic Disorder"&
                        DX_05!="Cyclothymic Disorder"&DX_06!="Cyclothymic Disorder"&
                        DX_07!="Cyclothymic Disorder"&DX_08!="Cyclothymic Disorder"&
                        DX_09!="Cyclothymic Disorder"&DX_10!="Cyclothymic Disorder")) ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

HBN_data <- HBN_data %>%  mutate(DIAG_ADHD=
            case_when(DX_01=="ADHD-Combined Type"|DX_02=="ADHD-Combined Type"|
                        DX_03=="ADHD-Combined Type"|DX_04=="ADHD-Combined Type"|
                        DX_05=="ADHD-Combined Type"|DX_06=="ADHD-Combined Type"|
                        DX_07=="ADHD-Combined Type"|DX_08=="ADHD-Combined Type"|
                        DX_09=="ADHD-Combined Type"|DX_10=="ADHD-Combined Type" ~ 1,
                      DX_01=="ADHD-Hyperactive/Impulsive Type"|
                        DX_02=="ADHD-Hyperactive/Impulsive Type"|
                        DX_03=="ADHD-Hyperactive/Impulsive Type"|
                        DX_04=="ADHD-Hyperactive/Impulsive Type"|
                        DX_05=="ADHD-Hyperactive/Impulsive Type"|
                        DX_06=="ADHD-Hyperactive/Impulsive Type"|
                        DX_07=="ADHD-Hyperactive/Impulsive Type"|
                        DX_08=="ADHD-Hyperactive/Impulsive Type"|
                        DX_09=="ADHD-Hyperactive/Impulsive Type"|
                        DX_10=="ADHD-Hyperactive/Impulsive Type" ~ 1,
                      DX_01=="ADHD-Inattentive Type "|DX_02=="ADHD-Inattentive Type "|
                        DX_03=="ADHD-Inattentive Type "|DX_04=="ADHD-Inattentive Type "|
                        DX_05=="ADHD-Inattentive Type "|DX_06=="ADHD-Inattentive Type "|
                        DX_07=="ADHD-Inattentive Type "|DX_08=="ADHD-Inattentive Type "|
                        DX_09=="ADHD-Inattentive Type "|DX_10=="ADHD-Inattentive Type " ~ 1,
                      DX_01=="Other Specified Attention-Deficit/Hyperactivity Disorder"|
                        DX_02=="Other Specified Attention-Deficit/Hyperactivity Disorder"|
                        DX_03=="Other Specified Attention-Deficit/Hyperactivity Disorder"|
                        DX_04=="Other Specified Attention-Deficit/Hyperactivity Disorder"|
                        DX_05=="Other Specified Attention-Deficit/Hyperactivity Disorder"|
                        DX_06=="Other Specified Attention-Deficit/Hyperactivity Disorder"|
                        DX_07=="Other Specified Attention-Deficit/Hyperactivity Disorder"|
                        DX_08=="Other Specified Attention-Deficit/Hyperactivity Disorder"|
                        DX_09=="Other Specified Attention-Deficit/Hyperactivity Disorder"|
                        DX_10=="Other Specified Attention-Deficit/Hyperactivity Disorder" ~ 1,
                      DX_01=="Unspecified Attention-Deficit/Hyperactivity Disorder"|
                        DX_02=="Unspecified Attention-Deficit/Hyperactivity Disorder"|
                        DX_03=="Unspecified Attention-Deficit/Hyperactivity Disorder"|
                        DX_04=="Unspecified Attention-Deficit/Hyperactivity Disorder"|
                        DX_05=="Unspecified Attention-Deficit/Hyperactivity Disorder"|
                        DX_06=="Unspecified Attention-Deficit/Hyperactivity Disorder"|
                        DX_07=="Unspecified Attention-Deficit/Hyperactivity Disorder"|
                        DX_08=="Unspecified Attention-Deficit/Hyperactivity Disorder"|
                        DX_09=="Unspecified Attention-Deficit/Hyperactivity Disorder"|
                        DX_10=="Unspecified Attention-Deficit/Hyperactivity Disorder" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 &
                      ((DX_01!="ADHD-Combined Type"&DX_02!="ADHD-Combined Type"&
                          DX_03!="ADHD-Combined Type"&DX_04!="ADHD-Combined Type"&
                          DX_05!="ADHD-Combined Type"&DX_06!="ADHD-Combined Type"&
                          DX_07!="ADHD-Combined Type"&DX_08!="ADHD-Combined Type"&
                          DX_09!="ADHD-Combined Type"&DX_10!="ADHD-Combined Type") &
                       (DX_01!="ADHD-Hyperactive/Impulsive Type"&
                          DX_02!="ADHD-Hyperactive/Impulsive Type"&
                          DX_03!="ADHD-Hyperactive/Impulsive Type"&
                          DX_04!="ADHD-Hyperactive/Impulsive Type"&
                          DX_05!="ADHD-Hyperactive/Impulsive Type"&
                          DX_06!="ADHD-Hyperactive/Impulsive Type"&
                          DX_07!="ADHD-Hyperactive/Impulsive Type"&
                          DX_08!="ADHD-Hyperactive/Impulsive Type"&
                          DX_09!="ADHD-Hyperactive/Impulsive Type"&
                          DX_10!="ADHD-Hyperactive/Impulsive Type") &
                         (DX_01!="ADHD-Inattentive Type "&DX_02!="ADHD-Inattentive Type "&
                            DX_03!="ADHD-Inattentive Type "&DX_04!="ADHD-Inattentive Type "&
                            DX_05!="ADHD-Inattentive Type "&DX_06!="ADHD-Inattentive Type "&
                            DX_07!="ADHD-Inattentive Type "&DX_08!="ADHD-Inattentive Type "&
                            DX_09!="ADHD-Inattentive Type "&DX_10!="ADHD-Inattentive Type ") &
                       (DX_01!="Other Specified Attention-Deficit/Hyperactivity Disorder"&
                          DX_02!="Other Specified Attention-Deficit/Hyperactivity Disorder"&
                          DX_03!="Other Specified Attention-Deficit/Hyperactivity Disorder"&
                          DX_04!="Other Specified Attention-Deficit/Hyperactivity Disorder"&
                          DX_05!="Other Specified Attention-Deficit/Hyperactivity Disorder"&
                          DX_06!="Other Specified Attention-Deficit/Hyperactivity Disorder"&
                          DX_07!="Other Specified Attention-Deficit/Hyperactivity Disorder"&
                          DX_08!="Other Specified Attention-Deficit/Hyperactivity Disorder"&
                          DX_09!="Other Specified Attention-Deficit/Hyperactivity Disorder"&
                          DX_10!="Other Specified Attention-Deficit/Hyperactivity Disorder") &
                       (DX_01!="Unspecified Attention-Deficit/Hyperactivity Disorder"&
                          DX_02!="Unspecified Attention-Deficit/Hyperactivity Disorder"&
                          DX_03!="Unspecified Attention-Deficit/Hyperactivity Disorder"&
                          DX_04!="Unspecified Attention-Deficit/Hyperactivity Disorder"&
                          DX_05!="Unspecified Attention-Deficit/Hyperactivity Disorder"&
                          DX_06!="Unspecified Attention-Deficit/Hyperactivity Disorder"&
                          DX_07!="Unspecified Attention-Deficit/Hyperactivity Disorder"&
                          DX_08!="Unspecified Attention-Deficit/Hyperactivity Disorder"&
                          DX_09!="Unspecified Attention-Deficit/Hyperactivity Disorder"&
                          DX_10!="Unspecified Attention-Deficit/Hyperactivity Disorder")) ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

HBN_data <- HBN_data %>%  mutate(DIAG_PSYCH=
            case_when(DX_01=="Other Specified Schizophrenia Spectrum and Other Psychotic Disorder"|
                        DX_02=="Other Specified Schizophrenia Spectrum and Other Psychotic Disorder"|
                        DX_03=="Other Specified Schizophrenia Spectrum and Other Psychotic Disorder"|
                        DX_04=="Other Specified Schizophrenia Spectrum and Other Psychotic Disorder"|
                        DX_05=="Other Specified Schizophrenia Spectrum and Other Psychotic Disorder"|
                        DX_06=="Other Specified Schizophrenia Spectrum and Other Psychotic Disorder"|
                        DX_07=="Other Specified Schizophrenia Spectrum and Other Psychotic Disorder"|
                        DX_08=="Other Specified Schizophrenia Spectrum and Other Psychotic Disorder"|
                        DX_09=="Other Specified Schizophrenia Spectrum and Other Psychotic Disorder"|
                        DX_10=="Other Specified Schizophrenia Spectrum and Other Psychotic Disorder" ~ 1,
                      DX_01=="Schizophrenia"|DX_02=="Schizophrenia"|DX_03=="Schizophrenia"|
                        DX_04=="Schizophrenia"|DX_05=="Schizophrenia"|DX_06=="Schizophrenia"|
                        DX_07=="Schizophrenia"|DX_08=="Schizophrenia"|DX_09=="Schizophrenia"|
                        DX_10=="Schizophrenia" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 &
                      ((DX_01!="Other Specified Schizophrenia Spectrum and Other Psychotic Disorder"&
                          DX_02!="Other Specified Schizophrenia Spectrum and Other Psychotic Disorder"&
                          DX_03!="Other Specified Schizophrenia Spectrum and Other Psychotic Disorder"&
                          DX_04!="Other Specified Schizophrenia Spectrum and Other Psychotic Disorder"&
                          DX_05!="Other Specified Schizophrenia Spectrum and Other Psychotic Disorder"&
                          DX_06!="Other Specified Schizophrenia Spectrum and Other Psychotic Disorder"&
                          DX_07!="Other Specified Schizophrenia Spectrum and Other Psychotic Disorder"&
                          DX_08!="Other Specified Schizophrenia Spectrum and Other Psychotic Disorder"&
                          DX_09!="Other Specified Schizophrenia Spectrum and Other Psychotic Disorder"&
                          DX_10!="Other Specified Schizophrenia Spectrum and Other Psychotic Disorder") &
                       (DX_01!="Schizophrenia"&DX_02!="Schizophrenia"&DX_03!="Schizophrenia"&
                          DX_04!="Schizophrenia"&DX_05!="Schizophrenia"&DX_06!="Schizophrenia"&
                          DX_07!="Schizophrenia"&DX_08!="Schizophrenia"&DX_09!="Schizophrenia"&
                          DX_10!="Schizophrenia")) ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

HBN_data <- HBN_data %>%  mutate(DIAG_DEP=
            case_when(DX_01=="Other Specified Depressive Disorder"|
                        DX_02=="Other Specified Depressive Disorder"|
                        DX_03=="Other Specified Depressive Disorder"|
                        DX_04=="Other Specified Depressive Disorder"|
                        DX_05=="Other Specified Depressive Disorder"|
                        DX_06=="Other Specified Depressive Disorder"|
                        DX_07=="Other Specified Depressive Disorder"|
                        DX_08=="Other Specified Depressive Disorder"|
                        DX_09=="Other Specified Depressive Disorder"|
                        DX_10=="Other Specified Depressive Disorder" ~ 1,
                      DX_01=="Major Depressive Disorder"|DX_02=="Major Depressive Disorder"|
                        DX_03=="Major Depressive Disorder"|DX_04=="Major Depressive Disorder"|
                        DX_05=="Major Depressive Disorder"|DX_06=="Major Depressive Disorder"|
                        DX_07=="Major Depressive Disorder"|DX_08=="Major Depressive Disorder"|
                        DX_09=="Major Depressive Disorder"|DX_10=="Major Depressive Disorder" ~ 1,
                      DX_01=="Persistent Depressive Disorder (Dysthymia)"|
                        DX_02=="Persistent Depressive Disorder (Dysthymia)"|
                        DX_03=="Persistent Depressive Disorder (Dysthymia)"|
                        DX_04=="Persistent Depressive Disorder (Dysthymia)"|
                        DX_05=="Persistent Depressive Disorder (Dysthymia)"|
                        DX_06=="Persistent Depressive Disorder (Dysthymia)"|
                        DX_07=="Persistent Depressive Disorder (Dysthymia)"|
                        DX_08=="Persistent Depressive Disorder (Dysthymia)"|
                        DX_09=="Persistent Depressive Disorder (Dysthymia)"|
                        DX_10=="Persistent Depressive Disorder (Dysthymia)" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 &
                      ((DX_01!="Other Specified Depressive Disorder"&
                          DX_02!="Other Specified Depressive Disorder"&
                          DX_03!="Other Specified Depressive Disorder"&
                          DX_04!="Other Specified Depressive Disorder"&
                          DX_05!="Other Specified Depressive Disorder"&
                          DX_06!="Other Specified Depressive Disorder"&
                          DX_07!="Other Specified Depressive Disorder"&
                          DX_08!="Other Specified Depressive Disorder"&
                          DX_09!="Other Specified Depressive Disorder"&
                          DX_10!="Other Specified Depressive Disorder") &
                       (DX_01!="Major Depressive Disorder"&DX_02!="Major Depressive Disorder"&
                          DX_03!="Major Depressive Disorder"&DX_04!="Major Depressive Disorder"&
                          DX_05!="Major Depressive Disorder"&DX_06!="Major Depressive Disorder"&
                          DX_07!="Major Depressive Disorder"&DX_08!="Major Depressive Disorder"&
                          DX_09!="Major Depressive Disorder"&DX_10!="Major Depressive Disorder")&
                       (DX_01!="Persistent Depressive Disorder (Dysthymia)"&
                          DX_02!="Persistent Depressive Disorder (Dysthymia)"&
                          DX_03!="Persistent Depressive Disorder (Dysthymia)"&
                          DX_04!="Persistent Depressive Disorder (Dysthymia)"&
                          DX_05!="Persistent Depressive Disorder (Dysthymia)"&
                          DX_06!="Persistent Depressive Disorder (Dysthymia)"&
                          DX_07!="Persistent Depressive Disorder (Dysthymia)"&
                          DX_08!="Persistent Depressive Disorder (Dysthymia)"&
                          DX_09!="Persistent Depressive Disorder (Dysthymia)"&
                          DX_10!="Persistent Depressive Disorder (Dysthymia)")) ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

HBN_data <- HBN_data %>%  mutate(DIAG_CD=
            case_when(DX_01=="Other Specified Disruptive, Impulse-Control, and Conduct Disorder "|
                        DX_02=="Other Specified Disruptive, Impulse-Control, and Conduct Disorder "|
                        DX_03=="Other Specified Disruptive, Impulse-Control, and Conduct Disorder "|
                        DX_04=="Other Specified Disruptive, Impulse-Control, and Conduct Disorder "|
                        DX_05=="Other Specified Disruptive, Impulse-Control, and Conduct Disorder "|
                        DX_06=="Other Specified Disruptive, Impulse-Control, and Conduct Disorder "|
                        DX_07=="Other Specified Disruptive, Impulse-Control, and Conduct Disorder "|
                        DX_08=="Other Specified Disruptive, Impulse-Control, and Conduct Disorder "|
                        DX_09=="Other Specified Disruptive, Impulse-Control, and Conduct Disorder "|
                        DX_10=="Other Specified Disruptive, Impulse-Control, and Conduct Disorder " ~ 1,
                      DX_01=="Conduct Disorder-Childhood-onset type"|
                        DX_02=="Conduct Disorder-Childhood-onset type"|
                        DX_03=="Conduct Disorder-Childhood-onset type"|
                        DX_04=="Conduct Disorder-Childhood-onset type"|
                        DX_05=="Conduct Disorder-Childhood-onset type"|
                        DX_06=="Conduct Disorder-Childhood-onset type"|
                        DX_07=="Conduct Disorder-Childhood-onset type"|
                        DX_08=="Conduct Disorder-Childhood-onset type"|
                        DX_09=="Conduct Disorder-Childhood-onset type"|
                        DX_10=="Conduct Disorder-Childhood-onset type" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 &
                      ((DX_01!="Other Specified Disruptive, Impulse-Control, and Conduct Disorder "&
                          DX_02!="Other Specified Disruptive, Impulse-Control, and Conduct Disorder "&
                          DX_03!="Other Specified Disruptive, Impulse-Control, and Conduct Disorder "&
                          DX_04!="Other Specified Disruptive, Impulse-Control, and Conduct Disorder "&
                          DX_05!="Other Specified Disruptive, Impulse-Control, and Conduct Disorder "&
                          DX_06!="Other Specified Disruptive, Impulse-Control, and Conduct Disorder "&
                          DX_07!="Other Specified Disruptive, Impulse-Control, and Conduct Disorder "&
                          DX_08!="Other Specified Disruptive, Impulse-Control, and Conduct Disorder "&
                          DX_09!="Other Specified Disruptive, Impulse-Control, and Conduct Disorder "&
                          DX_10!="Other Specified Disruptive, Impulse-Control, and Conduct Disorder ") &
                       (DX_01!="Conduct Disorder-Childhood-onset type"&
                          DX_02!="Conduct Disorder-Childhood-onset type"&
                          DX_03!="Conduct Disorder-Childhood-onset type"&
                          DX_04!="Conduct Disorder-Childhood-onset type"&
                          DX_05!="Conduct Disorder-Childhood-onset type"&
                          DX_06!="Conduct Disorder-Childhood-onset type"&
                          DX_07!="Conduct Disorder-Childhood-onset type"&
                          DX_08!="Conduct Disorder-Childhood-onset type"&
                          DX_09!="Conduct Disorder-Childhood-onset type"&
                          DX_10!="Conduct Disorder-Childhood-onset type")) ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

HBN_data <- HBN_data %>%  mutate(DIAG_EAT=
            case_when(DX_01=="Other Specified Feeding or Eating Disorder"|
                        DX_02=="Other Specified Feeding or Eating Disorder"|
                        DX_03=="Other Specified Feeding or Eating Disorder"|
                        DX_04=="Other Specified Feeding or Eating Disorder"|
                        DX_05=="Other Specified Feeding or Eating Disorder"|
                        DX_06=="Other Specified Feeding or Eating Disorder"|
                        DX_07=="Other Specified Feeding or Eating Disorder"|
                        DX_08=="Other Specified Feeding or Eating Disorder"|
                        DX_09=="Other Specified Feeding or Eating Disorder"|
                        DX_10=="Other Specified Feeding or Eating Disorder" ~ 1,
                      DX_01=="Avoidant/Restrictive Food Intake Disorder"|
                        DX_02=="Avoidant/Restrictive Food Intake Disorder"|
                        DX_03=="Avoidant/Restrictive Food Intake Disorder"|
                        DX_04=="Avoidant/Restrictive Food Intake Disorder"|
                        DX_05=="Avoidant/Restrictive Food Intake Disorder"|
                        DX_06=="Avoidant/Restrictive Food Intake Disorder"|
                        DX_07=="Avoidant/Restrictive Food Intake Disorder"|
                        DX_08=="Avoidant/Restrictive Food Intake Disorder"|
                        DX_09=="Avoidant/Restrictive Food Intake Disorder"|
                        DX_10=="Avoidant/Restrictive Food Intake Disorder" ~ 1,
                      DX_01=="Bulimia Nervosa"|DX_02=="Bulimia Nervosa"|
                        DX_03=="Bulimia Nervosa"|DX_04=="Bulimia Nervosa"|
                        DX_05=="Bulimia Nervosa"|DX_06=="Bulimia Nervosa"|
                        DX_07=="Bulimia Nervosa"|DX_08=="Bulimia Nervosa"|
                        DX_09=="Bulimia Nervosa"|DX_10=="Bulimia Nervosa" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 &
                      ((DX_01!="Other Specified Feeding or Eating Disorder"&
                          DX_02!="Other Specified Feeding or Eating Disorder"&
                          DX_03!="Other Specified Feeding or Eating Disorder"&
                          DX_04!="Other Specified Feeding or Eating Disorder"&
                          DX_05!="Other Specified Feeding or Eating Disorder"&
                          DX_06!="Other Specified Feeding or Eating Disorder"&
                          DX_07!="Other Specified Feeding or Eating Disorder"&
                          DX_08!="Other Specified Feeding or Eating Disorder"&
                          DX_09!="Other Specified Feeding or Eating Disorder"&
                          DX_10!="Other Specified Feeding or Eating Disorder") &
                       (DX_01!="Avoidant/Restrictive Food Intake Disorder"&
                          DX_02!="Avoidant/Restrictive Food Intake Disorder"&
                          DX_03!="Avoidant/Restrictive Food Intake Disorder"&
                          DX_04!="Avoidant/Restrictive Food Intake Disorder"&
                          DX_05!="Avoidant/Restrictive Food Intake Disorder"&
                          DX_06!="Avoidant/Restrictive Food Intake Disorder"&
                          DX_07!="Avoidant/Restrictive Food Intake Disorder"&
                          DX_08!="Avoidant/Restrictive Food Intake Disorder"&
                          DX_09!="Avoidant/Restrictive Food Intake Disorder"&
                          DX_10!="Avoidant/Restrictive Food Intake Disorder") &
                       (DX_01!="Bulimia Nervosa"&DX_02!="Bulimia Nervosa"&
                          DX_03!="Bulimia Nervosa"&DX_04!="Bulimia Nervosa"&
                          DX_05!="Bulimia Nervosa"&DX_06!="Bulimia Nervosa"&
                          DX_07!="Bulimia Nervosa"&DX_08!="Bulimia Nervosa"&
                          DX_09!="Bulimia Nervosa"&DX_10!="Bulimia Nervosa")) ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

HBN_data <- HBN_data %>%  mutate(DIAG_AUTISM=
            case_when(DX_01=="Other Specified Neurodevelopmental Disorder"|
                        DX_02=="Other Specified Neurodevelopmental Disorder"|
                        DX_03=="Other Specified Neurodevelopmental Disorder"|
                        DX_04=="Other Specified Neurodevelopmental Disorder"|
                        DX_05=="Other Specified Neurodevelopmental Disorder"|
                        DX_06=="Other Specified Neurodevelopmental Disorder"|
                        DX_07=="Other Specified Neurodevelopmental Disorder"|
                        DX_08=="Other Specified Neurodevelopmental Disorder"|
                        DX_09=="Other Specified Neurodevelopmental Disorder"|
                        DX_10=="Other Specified Neurodevelopmental Disorder" ~ 1,
                      DX_01=="Autism Spectrum Disorder"|DX_02=="Autism Spectrum Disorder"|
                        DX_03=="Autism Spectrum Disorder"|DX_04=="Autism Spectrum Disorder"|
                        DX_05=="Autism Spectrum Disorder"|DX_06=="Autism Spectrum Disorder"|
                        DX_07=="Autism Spectrum Disorder"|DX_08=="Autism Spectrum Disorder"|
                        DX_09=="Autism Spectrum Disorder"|DX_10=="Autism Spectrum Disorder" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 &
                      ((DX_01!="Other Specified Neurodevelopmental Disorder"&
                          DX_02!="Other Specified Neurodevelopmental Disorder"&
                          DX_03!="Other Specified Neurodevelopmental Disorder"&
                          DX_04!="Other Specified Neurodevelopmental Disorder"&
                          DX_05!="Other Specified Neurodevelopmental Disorder"&
                          DX_06!="Other Specified Neurodevelopmental Disorder"&
                          DX_07!="Other Specified Neurodevelopmental Disorder"&
                          DX_08!="Other Specified Neurodevelopmental Disorder"&
                          DX_09!="Other Specified Neurodevelopmental Disorder"&
                          DX_10!="Other Specified Neurodevelopmental Disorder") &
                       (DX_01!="Autism Spectrum Disorder"&DX_02!="Autism Spectrum Disorder"&
                          DX_03!="Autism Spectrum Disorder"&DX_04!="Autism Spectrum Disorder"&
                          DX_05!="Autism Spectrum Disorder"&DX_06!="Autism Spectrum Disorder"&
                          DX_07!="Autism Spectrum Disorder"&DX_08!="Autism Spectrum Disorder"&
                          DX_09!="Autism Spectrum Disorder"&DX_10!="Autism Spectrum Disorder")) ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

HBN_data <- HBN_data %>%  mutate(DIAG_TIC=
            case_when(DX_01=="Other Specified Tic Disorder"|DX_02=="Other Specified Tic Disorder"|
                        DX_03=="Other Specified Tic Disorder"|DX_04=="Other Specified Tic Disorder"|
                        DX_05=="Other Specified Tic Disorder"|DX_06=="Other Specified Tic Disorder"|
                        DX_07=="Other Specified Tic Disorder"|DX_08=="Other Specified Tic Disorder"|
                        DX_09=="Other Specified Tic Disorder"|DX_10=="Other Specified Tic Disorder" ~ 1,
                      DX_01=="Provisional Tic Disorder"|DX_02=="Provisional Tic Disorder"|
                        DX_03=="Provisional Tic Disorder"|DX_04=="Provisional Tic Disorder"|
                        DX_05=="Provisional Tic Disorder"|DX_06=="Provisional Tic Disorder"|
                        DX_07=="Provisional Tic Disorder"|DX_08=="Provisional Tic Disorder"|
                        DX_09=="Provisional Tic Disorder"|DX_10=="Provisional Tic Disorder" ~ 1,
                      DX_01=="Persistent (Chronic) Motor or Vocal Tic Disorder"|
                        DX_02=="Persistent (Chronic) Motor or Vocal Tic Disorder"|
                        DX_03=="Persistent (Chronic) Motor or Vocal Tic Disorder"|
                        DX_04=="Persistent (Chronic) Motor or Vocal Tic Disorder"|
                        DX_05=="Persistent (Chronic) Motor or Vocal Tic Disorder"|
                        DX_06=="Persistent (Chronic) Motor or Vocal Tic Disorder"|
                        DX_07=="Persistent (Chronic) Motor or Vocal Tic Disorder"|
                        DX_08=="Persistent (Chronic) Motor or Vocal Tic Disorder"|
                        DX_09=="Persistent (Chronic) Motor or Vocal Tic Disorder"|
                        DX_10=="Persistent (Chronic) Motor or Vocal Tic Disorder" ~ 1,
                      DX_01=="Tourettes Disorder"|DX_02=="Tourettes Disorder"|
                        DX_03=="Tourettes Disorder"|DX_04=="Tourettes Disorder"|
                        DX_05=="Tourettes Disorder"|DX_06=="Tourettes Disorder"|
                        DX_07=="Tourettes Disorder"|DX_08=="Tourettes Disorder"|
                        DX_09=="Tourettes Disorder"|DX_10=="Tourettes Disorder" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 &
                      ((DX_01!="Other Specified Tic Disorder"&DX_02!="Other Specified Tic Disorder"&
                          DX_03!="Other Specified Tic Disorder"&DX_04!="Other Specified Tic Disorder"&
                          DX_05!="Other Specified Tic Disorder"&DX_06!="Other Specified Tic Disorder"&
                          DX_07!="Other Specified Tic Disorder"&DX_08!="Other Specified Tic Disorder"&
                          DX_09!="Other Specified Tic Disorder"&DX_10!="Other Specified Tic Disorder") &
                       (DX_01!="Provisional Tic Disorder"&DX_02!="Provisional Tic Disorder"&
                          DX_03!="Provisional Tic Disorder"&DX_04!="Provisional Tic Disorder"&
                          DX_05!="Provisional Tic Disorder"&DX_06!="Provisional Tic Disorder"&
                          DX_07!="Provisional Tic Disorder"&DX_08!="Provisional Tic Disorder"&
                          DX_09!="Provisional Tic Disorder"&DX_10!="Provisional Tic Disorder")&
                       (DX_01!="Persistent (Chronic) Motor or Vocal Tic Disorder"&
                          DX_02!="Persistent (Chronic) Motor or Vocal Tic Disorder"&
                          DX_03!="Persistent (Chronic) Motor or Vocal Tic Disorder"&
                          DX_04!="Persistent (Chronic) Motor or Vocal Tic Disorder"&
                          DX_05!="Persistent (Chronic) Motor or Vocal Tic Disorder"&
                          DX_06!="Persistent (Chronic) Motor or Vocal Tic Disorder"&
                          DX_07!="Persistent (Chronic) Motor or Vocal Tic Disorder"&
                          DX_08!="Persistent (Chronic) Motor or Vocal Tic Disorder"&
                          DX_09!="Persistent (Chronic) Motor or Vocal Tic Disorder"&
                          DX_10!="Persistent (Chronic) Motor or Vocal Tic Disorder")&
                       (DX_01!="Tourettes Disorder"&DX_02!="Tourettes Disorder"&
                          DX_03!="Tourettes Disorder"&DX_04!="Tourettes Disorder"&
                          DX_05!="Tourettes Disorder"&DX_06!="Tourettes Disorder"&
                          DX_07!="Tourettes Disorder"&DX_08!="Tourettes Disorder"&
                          DX_09!="Tourettes Disorder"&DX_10!="Tourettes Disorder")) ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

HBN_data <- HBN_data %>%  mutate(DIAG_Other_ANX=
            case_when(DX_01=="Other Specified Anxiety Disorder"|
                        DX_02=="Other Specified Anxiety Disorder"|
                        DX_03=="Other Specified Anxiety Disorder"|
                        DX_04=="Other Specified Anxiety Disorder"|
                        DX_05=="Other Specified Anxiety Disorder"|
                        DX_06=="Other Specified Anxiety Disorder"|
                        DX_07=="Other Specified Anxiety Disorder"|
                        DX_08=="Other Specified Anxiety Disorder"|
                        DX_09=="Other Specified Anxiety Disorder"|
                        DX_10=="Other Specified Anxiety Disorder" ~ 1,
                      DX_01=="Unspecified Anxiety Disorder"|
                        DX_02=="Unspecified Anxiety Disorder"|
                        DX_03=="Unspecified Anxiety Disorder"|
                        DX_04=="Unspecified Anxiety Disorder"|
                        DX_05=="Unspecified Anxiety Disorder"|
                        DX_06=="Unspecified Anxiety Disorder"|
                        DX_07=="Unspecified Anxiety Disorder"|
                        DX_08=="Unspecified Anxiety Disorder"|
                        DX_09=="Unspecified Anxiety Disorder"|
                        DX_10=="Unspecified Anxiety Disorder" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 & ((DX_01!="Other Specified Anxiety Disorder"&
                                     DX_02!="Other Specified Anxiety Disorder"&
                                     DX_03!="Other Specified Anxiety Disorder"&
                                     DX_04!="Other Specified Anxiety Disorder"&
                                     DX_05!="Other Specified Anxiety Disorder"&
                                     DX_06!="Other Specified Anxiety Disorder"&
                                     DX_07!="Other Specified Anxiety Disorder"&
                                     DX_08!="Other Specified Anxiety Disorder"&
                                     DX_09!="Other Specified Anxiety Disorder"&
                                     DX_10!="Other Specified Anxiety Disorder") &
                                  (DX_01!="Unspecified Anxiety Disorder"&
                                     DX_02!="Unspecified Anxiety Disorder"&
                                     DX_03!="Unspecified Anxiety Disorder"&
                                     DX_04!="Unspecified Anxiety Disorder"&
                                     DX_05!="Unspecified Anxiety Disorder"&
                                     DX_06!="Unspecified Anxiety Disorder"&
                                     DX_07!="Unspecified Anxiety Disorder"&
                                     DX_08!="Unspecified Anxiety Disorder"&
                                     DX_09!="Unspecified Anxiety Disorder"&
                                     DX_10!="Unspecified Anxiety Disorder")) ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

# Maternal diagnosis
HBN_data<-dplyr::rename(HBN_data,mdx=`PreInt_FamHx_RDC,mdx`)
HBN_data <- HBN_data %>%  mutate(Maternal_DIAG_ANY=
            case_when(mdx=="0No Diagnosis" |mdx=="No Diagnosis" ~ 0,
                      mdx=="" |mdx=="." | mdx=="No Response" ~ NA_real_,
                      TRUE ~ 1))

# Birth weight (Kg)
HBN_data<-dplyr::rename(HBN_data,Birth_weight=`PreInt_DevHx,birthweight_lbs`)
HBN_data$Birth_weight <- as.numeric(HBN_data$Birth_weight)
HBN_data$Birth_weight <- HBN_data$Birth_weight/2.20462
summary.factor(HBN_data$Birth_weight)
# Delivery
HBN_data<-dplyr::rename(HBN_data,Birth_delivery=`PreInt_DevHx,delivery`)
HBN_data$Birth_delivery <- as.numeric(HBN_data$Birth_delivery)
HBN_data <- HBN_data %>% mutate(Birth_delivery=car::recode(Birth_delivery,"0='C_section';1='Vaginal'"))
summary.factor(HBN_data$Birth_delivery)
# Premature
HBN_data<-dplyr::rename(HBN_data,Birth_premature=`PreInt_DevHx,premature`)
HBN_data$Birth_premature <- as.numeric(HBN_data$Birth_premature)
HBN_data <- HBN_data %>% mutate(Birth_premature=car::recode(Birth_premature,"0='Term/Posterm';1='Preterm'"))
summary.factor(HBN_data$Birth_premature)
# Preg duration (weeks)
HBN_data<-dplyr::rename(HBN_data,Birth_preg_dur=`PreInt_DevHx,preg_dur`)
HBN_data$Birth_preg_dur <- as.numeric(HBN_data$Birth_preg_dur)
summary.factor(HBN_data$Birth_preg_dur)
# BMI
HBN_data<-dplyr::rename(HBN_data,BMI=`Physical,BMI`)
HBN_data$BMI <- as.numeric(HBN_data$BMI)
# Education
HBN_data<-dplyr::rename(HBN_data,School_years=`PreInt_EduHx,yrs_school`)
HBN_data$School_years <- as.numeric(HBN_data$School_years)

HBN_data<-dplyr::rename(HBN_data,School_repet=`PreInt_EduHx,repeated_grades`)
HBN_data$School_repet <- as.numeric(HBN_data$School_repet)
summary.factor(HBN_data$School_repet)

HBN_data<-dplyr::rename(HBN_data,School_exp=`PreInt_EduHx,expulsion`)
HBN_data$School_exp <- as.numeric(HBN_data$School_exp)
summary.factor(HBN_data$School_exp)

HBN_data<-dplyr::rename(HBN_data,School_susp=`PreInt_EduHx,suspension`)
HBN_data$School_susp <- as.numeric(HBN_data$School_susp)
summary.factor(HBN_data$School_susp)

# IQ
HBN_data<-dplyr::rename(HBN_data,WAIS=`WASI,WASI_FSIQ`)
HBN_data<-dplyr::rename(HBN_data,WISC=`WISC,WISC_FSIQ`)
HBN_data$WAIS <- as.numeric(HBN_data$WAIS)
HBN_data$WISC <- as.numeric(HBN_data$WISC)
HBN_data <- HBN_data %>% mutate(IQraw= case_when(WAIS!="NA" ~ WAIS,
                                               WISC!="NA" ~ WISC))

fit_iq_resid <- glm(IQraw ~ Age + Gender, data=HBN_data); summary(fit_iq_resid)
IQ_resid <- rstandard(fit_iq_resid)
IQ_data <- HBN_data %>% dplyr::select(EID, IQraw) %>% drop_na() %>% dplyr::select(EID)
IQ_data <- cbind(IQ_data, IQ_resid)
HBN_data <- HBN_data %>% left_join(IQ_data, by="EID")
HBN_data$IQ <- (HBN_data$IQ_resid*15)+100
rm(IQ_data, fit_iq_resid, IQ_resid)

# Select vars

HBN_data <- HBN_data %>% dplyr::select(EID,Study,Site,Selection,Age,Age_group_3cat,Gender,Birth_weight,Birth_delivery,Birth_premature,Birth_preg_dur,Child_race,IQ,BMI,School_years,School_repet,School_exp,School_susp,Maternal_DIAG_ANY, CBCL_1:YSR_56,  pSDQ_1:pSDQ_25, pSDQ_26, pSDQ_26b:pSDQ_26f, DIAG_SEP_ANX, DIAG_SPEC_PHOB, DIAG_SOC_PHOB, DIAG_PANIC, DIAG_AGORAPHOB, DIAG_PTSD, DIAG_OCD, DIAG_GEN_ANX, DIAG_DMDD, DIAG_MANIA, DIAG_ADHD, DIAG_ODD, DIAG_PSYCH, DIAG_DEP, DIAG_CD, DIAG_EAT, DIAG_AUTISM, DIAG_TIC, DIAG_Other_ANX, DIAG_ANY) 
HBN_data<- HBN_data %>% dplyr::select(-CBCL_113A, -CBCL_113B, -CBCL_113C, -TRF_113A, -TRF_113B, -TRF_113C)

# To row bind with other data set
HBN_data$wave<-1
HBN_data$Sampling_weight<-NA

HBN_data$tSDQ_3<-NA
HBN_data$tSDQ_8<-NA
HBN_data$tSDQ_13<-NA
HBN_data$tSDQ_16<-NA
HBN_data$tSDQ_24<-NA
HBN_data$tSDQ_5<-NA
HBN_data$tSDQ_7<-NA
HBN_data$tSDQ_12<-NA
HBN_data$tSDQ_18<-NA
HBN_data$tSDQ_22<-NA
HBN_data$tSDQ_2<-NA
HBN_data$tSDQ_10<-NA
HBN_data$tSDQ_15<-NA
HBN_data$tSDQ_21<-NA
HBN_data$tSDQ_25<-NA
HBN_data$tSDQ_6<-NA
HBN_data$tSDQ_11<-NA
HBN_data$tSDQ_14<-NA
HBN_data$tSDQ_19<-NA
HBN_data$tSDQ_23<-NA
HBN_data$tSDQ_1<-NA
HBN_data$tSDQ_4<-NA
HBN_data$tSDQ_9<-NA
HBN_data$tSDQ_17<-NA
HBN_data$tSDQ_20<-NA

HBN_data$sSDQ_3<-NA
HBN_data$sSDQ_8<-NA
HBN_data$sSDQ_13<-NA
HBN_data$sSDQ_16<-NA
HBN_data$sSDQ_24<-NA
HBN_data$sSDQ_5<-NA
HBN_data$sSDQ_7<-NA
HBN_data$sSDQ_12<-NA
HBN_data$sSDQ_18<-NA
HBN_data$sSDQ_22<-NA
HBN_data$sSDQ_2<-NA
HBN_data$sSDQ_10<-NA
HBN_data$sSDQ_15<-NA
HBN_data$sSDQ_21<-NA
HBN_data$sSDQ_25<-NA
HBN_data$sSDQ_6<-NA
HBN_data$sSDQ_11<-NA
HBN_data$sSDQ_14<-NA
HBN_data$sSDQ_19<-NA
HBN_data$sSDQ_23<-NA
HBN_data$sSDQ_1<-NA
HBN_data$sSDQ_4<-NA
HBN_data$sSDQ_9<-NA
HBN_data$sSDQ_17<-NA
HBN_data$sSDQ_20<-NA

HBN_data$GOASSESS_SIP_010 <- NA ; HBN_data$GOASSESS_SIP_007 <- NA ; HBN_data$GOASSESS_SIP_012 <- NA ; HBN_data$GOASSESS_SIP_008 <- NA ; HBN_data$GOASSESS_SIP_013 <- NA ; HBN_data$GOASSESS_SIP_011 <- NA ; HBN_data$GOASSESS_SIP_005 <- NA ; HBN_data$GOASSESS_SIP_006 <- NA ; HBN_data$GOASSESS_SIP_004 <- NA ; HBN_data$GOASSESS_SIP_003 <- NA ; HBN_data$GOASSESS_SIP_009 <- NA ; HBN_data$GOASSESS_SIP_014 <- NA ; HBN_data$GOASSESS_PSY_001 <- NA ; HBN_data$GOASSESS_PSY_060 <- NA ; HBN_data$GOASSESS_PSY_029 <- NA ; HBN_data$GOASSESS_SIP_027 <- NA ; HBN_data$GOASSESS_PSY_070 <- NA ; HBN_data$GOASSESS_SIP_028 <- NA ; HBN_data$GOASSESS_PSY_071 <- NA ; HBN_data$GOASSESS_PSY_050 <- NA ; HBN_data$GOASSESS_ADD_012 <- NA ; HBN_data$GOASSESS_ADD_011 <- NA ; HBN_data$GOASSESS_ADD_016 <- NA ; HBN_data$GOASSESS_ADD_021 <- NA ; HBN_data$GOASSESS_ODD_002 <- NA ; HBN_data$GOASSESS_ODD_003 <- NA ; HBN_data$GOASSESS_ADD_022 <- NA ; HBN_data$GOASSESS_ADD_013 <- NA ; HBN_data$GOASSESS_ADD_014 <- NA ; HBN_data$GOASSESS_ADD_020 <- NA ; HBN_data$GOASSESS_ADD_015 <- NA ; HBN_data$GOASSESS_ODD_001 <- NA ; HBN_data$GOASSESS_CDD_005 <- NA ; HBN_data$GOASSESS_ODD_005 <- NA ; HBN_data$GOASSESS_ODD_006 <- NA ; HBN_data$GOASSESS_CDD_001 <- NA ;  HBN_data$GOASSESS_CDD_003 <- NA ; HBN_data$GOASSESS_CDD_008 <- NA ; HBN_data$GOASSESS_CDD_006 <- NA ; HBN_data$GOASSESS_CDD_007 <- NA ; HBN_data$GOASSESS_SCR_006 <- NA ; HBN_data$GOASSESS_CDD_004 <- NA ; HBN_data$GOASSESS_SIP_038 <- NA ; HBN_data$GOASSESS_DEP_001 <- NA ; HBN_data$GOASSESS_DEP_002 <- NA ; HBN_data$GOASSESS_SUI_002 <- NA ; HBN_data$GOASSESS_DEP_004 <- NA ; HBN_data$GOASSESS_SIP_032 <- NA ;  HBN_data$GOASSESS_MAN_007 <- NA ; HBN_data$GOASSESS_DEP_006 <- NA ; HBN_data$GOASSESS_OCD_001 <- NA ; HBN_data$GOASSESS_PAN_004 <- NA ; HBN_data$GOASSESS_PAN_001 <- NA ; HBN_data$GOASSESS_SCR_007 <- NA ; HBN_data$GOASSESS_GAD_002 <- NA ; HBN_data$GOASSESS_OCD_007 <- NA ; HBN_data$GOASSESS_SUI_001 <- NA ; HBN_data$GOASSESS_OCD_005 <- NA ; HBN_data$GOASSESS_PAN_003 <- NA ; HBN_data$GOASSESS_MAN_005 <- NA ;  HBN_data$GOASSESS_GAD_001 <- NA ; HBN_data$GOASSESS_SIP_033 <- NA ; HBN_data$GOASSESS_OCD_006 <- NA ; HBN_data$GOASSESS_OCD_004 <- NA ; HBN_data$GOASSESS_OCD_016 <- NA ; HBN_data$GOASSESS_OCD_008 <- NA ; HBN_data$GOASSESS_OCD_003 <- NA ; HBN_data$GOASSESS_MAN_004 <- NA ; HBN_data$GOASSESS_MAN_003 <- NA ; HBN_data$GOASSESS_OCD_019 <- NA ; HBN_data$GOASSESS_MAN_002 <- NA ; HBN_data$GOASSESS_MAN_006 <- NA ;  HBN_data$GOASSESS_CDD_002 <- NA ; HBN_data$GOASSESS_MAN_001 <- NA ; HBN_data$GOASSESS_SCR_001 <- NA ; HBN_data$GOASSESS_OCD_002 <- NA ; HBN_data$GOASSESS_OCD_012 <- NA ; HBN_data$GOASSESS_SIP_039 <- NA ; HBN_data$GOASSESS_OCD_018 <- NA ; HBN_data$GOASSESS_PTD_009 <- NA ; HBN_data$GOASSESS_SCR_008 <- NA ; HBN_data$GOASSESS_AGR_006 <- NA ; HBN_data$GOASSESS_SOC_004 <- NA ; HBN_data$GOASSESS_AGR_005 <- NA ;  HBN_data$GOASSESS_SOC_005 <- NA ; HBN_data$GOASSESS_AGR_002 <- NA ; HBN_data$GOASSESS_AGR_008 <- NA ; HBN_data$GOASSESS_SOC_001 <- NA ; HBN_data$GOASSESS_AGR_001 <- NA ; HBN_data$GOASSESS_SOC_003 <- NA ; HBN_data$GOASSESS_AGR_003 <- NA ; HBN_data$GOASSESS_AGR_004 <- NA ; HBN_data$GOASSESS_SOC_002 <- NA ; HBN_data$GOASSESS_PHB_004 <- NA ; HBN_data$GOASSESS_SEP_509 <- NA ; HBN_data$GOASSESS_PHB_007 <- NA ;  HBN_data$GOASSESS_AGR_007 <- NA ; HBN_data$GOASSESS_PHB_006 <- NA ; HBN_data$GOASSESS_PHB_001 <- NA ; HBN_data$GOASSESS_OCD_013 <- NA ; HBN_data$GOASSESS_PHB_002 <- NA ; HBN_data$GOASSESS_SEP_508 <- NA ; HBN_data$GOASSESS_PHB_008 <- NA ; HBN_data$GOASSESS_OCD_011 <- NA ; HBN_data$GOASSESS_PHB_005 <- NA ; HBN_data$GOASSESS_OCD_017 <- NA ; HBN_data$GOASSESS_SEP_500 <- NA ; HBN_data$GOASSESS_OCD_015 <- NA ;  HBN_data$GOASSESS_SEP_511 <- NA ; HBN_data$GOASSESS_PHB_003 <- NA ; HBN_data$GOASSESS_OCD_014 <- NA ; HBN_data$GOASSESS_SEP_510 <- NA ; HBN_data$GOASSESS_SUI_001_002 <- NA ; HBN_data$GOASSESS_SUI_003 <- NA ; HBN_data$GOASSESS_SUI_004 <- NA ; HBN_data$GOASSESS_SUI_005 <- NA ; HBN_data$GOASSESS_SUI_006 <- NA ; HBN_data$GOASSESS_SUI_007 <- NA ; HBN_data$GOASSESS_SUI_008 <- NA ; HBN_data$GOASSESS_SUI_009 <- NA ;
HBN_data$SMRY_SUI <- NA


n_occur <- data.frame(table(HBN_data$EID))
n_occur[n_occur$Freq > 1,]
HBN_data[HBN_data$EID %in% n_occur$Var1[n_occur$Freq > 1],]
HBN_data <- HBN_data %>% slice(-c(936, 3085, 3086, 3087))
rm(n_occur)

```

# Renaming variables for merging data in BHRC
```{r Renaming variables for merging data in BHRC, message=F, warning=F}
# Data
BHRC_data <- import(file="BHRC_2020_11_05.Rds")
#options(max.print=1000000)
#names(BHRC_data)
# correction to include site, gender and skincolor in all waves and filter for only those with responses at follow-ups
mydata_w0 <- BHRC_data %>% dplyr::filter(redcap_event_name=="wave0_arm_1", dcany!="NA")
mydata_w1 <- BHRC_data %>% dplyr::filter(redcap_event_name=="wave1_arm_1", dcany!="NA")
mydata_w2 <- BHRC_data %>% dplyr::filter(redcap_event_name=="wave2_arm_1", dcany!="NA") %>% dplyr::select(-state, -gender, -skincolor)
mydata_complement <- BHRC_data %>% dplyr::filter(redcap_event_name=="wave0_arm_1") %>% dplyr::select(ident, state, gender, skincolor)
mydata_w2 <- left_join(mydata_w2,mydata_complement, by="ident") 
BHRC_data <- rbind(mydata_w0, mydata_w1, mydata_w2)
rm(mydata_w0, mydata_w1, mydata_w2, mydata_complement)

# BHRC demographics
BHRC_data<-dplyr::rename(BHRC_data,EID=ident); BHRC_data$EID<-as.character(BHRC_data$EID)
BHRC_data$Study<-"BHRC"
BHRC_data<-BHRC_data %>% mutate(Selection = case_when(selection==1 ~ "Community", 
                                       selection==2 ~ "High_risk"))
BHRC_data<-BHRC_data %>% mutate(wave = case_when(redcap_event_name=="wave0_arm_1" ~ 1, 
                                       redcap_event_name=="wave1_arm_1" ~ 2,
                                       redcap_event_name=="wave2_arm_1" ~ 3))
#BHRC_data<-BHRC_data %>% mutate(Site = case_when(state=="Rio Grande do Sul" ~ "BHRC-1", state=="So Paulo"~ "BHRC-2"))
BHRC_data<-BHRC_data %>% mutate(Site = case_when(state=="1" ~ "BHRC-1", state=="2"~ "BHRC-2"))
#BHRC_data<-BHRC_data %>% mutate(Gender = case_when(gender=="Female" ~ 1, gender=="Male"~ 2))
BHRC_data<-BHRC_data %>% mutate(Gender = case_when(gender=="1" ~ "Male", gender=="2"~ "Female"))
BHRC_data$Gender <- as.factor(BHRC_data$Gender)
BHRC_data<-dplyr::rename(BHRC_data,Age=age)
BHRC_data<-BHRC_data %>% mutate(Age_group_3cat = case_when(Age>=5 & Age<11 ~ "5_to_10", 
                                                      Age>=11& Age<15 ~ "11_to_14",
                                                      Age>=15 ~ "15_or_higher"))
BHRC_data$Age_group_3cat <- ordered(BHRC_data$Age_group_3cat, levels = c("5_to_10", "11_to_14", "15_or_higher")) 

BHRC_data$Child_race <- BHRC_data$skincolor
BHRC_data <- BHRC_data %>% mutate(Child_race=car::recode(Child_race,"1='White';2='Black'; 3='Mixed';5='Asian'; 4='Native'"))

BHRC_data$Sampling_weight <- BHRC_data$weight
# Maternal diagnosis
BHRC_data<-dplyr::rename(BHRC_data,Maternal_DIAG_ANY=imini_cur_any)
# Birth weight (kg)
BHRC_data$Birth_weight<- BHRC_data$birthweight/1000
# Delivery
BHRC_data<-dplyr::rename(BHRC_data,Birth_delivery=fat11)
BHRC_data <- BHRC_data %>% mutate(Birth_delivery=car::recode(Birth_delivery,"1='C_section';2='Vaginal';99=NA"))
summary.factor(BHRC_data$Birth_delivery)
# Premature
BHRC_data<-dplyr::rename(BHRC_data,Birth_premature=prematurity)
BHRC_data <- BHRC_data %>% mutate(Birth_premature=car::recode(Birth_premature,"1='Term/Posterm';0='Preterm'"))
summary.factor(BHRC_data$Birth_premature)
# Preg duration (weeks)
BHRC_data<-dplyr::rename(BHRC_data,Birth_preg_dur=gestage)
# BMI
BHRC_data<-dplyr::rename(BHRC_data,BMI=p_bmi)
# Education

BHRC_data_w0 <- BHRC_data %>% dplyr::filter(wave==1)
BHRC_data_w1 <- BHRC_data %>% dplyr::filter(wave==2)
BHRC_data_w2 <- BHRC_data %>% dplyr::filter(wave==3)

BHRC_data_w0 <- BHRC_data_w0 %>% mutate(School_repet= 
                case_when(fat24==1 ~ 1,
                          fat24==0 ~ 0,
                          fat24==99 ~ NA_real_))
BHRC_data_w0 <- BHRC_data_w0 %>% mutate(School_exp= 
                case_when(fat25==1|fat26==1 ~ 1,
                          fat25==0 & fat26==0 ~ 0,
                          fat25==99 ~ NA_real_))
BHRC_data_w0 <- BHRC_data_w0 %>% mutate(School_susp= 
                case_when(fat27==1 ~ 1,
                          fat27==0 ~ 0,
                          fat27==99 ~ NA_real_))

BHRC_data_w1 <- BHRC_data_w1 %>% mutate(School_repet= 
                case_when(le4_unite==1 ~ 1,
                          le4_unite==0 ~ 0,
                          le4_unite==99 ~ NA_real_))
BHRC_data_w1 <- BHRC_data_w1 %>% mutate(School_exp= 
                case_when(le5_unite==1|le7_unite==1|instlevel==13 ~ 1,
                          le5_unite==0 & le7_unite==0 & instlevel!=13 ~ 0,
                          le5_unite==99 & le7_unite==99 ~ NA_real_))
BHRC_data_w1 <- BHRC_data_w1 %>% mutate(School_susp= 
                case_when(le6_unite==1 ~ 1,
                          le6_unite==0 ~ 0,
                          le6_unite==99 ~ NA_real_))

BHRC_data_w2 <- BHRC_data_w2 %>% mutate(School_repet= 
                case_when(le4_unite==1 ~ 1,
                          le4_unite==0 ~ 0,
                          le4_unite==99 ~ NA_real_))
BHRC_data_w2 <- BHRC_data_w2 %>% mutate(School_exp= 
                case_when(le5_unite==1|le7_unite==1 ~ 1,
                          le5_unite==0 & le7_unite==0 ~ 0,
                          le5_unite==99 & le7_unite==99 ~ NA_real_))
BHRC_data_w2 <- BHRC_data_w2 %>% mutate(School_susp= 
                case_when(le6_unite==1 ~ 1,
                          le6_unite==0 ~ 0,
                          le6_unite==99 ~ NA_real_))

BHRC_data <- rbind(BHRC_data_w0, BHRC_data_w1, BHRC_data_w2)
rm(BHRC_data_w0, BHRC_data_w1, BHRC_data_w2)

BHRC_data<-dplyr::rename(BHRC_data,School_years=instlevel)
summary.factor(BHRC_data$School_years)
get_labels(BHRC_data$School_years)
BHRC_data <- BHRC_data %>% mutate(School_years=car::recode(School_years,"13=NA"))

# IQ
BHRC_data$IQraw<- BHRC_data$DQ
fit_iq_resid <- glm(IQraw ~ Age + Gender, data=BHRC_data); summary(fit_iq_resid)
IQ_resid <- rstandard(fit_iq_resid)
IQ_data <- BHRC_data %>% dplyr::select(EID, IQraw) %>% drop_na() %>% dplyr::select(EID)
IQ_data <- cbind(IQ_data, IQ_resid)
BHRC_data <- BHRC_data %>% left_join(IQ_data, by="EID")
BHRC_data$IQ <- (BHRC_data$IQ_resid*15)+100
rm(IQ_data, fit_iq_resid, IQ_resid)

# Selecting and filter for response at follow-up
#BHRC_data<-dplyr::select(BHRC_data,EID,Study,Site,wave,Age,Age_group,Gender, MATERNAL_DIAG_ANY,p1consid:cl113, dcany:dcanydep) %>% filter(p1consid!="NA")

# SDQ parent
BHRC_data <-  BHRC_data %>% mutate_at(vars(starts_with("p1")),as.numeric)  
BHRC_data$p1obeys <- 2-BHRC_data$p1obeys 
BHRC_data$p1reflect <- 2-BHRC_data$p1reflect
BHRC_data$p1attends <- 2-BHRC_data$p1attends
BHRC_data$p1friend <- 2-BHRC_data$p1friend
BHRC_data$p1popular <- 2-BHRC_data$p1popular
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_3=p1somatic)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_8=p1worries)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_13=p1unhappy)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_16=p1clingy)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_24=p1afraid)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_5=p1tantrum)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_7=p1obeys)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_12=p1fights)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_18=p1lies)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_22=p1steals)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_2=p1restles)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_10=p1fidgety)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_15=p1distrac)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_21=p1reflect)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_25=p1attends)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_6=p1loner)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_11=p1friend)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_14=p1popular)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_19=p1bullied)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_23=p1oldbest)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_1=p1consid)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_4=p1shares)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_9=p1caring)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_17=p1kind)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_20=p1helpout)

BHRC_data<-dplyr::rename(BHRC_data,pSDQ_26=p1ebddiff)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_26b=p1distres)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_26c=p1imphome)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_26d=p1impfrie)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_26e=p1impclas)
BHRC_data<-dplyr::rename(BHRC_data,pSDQ_26f=p1impleis)

BHRC_data <- BHRC_data %>%  mutate(pSDQ_26b=
            case_when(pSDQ_26b==0 ~ 0,
                      pSDQ_26b==1 ~ 1,
                      pSDQ_26b==2 ~ 2,
                      pSDQ_26b==3 ~ 3,
                      pSDQ_26==0 ~ 0)) # Distress
BHRC_data <- BHRC_data %>%  mutate(pSDQ_26c=
            case_when(pSDQ_26c==0 ~ 0,
                      pSDQ_26c==1 ~ 1,
                      pSDQ_26c==2 ~ 2,
                      pSDQ_26c==3 ~ 3,
                      pSDQ_26==0 ~ 0)) # Home
BHRC_data <- BHRC_data %>%  mutate(pSDQ_26d=
            case_when(pSDQ_26d==0 ~ 0,
                      pSDQ_26d==1 ~ 1,
                      pSDQ_26d==2 ~ 2,
                      pSDQ_26d==3 ~ 3,
                      pSDQ_26==0 ~ 0)) # Friendship
BHRC_data <- BHRC_data %>%  mutate(pSDQ_26e=
            case_when(pSDQ_26e==0 ~ 0,
                      pSDQ_26e==1 ~ 1,
                      pSDQ_26e==2 ~ 2,
                      pSDQ_26e==3 ~ 3,
                      pSDQ_26==0 ~ 0)) # Classrom
BHRC_data <- BHRC_data %>%  mutate(pSDQ_26f=
            case_when(pSDQ_26f==0 ~ 0,
                      pSDQ_26f==1 ~ 1,
                      pSDQ_26f==2 ~ 2,
                      pSDQ_26f==3 ~ 3,
                      pSDQ_26==0 ~ 0)) # Leisure

BHRC_data <- BHRC_data %>%mutate_at(vars(starts_with("pSDQ")),ordered) 
# SDQ teacher
BHRC_data <-  BHRC_data %>% mutate_at(vars(starts_with("t1")),as.numeric)  
BHRC_data$t1obeys <- 2-BHRC_data$t1obeys 
BHRC_data$t1reflect <- 2-BHRC_data$t1reflect
BHRC_data$t1attends <- 2-BHRC_data$t1attends
BHRC_data$t1friend <- 2-BHRC_data$t1friend
BHRC_data$t1popular <- 2-BHRC_data$t1popular
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_3=t1somatic)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_8=t1worries)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_13=t1unhappy)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_16=t1clingy)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_24=t1afraid)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_5=t1tantrum)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_7=t1obeys)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_12=t1fights)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_18=t1lies)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_22=t1steals)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_2=t1restles)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_10=t1fidgety)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_15=t1distrac)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_21=t1reflect)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_25=t1attends)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_6=t1loner)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_11=t1friend)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_14=t1popular)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_19=t1bullied)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_23=t1oldbest)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_1=t1consid)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_4=t1shares)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_9=t1caring)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_17=t1kind)
BHRC_data<-dplyr::rename(BHRC_data,tSDQ_20=t1helpout)
BHRC_data <- BHRC_data %>%mutate_at(vars(starts_with("tSDQ")),ordered) 
# SDQ self
BHRC_data <-  BHRC_data %>% mutate_at(vars("sconsid", "srestles","ssomatic", "sshares", "stantrum",
"sloner", "sobeys", "sworries", "scaring", "sfidgety", "sfriend", "sfights", "sunhappy", "spopular", "sdistrac", "sclingy", "skind", "slies", "sbullied", "shelpout", "sreflect", "ssteals", "soldbest", "safraid", "sattends"),as.numeric)  
BHRC_data$sobeys <- 2-BHRC_data$sobeys 
BHRC_data$sreflect <- 2-BHRC_data$sreflect
BHRC_data$sattends <- 2-BHRC_data$sattends
BHRC_data$sfriend <- 2-BHRC_data$sfriend
BHRC_data$spopular <- 2-BHRC_data$spopular
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_3=ssomatic)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_8=sworries)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_13=sunhappy)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_16=sclingy)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_24=safraid)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_5=stantrum)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_7=sobeys)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_12=sfights)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_18=slies)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_22=ssteals)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_2=srestles)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_10=sfidgety)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_15=sdistrac)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_21=sreflect)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_25=sattends)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_6=sloner)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_11=sfriend)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_14=spopular)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_19=sbullied)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_23=soldbest)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_1=sconsid)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_4=sshares)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_9=scaring)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_17=skind)
BHRC_data<-dplyr::rename(BHRC_data,sSDQ_20=shelpout)
BHRC_data <- BHRC_data %>%mutate_at(vars(starts_with("sSDQ")),ordered) 

# CBCL
colnames(BHRC_data)<-str_replace(colnames(BHRC_data), "cl", "CBCL_")
BHRC_data <-  BHRC_data %>% mutate_at(vars(starts_with("CBCL")),as.numeric) 
BHRC_data<-dplyr::rename(BHRC_data,CBCL_56A=CBCL_56a)
BHRC_data<-dplyr::rename(BHRC_data,CBCL_56B=CBCL_56b)
BHRC_data<-dplyr::rename(BHRC_data,CBCL_56C=CBCL_56c)
BHRC_data<-dplyr::rename(BHRC_data,CBCL_56D=CBCL_56d)
BHRC_data<-dplyr::rename(BHRC_data,CBCL_56E=CBCL_56e)
BHRC_data<-dplyr::rename(BHRC_data,CBCL_56F=CBCL_56f)
BHRC_data<-dplyr::rename(BHRC_data,CBCL_56G=CBCL_56g)
BHRC_data<-dplyr::rename(BHRC_data,CBCL_56H=CBCL_56h)

BHRC_data<-BHRC_data %>% mutate(CBCL_56 = car::recode(CBCL_56, "NA=99"))
BHRC_data<-BHRC_data %>% mutate(CBCL_56H = car::recode(CBCL_56H, "NA=99"))
BHRC_data <- BHRC_data %>% mutate(CBCL_56H= 
                case_when(CBCL_56H==1 ~ 1,
                          CBCL_56H==2 ~ 2,
                          CBCL_56H==0 ~ 0,
                          CBCL_56!=99 & CBCL_56H==99  ~ 0,
                          CBCL_56==99 & CBCL_56H==99  ~ NA_real_))
BHRC_data<-BHRC_data %>% mutate(CBCL_56 = car::recode(CBCL_56, "99=NA"))

BHRC_data <-  BHRC_data %>% mutate_at(vars(starts_with("CBCL")),ordered) 

# ABCL
colnames(BHRC_data)<-str_replace(colnames(BHRC_data), "abCBCL", "al")
abcl_data <- BHRC_data %>%dplyr::select(EID, wave, al_5a:al_10, al1:al126)
colnames(abcl_data)<-str_replace(colnames(abcl_data), "al", "ABCL_")
abcl_data <-  abcl_data %>% mutate_at(vars(starts_with("ABCL")),as.numeric) 
abcl_data<-dplyr::rename(abcl_data,ABCL_56A=ABCL_56a)
abcl_data<-dplyr::rename(abcl_data,ABCL_56B=ABCL_56b)
abcl_data<-dplyr::rename(abcl_data,ABCL_56C=ABCL_56c)
abcl_data<-dplyr::rename(abcl_data,ABCL_56D=ABCL_56d)
abcl_data<-dplyr::rename(abcl_data,ABCL_56E=ABCL_56e)
abcl_data<-dplyr::rename(abcl_data,ABCL_56F=ABCL_56f)
abcl_data<-dplyr::rename(abcl_data,ABCL_56G=ABCL_56g)
abcl_data<-dplyr::select(abcl_data,-ABCL_56d_1, -ABCL_6_1, -ABCL_9_1, -ABCL_29_1, -ABCL_46_1, -ABCL_40_1, -ABCL_66_1, -ABCL_58_1, -ABCL_70_1, -ABCL_77_1, -ABCL_79_1, -ABCL_84_1, -ABCL_85_1, -ABCL_92_1, -ABCL_100_1)

BHRC_abcl <- abcl_data %>% dplyr::select(EID,wave, ABCL_1:ABCL_126) %>% dplyr::filter(wave==3)
BHRC_abcl <- BHRC_abcl[complete.cases(BHRC_abcl[ ,3]),]
BHRC_abcl$CBCL_1<-NA
BHRC_abcl$CBCL_2<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_3=ABCL_3)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_4=ABCL_59)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_5=ABCL_60)
BHRC_abcl$CBCL_6<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_7=ABCL_7)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_8=ABCL_8)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_9=ABCL_9)
BHRC_abcl<-BHRC_abcl %>% mutate(ABCL_10 = car::recode(ABCL_10, "NA=99"))
BHRC_abcl<-BHRC_abcl %>% mutate(ABCL_115 = car::recode(ABCL_115, "NA=99"))
BHRC_abcl <- BHRC_abcl %>%  mutate(CBCL_10=
            case_when(ABCL_10==99 & ABCL_115==99 ~ NA_real_,
                      (ABCL_10==2 | ABCL_115==2) ~ 2,
                      (ABCL_10==1 | ABCL_115==1) & 
                       (ABCL_10!=2 | ABCL_115!=2) ~ 1,
                      TRUE ~ 0))
BHRC_abcl<-BHRC_abcl %>% mutate(ABCL_10 = car::recode(ABCL_10, "99=NA"))
BHRC_abcl<-BHRC_abcl %>% mutate(ABCL_115 = car::recode(ABCL_115, "99=NA"))
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_11=ABCL_11)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_12=ABCL_12)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_13=ABCL_13)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_14=ABCL_14)
BHRC_abcl$CBCL_15<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_16=ABCL_16)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_17=ABCL_17)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_18=ABCL_18)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_19=ABCL_19)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_20=ABCL_20)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_21=ABCL_21)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_22=ABCL_28)
BHRC_abcl$CBCL_23<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_24=ABCL_24)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_25=ABCL_25)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_26=ABCL_26)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_27=ABCL_27)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_28=ABCL_23)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_29=ABCL_29)
BHRC_abcl$CBCL_30<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_31=ABCL_31)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_32=ABCL_32)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_33=ABCL_33)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_34=ABCL_34)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_35=ABCL_35)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_36=ABCL_36)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_37=ABCL_37)
BHRC_abcl$CBCL_38<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_39=ABCL_39)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_40=ABCL_40)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_41=ABCL_41)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_42=ABCL_42)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_43=ABCL_43)
BHRC_abcl$CBCL_44<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_45=ABCL_45)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_46=ABCL_46)
BHRC_abcl$CBCL_47<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_48=ABCL_48)
BHRC_abcl$CBCL_49<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_50=ABCL_50)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_51=ABCL_51)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_52=ABCL_52)
BHRC_abcl$CBCL_53<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_54=ABCL_54)
BHRC_abcl$CBCL_55<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_56=ABCL_56)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_56A=ABCL_56A)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_56B=ABCL_56B)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_56C=ABCL_56C)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_56D=ABCL_56D)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_56E=ABCL_56E)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_56F=ABCL_56F)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_56G=ABCL_56G)
BHRC_abcl$CBCL_56H<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_57=ABCL_57)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_58=ABCL_58)
BHRC_abcl$CBCL_59<-NA
BHRC_abcl$CBCL_60<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_61=ABCL_61)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_62=ABCL_62)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_63=ABCL_63)
BHRC_abcl$CBCL_64<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_65=ABCL_65)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_66=ABCL_66)
BHRC_abcl$CBCL_67<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_68=ABCL_68)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_69=ABCL_69)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_70=ABCL_70)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_71=ABCL_71)
BHRC_abcl$CBCL_72<-NA
BHRC_abcl$CBCL_73<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_74=ABCL_74)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_75=ABCL_75)
BHRC_abcl$CBCL_76<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_77=ABCL_77)
BHRC_abcl$CBCL_78<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_79=ABCL_79)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_80=ABCL_80)
BHRC_abcl$CBCL_81<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_82=ABCL_82)
BHRC_abcl$CBCL_83<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_84=ABCL_84)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_85=ABCL_85)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_86=ABCL_86)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_87=ABCL_87)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_88=ABCL_113)
BHRC_abcl$CBCL_89<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_90=ABCL_90)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_91=ABCL_91)
BHRC_abcl$CBCL_92<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_93=ABCL_93)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_94=ABCL_94)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_95=ABCL_95)
BHRC_abcl$CBCL_96<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_97=ABCL_97)
BHRC_abcl$CBCL_98<-NA
BHRC_abcl$CBCL_99<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_100=ABCL_100)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_101=ABCL_101)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_102=ABCL_102)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_103=ABCL_103)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_104=ABCL_104)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_105=ABCL_6)
BHRC_abcl$CBCL_106<-NA
BHRC_abcl$CBCL_107<-NA
BHRC_abcl$CBCL_108<-NA
BHRC_abcl$CBCL_109<-NA
BHRC_abcl$CBCL_110<-NA
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_111=ABCL_111)
BHRC_abcl<-dplyr::rename(BHRC_abcl,CBCL_112=ABCL_112)
BHRC_abcl$CBCL_113<-NA
BHRC_cbcl <- BHRC_data %>% dplyr::select(EID,wave, CBCL_1:CBCL_113)
BHRC_cbcl <- BHRC_cbcl[complete.cases(BHRC_cbcl[ ,3]),]
cbcl_var_list <- list(names(BHRC_cbcl)); cbcl_var_list <- cbcl_var_list[[1]]
BHRC_abcl<- BHRC_abcl %>% dplyr::select(cbcl_var_list)
BHRC_cbcl <- rbind(BHRC_cbcl, BHRC_abcl)
BHRC_cbcl <-  BHRC_cbcl %>% mutate_at(vars(starts_with("CBCL")),ordered) 
BHRC_data <- BHRC_data %>% dplyr::select(EID:cb4h, CBCL_56h_oth:IQ)
BHRC_data <- BHRC_data %>% left_join(BHRC_cbcl, by=c("EID", "wave"))
rm(abcl_data, BHRC_abcl, BHRC_cbcl, cbcl_var_list)

# DAWBA
colnames(BHRC_data)<-str_replace(colnames(BHRC_data), "dc", "DIAG_")
BHRC_data <-  BHRC_data %>% mutate_at(vars(starts_with("DIAG")),as.numeric) 
BHRC_data<-dplyr::rename(BHRC_data,DIAG_ANY=DIAG_any)
BHRC_data<-dplyr::rename(BHRC_data,DIAG_SEP_ANX=DIAG_sepa)
BHRC_data<-dplyr::rename(BHRC_data,DIAG_SPEC_PHOB=DIAG_spph)
BHRC_data<-dplyr::rename(BHRC_data,DIAG_SOC_PHOB=DIAG_soph)
BHRC_data<-dplyr::rename(BHRC_data,DIAG_PANIC=DIAG_panic)
BHRC_data<-dplyr::rename(BHRC_data,DIAG_AGORAPHOB=DIAG_agor)
BHRC_data<-dplyr::rename(BHRC_data,DIAG_PTSD=DIAG_ptsd)
BHRC_data<-dplyr::rename(BHRC_data,DIAG_OCD=DIAG_ocd)
BHRC_data<-dplyr::rename(BHRC_data,DIAG_GEN_ANX=DIAG_gena)
BHRC_data<-dplyr::rename(BHRC_data,DIAG_Other_ANX=DIAG_otanx)
BHRC_data<-dplyr::rename(BHRC_data,DIAG_DMDD=DIAG_dmdd)
BHRC_data<-dplyr::rename(BHRC_data,DIAG_DEP=DIAG_anydep)
BHRC_data<-dplyr::rename(BHRC_data,DIAG_MANIA=DIAG_mania)
BHRC_data<-dplyr::rename(BHRC_data,DIAG_ADHD=DIAG_anyhk)
BHRC_data <- BHRC_data %>%  mutate(DIAG_CD=
           case_when(DIAG_cd==0 & DIAG_othcd==0 ~ 0,
                     DIAG_cd==2 | DIAG_othcd==2 ~ 2))
BHRC_data<-dplyr::rename(BHRC_data,DIAG_ODD=DIAG_odd)
BHRC_data <- BHRC_data %>%  mutate(DIAG_EAT=
           case_when(DIAG_eat==0 ~ 0,
                     DIAG_eat==2 ~ 2,
                     DIAG_eat==3 ~ 2,
                     DIAG_eat==4 ~ 2,
                     DIAG_eat==5 ~ 2))
BHRC_data <- BHRC_data %>%  mutate(DIAG_AUTISM=
           case_when(DIAG_pdd==0 ~ 0,
                     DIAG_pdd==2 ~ 2,
                     DIAG_pdd==3 ~ 2,
                     DIAG_pdd==4 ~ 2))
BHRC_data <- BHRC_data %>%  mutate(DIAG_TIC=
           case_when(DIAG_tic==0 ~ 0,
                     DIAG_tic==2 ~ 2,
                     DIAG_tic==3 ~ 2,
                     DIAG_tic==4 ~ 2))
BHRC_data<-dplyr::rename(BHRC_data,DIAG_PSYCH=DIAG_psych)

BHRC_data<- BHRC_data %>% dplyr::select(-DIAG_emot, -DIAG_madep, -DIAG_otdep, -DIAG_undif, -DIAG_anyso, -DIAG_mutis, -DIAG_disat, -DIAG_inhat, -DIAG_othat, -DIAG_adhdc, -DIAG_adhdi, -DIAG_adhdh, -DIAG_adhdo, -DIAG_anycd, -DIAG_other, -DIAG_pdd, -DIAG_tic, -DIAG_eat, -DIAG_stere, -DIAG_ototh, -DIAG_anyanx, -DIAG_cd, -DIAG_othcd)
BHRC_data <- BHRC_data %>% mutate_at(vars(starts_with("DIAG")),dplyr::funs(case_when(.=="0" ~ 0,.=="2" ~ 1)))
BHRC_data <-  BHRC_data %>% mutate_at(vars(contains("DIAG")),ordered) 

# Insert vars to match other data sets

BHRC_data$YSR_1<-NA; BHRC_data$YSR_2<-NA; BHRC_data$YSR_3<-NA; BHRC_data$YSR_4<-NA; BHRC_data$YSR_5<-NA; BHRC_data$YSR_6<-NA; BHRC_data$YSR_7<-NA; BHRC_data$YSR_8<-NA; BHRC_data$YSR_9<-NA; BHRC_data$YSR_10<-NA; BHRC_data$YSR_11<-NA; BHRC_data$YSR_12<-NA; BHRC_data$YSR_13<-NA; BHRC_data$YSR_14<-NA; BHRC_data$YSR_15<-NA; BHRC_data$YSR_16<-NA; BHRC_data$YSR_17<-NA; BHRC_data$YSR_18<-NA; BHRC_data$YSR_19<-NA; BHRC_data$YSR_20<-NA; BHRC_data$YSR_21<-NA; BHRC_data$YSR_22<-NA; BHRC_data$YSR_23<-NA; BHRC_data$YSR_24<-NA; BHRC_data$YSR_25<-NA; BHRC_data$YSR_26<-NA; BHRC_data$YSR_27<-NA; BHRC_data$YSR_28<-NA; BHRC_data$YSR_29<-NA; BHRC_data$YSR_30<-NA; BHRC_data$YSR_31<-NA; BHRC_data$YSR_32<-NA; BHRC_data$YSR_33<-NA; BHRC_data$YSR_34<-NA; BHRC_data$YSR_35<-NA; BHRC_data$YSR_36<-NA; BHRC_data$YSR_37<-NA; BHRC_data$YSR_38<-NA; BHRC_data$YSR_39<-NA; BHRC_data$YSR_40<-NA; BHRC_data$YSR_41<-NA; BHRC_data$YSR_42<-NA; BHRC_data$YSR_43<-NA; BHRC_data$YSR_44<-NA; BHRC_data$YSR_45<-NA; BHRC_data$YSR_46<-NA; BHRC_data$YSR_47<-NA; BHRC_data$YSR_48<-NA; BHRC_data$YSR_49<-NA; BHRC_data$YSR_50<-NA; BHRC_data$YSR_51<-NA; BHRC_data$YSR_52<-NA; BHRC_data$YSR_53<-NA; BHRC_data$YSR_54<-NA; BHRC_data$YSR_55<-NA; BHRC_data$YSR_56<-NA; BHRC_data$YSR_57<-NA; BHRC_data$YSR_58<-NA; BHRC_data$YSR_59<-NA; BHRC_data$YSR_60<-NA; BHRC_data$YSR_56A<-NA; BHRC_data$YSR_56B<-NA; BHRC_data$YSR_56C<-NA;BHRC_data$YSR_56D<-NA; BHRC_data$YSR_56E<-NA; BHRC_data$YSR_56F<-NA; BHRC_data$YSR_56G<-NA; BHRC_data$YSR_56H<-NA;  BHRC_data$YSR_61<-NA; BHRC_data$YSR_62<-NA; BHRC_data$YSR_63<-NA; BHRC_data$YSR_64<-NA; BHRC_data$YSR_65<-NA; BHRC_data$YSR_66<-NA; BHRC_data$YSR_67<-NA; BHRC_data$YSR_68<-NA; BHRC_data$YSR_69<-NA; BHRC_data$YSR_70<-NA; BHRC_data$YSR_71<-NA; BHRC_data$YSR_72<-NA; BHRC_data$YSR_73<-NA; BHRC_data$YSR_74<-NA; BHRC_data$YSR_75<-NA; BHRC_data$YSR_76<-NA; BHRC_data$YSR_77<-NA; BHRC_data$YSR_78<-NA; BHRC_data$YSR_79<-NA; BHRC_data$YSR_80<-NA; BHRC_data$YSR_81<-NA; BHRC_data$YSR_82<-NA; BHRC_data$YSR_83<-NA; BHRC_data$YSR_84<-NA; BHRC_data$YSR_85<-NA; BHRC_data$YSR_86<-NA; BHRC_data$YSR_87<-NA; BHRC_data$YSR_88<-NA; BHRC_data$YSR_89<-NA; BHRC_data$YSR_90<-NA; BHRC_data$YSR_91<-NA; BHRC_data$YSR_92<-NA; BHRC_data$YSR_93<-NA; BHRC_data$YSR_94<-NA; BHRC_data$YSR_95<-NA; BHRC_data$YSR_96<-NA; BHRC_data$YSR_97<-NA; BHRC_data$YSR_98<-NA; BHRC_data$YSR_99<-NA; BHRC_data$YSR_100<-NA; BHRC_data$YSR_101<-NA; BHRC_data$YSR_102<-NA; BHRC_data$YSR_103<-NA; BHRC_data$YSR_104<-NA; BHRC_data$YSR_105<-NA; BHRC_data$YSR_106<-NA; BHRC_data$YSR_107<-NA; BHRC_data$YSR_108<-NA; BHRC_data$YSR_109<-NA; BHRC_data$YSR_110<-NA; BHRC_data$YSR_111<-NA; BHRC_data$YSR_112<-NA

BHRC_data$TRF_1<-NA; BHRC_data$TRF_2<-NA; BHRC_data$TRF_3<-NA; BHRC_data$TRF_4<-NA; BHRC_data$TRF_5<-NA; BHRC_data$TRF_6<-NA; BHRC_data$TRF_7<-NA; BHRC_data$TRF_8<-NA; BHRC_data$TRF_9<-NA; BHRC_data$TRF_10<-NA; BHRC_data$TRF_11<-NA; BHRC_data$TRF_12<-NA; BHRC_data$TRF_13<-NA; BHRC_data$TRF_14<-NA; BHRC_data$TRF_15<-NA; BHRC_data$TRF_16<-NA; BHRC_data$TRF_17<-NA; BHRC_data$TRF_18<-NA; BHRC_data$TRF_19<-NA; BHRC_data$TRF_20<-NA; BHRC_data$TRF_21<-NA; BHRC_data$TRF_22<-NA; BHRC_data$TRF_23<-NA; BHRC_data$TRF_24<-NA; BHRC_data$TRF_25<-NA; BHRC_data$TRF_26<-NA; BHRC_data$TRF_27<-NA; BHRC_data$TRF_28<-NA; BHRC_data$TRF_29<-NA; BHRC_data$TRF_30<-NA; BHRC_data$TRF_31<-NA; BHRC_data$TRF_32<-NA; BHRC_data$TRF_33<-NA; BHRC_data$TRF_34<-NA; BHRC_data$TRF_35<-NA; BHRC_data$TRF_36<-NA; BHRC_data$TRF_37<-NA; BHRC_data$TRF_38<-NA; BHRC_data$TRF_39<-NA; BHRC_data$TRF_40<-NA; BHRC_data$TRF_41<-NA; BHRC_data$TRF_42<-NA; BHRC_data$TRF_43<-NA; BHRC_data$TRF_44<-NA; BHRC_data$TRF_45<-NA; BHRC_data$TRF_46<-NA; BHRC_data$TRF_47<-NA; BHRC_data$TRF_48<-NA; BHRC_data$TRF_49<-NA; BHRC_data$TRF_50<-NA; BHRC_data$TRF_51<-NA; BHRC_data$TRF_52<-NA; BHRC_data$TRF_53<-NA; BHRC_data$TRF_54<-NA; BHRC_data$TRF_55<-NA; BHRC_data$TRF_56<-NA; BHRC_data$TRF_57<-NA; BHRC_data$TRF_58<-NA; BHRC_data$TRF_59<-NA; BHRC_data$TRF_60<-NA; BHRC_data$TRF_56A<-NA; BHRC_data$TRF_56B<-NA; BHRC_data$TRF_56C<-NA;BHRC_data$TRF_56D<-NA; BHRC_data$TRF_56E<-NA; BHRC_data$TRF_56F<-NA; BHRC_data$TRF_56G<-NA; BHRC_data$TRF_56H<-NA;  BHRC_data$TRF_61<-NA; BHRC_data$TRF_62<-NA; BHRC_data$TRF_63<-NA; BHRC_data$TRF_64<-NA; BHRC_data$TRF_65<-NA; BHRC_data$TRF_66<-NA; BHRC_data$TRF_67<-NA; BHRC_data$TRF_68<-NA; BHRC_data$TRF_69<-NA; BHRC_data$TRF_70<-NA; BHRC_data$TRF_71<-NA; BHRC_data$TRF_72<-NA; BHRC_data$TRF_73<-NA; BHRC_data$TRF_74<-NA; BHRC_data$TRF_75<-NA; BHRC_data$TRF_76<-NA; BHRC_data$TRF_77<-NA; BHRC_data$TRF_78<-NA; BHRC_data$TRF_79<-NA; BHRC_data$TRF_80<-NA; BHRC_data$TRF_81<-NA; BHRC_data$TRF_82<-NA; BHRC_data$TRF_83<-NA; BHRC_data$TRF_84<-NA; BHRC_data$TRF_85<-NA; BHRC_data$TRF_86<-NA; BHRC_data$TRF_87<-NA; BHRC_data$TRF_88<-NA; BHRC_data$TRF_89<-NA; BHRC_data$TRF_90<-NA; BHRC_data$TRF_91<-NA; BHRC_data$TRF_92<-NA; BHRC_data$TRF_93<-NA; BHRC_data$TRF_94<-NA; BHRC_data$TRF_95<-NA; BHRC_data$TRF_96<-NA; BHRC_data$TRF_97<-NA; BHRC_data$TRF_98<-NA; BHRC_data$TRF_99<-NA; BHRC_data$TRF_100<-NA; BHRC_data$TRF_101<-NA; BHRC_data$TRF_102<-NA; BHRC_data$TRF_103<-NA; BHRC_data$TRF_104<-NA; BHRC_data$TRF_105<-NA; BHRC_data$TRF_106<-NA; BHRC_data$TRF_107<-NA; BHRC_data$TRF_108<-NA; BHRC_data$TRF_109<-NA; BHRC_data$TRF_110<-NA; BHRC_data$TRF_111<-NA; BHRC_data$TRF_112<-NA; BHRC_data$TRF_113<-NA

BHRC_data$GOASSESS_SIP_010 <- NA ; BHRC_data$GOASSESS_SIP_007 <- NA ; BHRC_data$GOASSESS_SIP_012 <- NA ; BHRC_data$GOASSESS_SIP_008 <- NA ; BHRC_data$GOASSESS_SIP_013 <- NA ; BHRC_data$GOASSESS_SIP_011 <- NA ; BHRC_data$GOASSESS_SIP_005 <- NA ; BHRC_data$GOASSESS_SIP_006 <- NA ; BHRC_data$GOASSESS_SIP_004 <- NA ; BHRC_data$GOASSESS_SIP_003 <- NA ; BHRC_data$GOASSESS_SIP_009 <- NA ; BHRC_data$GOASSESS_SIP_014 <- NA ; BHRC_data$GOASSESS_PSY_001 <- NA ; BHRC_data$GOASSESS_PSY_060 <- NA ; BHRC_data$GOASSESS_PSY_029 <- NA ; BHRC_data$GOASSESS_SIP_027 <- NA ; BHRC_data$GOASSESS_PSY_070 <- NA ; BHRC_data$GOASSESS_SIP_028 <- NA ; BHRC_data$GOASSESS_PSY_071 <- NA ; BHRC_data$GOASSESS_PSY_050 <- NA ; BHRC_data$GOASSESS_ADD_012 <- NA ; BHRC_data$GOASSESS_ADD_011 <- NA ; BHRC_data$GOASSESS_ADD_016 <- NA ; BHRC_data$GOASSESS_ADD_021 <- NA ; BHRC_data$GOASSESS_ODD_002 <- NA ; BHRC_data$GOASSESS_ODD_003 <- NA ; BHRC_data$GOASSESS_ADD_022 <- NA ; BHRC_data$GOASSESS_ADD_013 <- NA ; BHRC_data$GOASSESS_ADD_014 <- NA ; BHRC_data$GOASSESS_ADD_020 <- NA ; BHRC_data$GOASSESS_ADD_015 <- NA ; BHRC_data$GOASSESS_ODD_001 <- NA ; BHRC_data$GOASSESS_CDD_005 <- NA ; BHRC_data$GOASSESS_ODD_005 <- NA ; BHRC_data$GOASSESS_ODD_006 <- NA ; BHRC_data$GOASSESS_CDD_001 <- NA ;  BHRC_data$GOASSESS_CDD_003 <- NA ; BHRC_data$GOASSESS_CDD_008 <- NA ; BHRC_data$GOASSESS_CDD_006 <- NA ; BHRC_data$GOASSESS_CDD_007 <- NA ; BHRC_data$GOASSESS_SCR_006 <- NA ; BHRC_data$GOASSESS_CDD_004 <- NA ; BHRC_data$GOASSESS_SIP_038 <- NA ; BHRC_data$GOASSESS_DEP_001 <- NA ; BHRC_data$GOASSESS_DEP_002 <- NA ; BHRC_data$GOASSESS_SUI_002 <- NA ; BHRC_data$GOASSESS_DEP_004 <- NA ; BHRC_data$GOASSESS_SIP_032 <- NA ;  BHRC_data$GOASSESS_MAN_007 <- NA ; BHRC_data$GOASSESS_DEP_006 <- NA ; BHRC_data$GOASSESS_OCD_001 <- NA ; BHRC_data$GOASSESS_PAN_004 <- NA ; BHRC_data$GOASSESS_PAN_001 <- NA ; BHRC_data$GOASSESS_SCR_007 <- NA ; BHRC_data$GOASSESS_GAD_002 <- NA ; BHRC_data$GOASSESS_OCD_007 <- NA ; BHRC_data$GOASSESS_SUI_001 <- NA ; BHRC_data$GOASSESS_OCD_005 <- NA ; BHRC_data$GOASSESS_PAN_003 <- NA ; BHRC_data$GOASSESS_MAN_005 <- NA ;  BHRC_data$GOASSESS_GAD_001 <- NA ; BHRC_data$GOASSESS_SIP_033 <- NA ; BHRC_data$GOASSESS_OCD_006 <- NA ; BHRC_data$GOASSESS_OCD_004 <- NA ; BHRC_data$GOASSESS_OCD_016 <- NA ; BHRC_data$GOASSESS_OCD_008 <- NA ; BHRC_data$GOASSESS_OCD_003 <- NA ; BHRC_data$GOASSESS_MAN_004 <- NA ; BHRC_data$GOASSESS_MAN_003 <- NA ; BHRC_data$GOASSESS_OCD_019 <- NA ; BHRC_data$GOASSESS_MAN_002 <- NA ; BHRC_data$GOASSESS_MAN_006 <- NA ;  BHRC_data$GOASSESS_CDD_002 <- NA ; BHRC_data$GOASSESS_MAN_001 <- NA ; BHRC_data$GOASSESS_SCR_001 <- NA ; BHRC_data$GOASSESS_OCD_002 <- NA ; BHRC_data$GOASSESS_OCD_012 <- NA ; BHRC_data$GOASSESS_SIP_039 <- NA ; BHRC_data$GOASSESS_OCD_018 <- NA ; BHRC_data$GOASSESS_PTD_009 <- NA ; BHRC_data$GOASSESS_SCR_008 <- NA ; BHRC_data$GOASSESS_AGR_006 <- NA ; BHRC_data$GOASSESS_SOC_004 <- NA ; BHRC_data$GOASSESS_AGR_005 <- NA ;  BHRC_data$GOASSESS_SOC_005 <- NA ; BHRC_data$GOASSESS_AGR_002 <- NA ; BHRC_data$GOASSESS_AGR_008 <- NA ; BHRC_data$GOASSESS_SOC_001 <- NA ; BHRC_data$GOASSESS_AGR_001 <- NA ; BHRC_data$GOASSESS_SOC_003 <- NA ; BHRC_data$GOASSESS_AGR_003 <- NA ; BHRC_data$GOASSESS_AGR_004 <- NA ; BHRC_data$GOASSESS_SOC_002 <- NA ; BHRC_data$GOASSESS_PHB_004 <- NA ; BHRC_data$GOASSESS_SEP_509 <- NA ; BHRC_data$GOASSESS_PHB_007 <- NA ;  BHRC_data$GOASSESS_AGR_007 <- NA ; BHRC_data$GOASSESS_PHB_006 <- NA ; BHRC_data$GOASSESS_PHB_001 <- NA ; BHRC_data$GOASSESS_OCD_013 <- NA ; BHRC_data$GOASSESS_PHB_002 <- NA ; BHRC_data$GOASSESS_SEP_508 <- NA ; BHRC_data$GOASSESS_PHB_008 <- NA ; BHRC_data$GOASSESS_OCD_011 <- NA ; BHRC_data$GOASSESS_PHB_005 <- NA ; BHRC_data$GOASSESS_OCD_017 <- NA ; BHRC_data$GOASSESS_SEP_500 <- NA ; BHRC_data$GOASSESS_OCD_015 <- NA ;  BHRC_data$GOASSESS_SEP_511 <- NA ; BHRC_data$GOASSESS_PHB_003 <- NA ; BHRC_data$GOASSESS_OCD_014 <- NA ; BHRC_data$GOASSESS_SEP_510 <- NA ; BHRC_data$GOASSESS_SUI_001_002 <- NA ; BHRC_data$GOASSESS_SUI_003 <- NA ; BHRC_data$GOASSESS_SUI_004 <- NA ; BHRC_data$GOASSESS_SUI_005 <- NA;
BHRC_data$GOASSESS_SUI_006 <- NA ; BHRC_data$GOASSESS_SUI_007 <- NA ; BHRC_data$GOASSESS_SUI_008 <- NA ; BHRC_data$GOASSESS_SUI_009 <- NA ; BHRC_data$SMRY_SUI <- NA

#library(table1); table1::table1(~factor(DIAG_DEP) | factor(DIAG_other), data = BHRC_data, overall=F)
BHRC_data<- BHRC_data %>% dplyr::select(EID,Study,Site, Selection,wave,Age,Age_group_3cat,Gender,Sampling_weight,Birth_weight,Birth_delivery,Birth_premature,Birth_preg_dur,Child_race,IQ,BMI,School_years,School_repet,School_exp,School_susp,Maternal_DIAG_ANY, YSR_1:YSR_112, CBCL_1:CBCL_113,YSR_1:TRF_113, GOASSESS_SIP_010:SMRY_SUI, pSDQ_1:pSDQ_18, pSDQ_19:pSDQ_22, pSDQ_23:pSDQ_25, pSDQ_26, pSDQ_26b:pSDQ_26f, DIAG_SEP_ANX, DIAG_SPEC_PHOB, DIAG_SOC_PHOB, DIAG_PANIC, DIAG_AGORAPHOB, DIAG_PTSD, DIAG_OCD, DIAG_GEN_ANX, DIAG_DMDD, DIAG_MANIA, DIAG_ADHD, DIAG_ODD, DIAG_PSYCH, DIAG_DEP, DIAG_CD, DIAG_EAT, DIAG_AUTISM, DIAG_TIC, DIAG_Other_ANX, DIAG_ANY, tSDQ_1:tSDQ_25, sSDQ_1:sSDQ_25)

```


# Renaming variables for merging data in PNC
```{r Renaming variables for merging data in PNC, message=F, warning=F}
# Load data sets
PNC_id <- import("bblid_renamed.csv") %>% dplyr::rename(id=bblid) %>% dplyr::rename(bblid=reid)
PNC_data <- import("pnc_data.csv")
PNC_cog <- import("PNC_cnb_factor_scores_tymoore_20151006.csv") %>% dplyr::select(bblid, F1_Exec_Comp_Cog_Accuracy_Ar) %>% dplyr::rename(Cog=F1_Exec_Comp_Cog_Accuracy_Ar) %>% dplyr::rename(id=bblid)
PNC_wrat <- import("PNC_cnb_wrat_scores_20161215.csv") %>% dplyr::select(bblid, wrat4CrStd) %>% dplyr::rename(WRAT=wrat4CrStd) %>% dplyr::rename(id=bblid)
PNC_cog_vars_zscores <- import("n1601_cnb_zscores_all_fr_20161215.csv")  %>% dplyr::select(bblid, abfAZ:wivSZv2) %>% dplyr::rename(id=bblid)
PNC_goassess <- import("n14513_goassess_screener_nontext_corrected_for_scala_20131021_redcap_pid272_fixed_20131101.csv") %>% dplyr::rename(id=PROBAND_BBLID) %>% dplyr::filter(INTERVIEW_TYPE!="MP")
# Preprocessing goassess data
# YPI = young proband informant (collateral of proband age 8-10); AP = adult proband; MI = middle informant; MP= middle proband (proband age 11-17)
colnames(PNC_goassess)<-str_replace(colnames(PNC_goassess), "GAD", "GOASSESS_GAD_")
colnames(PNC_goassess)<-str_replace(colnames(PNC_goassess), "SIP", "GOASSESS_SIP_")
colnames(PNC_goassess)<-str_replace(colnames(PNC_goassess), "PSY", "GOASSESS_PSY_")
colnames(PNC_goassess)<-str_replace(colnames(PNC_goassess), "ADD", "GOASSESS_ADD_")
colnames(PNC_goassess)<-str_replace(colnames(PNC_goassess), "ODD", "GOASSESS_ODD_")
colnames(PNC_goassess)<-str_replace(colnames(PNC_goassess), "CDD", "GOASSESS_CDD_")
colnames(PNC_goassess)<-str_replace(colnames(PNC_goassess), "DEP", "GOASSESS_DEP_")
colnames(PNC_goassess)<-str_replace(colnames(PNC_goassess), "SCR", "GOASSESS_SCR_")
colnames(PNC_goassess)<-str_replace(colnames(PNC_goassess), "PAN", "GOASSESS_PAN_")
colnames(PNC_goassess)<-str_replace(colnames(PNC_goassess), "OCD", "GOASSESS_OCD_")
colnames(PNC_goassess)<-str_replace(colnames(PNC_goassess), "MAN", "GOASSESS_MAN_")
colnames(PNC_goassess)<-str_replace(colnames(PNC_goassess), "PTD", "GOASSESS_PTD_")
colnames(PNC_goassess)<-str_replace(colnames(PNC_goassess), "SOC", "GOASSESS_SOC_")
colnames(PNC_goassess)<-str_replace(colnames(PNC_goassess), "AGR", "GOASSESS_AGR_")
colnames(PNC_goassess)<-str_replace(colnames(PNC_goassess), "PHB", "GOASSESS_PHB_")
colnames(PNC_goassess)<-str_replace(colnames(PNC_goassess), "SEP", "GOASSESS_SEP_")
colnames(PNC_goassess)<-str_replace(colnames(PNC_goassess), "SUI", "GOASSESS_SUI_")
PNC_goassess<-PNC_goassess %>% 
  mutate(GOASSESS_SUI_001_002 = 
           case_when(GOASSESS_SUI_001==1 | GOASSESS_SUI_002==1 ~ 1,
                     GOASSESS_SUI_001==1 & GOASSESS_SUI_002==9 ~ 1,
                     GOASSESS_SUI_001==9 & GOASSESS_SUI_002==1 ~ 1,
                     GOASSESS_SUI_001==0 & GOASSESS_SUI_002==1 ~ 1,
                     GOASSESS_SUI_001==1 & GOASSESS_SUI_002==0 ~ 1,
                     GOASSESS_SUI_001==0 & GOASSESS_SUI_002==0 ~ 0,
                     GOASSESS_SUI_001==9 & GOASSESS_SUI_002==9 ~ 9))
PNC_goassess <-  PNC_goassess %>% mutate_at(vars(starts_with("GOASSESS")),as.numeric) 

PNC_goassess <- PNC_goassess %>% dplyr::select(id, GOASSESS_SIP_010, GOASSESS_SIP_007, GOASSESS_SIP_012, GOASSESS_SIP_008, GOASSESS_SIP_013, GOASSESS_SIP_011, GOASSESS_SIP_005, GOASSESS_SIP_006, GOASSESS_SIP_004, GOASSESS_SIP_003, GOASSESS_SIP_009, GOASSESS_SIP_014, GOASSESS_PSY_001, GOASSESS_PSY_060, GOASSESS_PSY_029, GOASSESS_SIP_027, GOASSESS_PSY_070, GOASSESS_SIP_028, GOASSESS_PSY_071, GOASSESS_PSY_050, GOASSESS_ADD_012, GOASSESS_ADD_011, GOASSESS_ADD_016, GOASSESS_ADD_021, GOASSESS_ODD_002, GOASSESS_ODD_003, GOASSESS_ADD_022, GOASSESS_ADD_013, GOASSESS_ADD_014, GOASSESS_ADD_020, GOASSESS_ADD_015, GOASSESS_ODD_001, GOASSESS_CDD_005, GOASSESS_ODD_005, GOASSESS_ODD_006, GOASSESS_CDD_001, GOASSESS_CDD_003, GOASSESS_CDD_008, GOASSESS_CDD_006, GOASSESS_CDD_007, GOASSESS_SCR_006, GOASSESS_CDD_004, GOASSESS_SIP_038, GOASSESS_DEP_001, GOASSESS_DEP_002, GOASSESS_SUI_002, GOASSESS_DEP_004, GOASSESS_SIP_032, GOASSESS_MAN_007, GOASSESS_DEP_006, GOASSESS_OCD_001, GOASSESS_PAN_004, GOASSESS_PAN_001, GOASSESS_SCR_007, GOASSESS_GAD_002, GOASSESS_OCD_007, GOASSESS_SUI_001, GOASSESS_OCD_005, GOASSESS_PAN_003, GOASSESS_MAN_005, GOASSESS_GAD_001, GOASSESS_SIP_033, GOASSESS_OCD_006, GOASSESS_OCD_004, GOASSESS_OCD_016, GOASSESS_OCD_008, GOASSESS_OCD_003, GOASSESS_MAN_004, GOASSESS_MAN_003, GOASSESS_OCD_019, GOASSESS_MAN_002, GOASSESS_MAN_006, GOASSESS_CDD_002, GOASSESS_MAN_001, GOASSESS_SCR_001, GOASSESS_OCD_002, GOASSESS_OCD_012, GOASSESS_SIP_039, GOASSESS_OCD_018, GOASSESS_PTD_009, GOASSESS_SCR_008, GOASSESS_AGR_006, GOASSESS_SOC_004, GOASSESS_AGR_005, GOASSESS_SOC_005, GOASSESS_AGR_002, GOASSESS_AGR_008, GOASSESS_SOC_001, GOASSESS_AGR_001, GOASSESS_SOC_003, GOASSESS_AGR_003, GOASSESS_AGR_004, GOASSESS_SOC_002, GOASSESS_PHB_004, GOASSESS_SEP_509, GOASSESS_PHB_007, GOASSESS_AGR_007, GOASSESS_PHB_006, GOASSESS_PHB_001, GOASSESS_OCD_013, GOASSESS_PHB_002, GOASSESS_SEP_508, GOASSESS_PHB_008, GOASSESS_OCD_011, GOASSESS_PHB_005, GOASSESS_OCD_017, GOASSESS_SEP_500, GOASSESS_OCD_015, GOASSESS_SEP_511, GOASSESS_PHB_003, GOASSESS_OCD_014, GOASSESS_SEP_510, GOASSESS_SUI_001_002, GOASSESS_SUI_003, GOASSESS_SUI_004, GOASSESS_SUI_005, GOASSESS_SUI_006, GOASSESS_SUI_007, GOASSESS_SUI_008, GOASSESS_SUI_009) %>% naniar::replace_with_na_all(condition = ~.x == "9")
PNC_goassess <-  PNC_goassess %>% mutate_at(vars(starts_with("GOASSESS")),ordered) 

# Unify ids
PNC_cog <- PNC_cog %>% left_join(., PNC_id, by="id") %>% dplyr::select(-id)
PNC_wrat <- PNC_wrat %>% left_join(., PNC_id, by="id") %>% dplyr::select(-id)
PNC_cog_vars_zscores <- PNC_cog_vars_zscores %>% left_join(., PNC_id, by="id") %>% dplyr::select(-id)
PNC_goassess <- PNC_goassess %>% left_join(., PNC_id, by="id") %>% dplyr::select(-id)
# merge PNC data sets
PNC_data <- left_join(PNC_data, PNC_cog, by="bblid")
PNC_data <- left_join(PNC_data, PNC_wrat, by="bblid")
PNC_data <- left_join(PNC_data, PNC_cog_vars_zscores, by="bblid")
PNC_data <- left_join(PNC_data, PNC_goassess, by="bblid")
rm(PNC_cog, PNC_wrat, PNC_id, PNC_cog_vars_zscores, PNC_goassess)


table1::table1(~ as.factor(GOASSESS_SIP_010) + as.factor(GOASSESS_SIP_007) + as.factor(GOASSESS_SIP_012) + as.factor(GOASSESS_SIP_008) + as.factor(GOASSESS_SIP_013) + as.factor(GOASSESS_SIP_011) + as.factor(GOASSESS_SIP_005) + as.factor(GOASSESS_SIP_006) + as.factor(GOASSESS_SIP_004) + as.factor(GOASSESS_SIP_003) + as.factor(GOASSESS_SIP_009) + as.factor(GOASSESS_SIP_014) + as.factor(GOASSESS_PSY_001) + as.factor(GOASSESS_PSY_060) + as.factor(GOASSESS_PSY_029) + as.factor(GOASSESS_SIP_027) + as.factor(GOASSESS_PSY_070) + as.factor(GOASSESS_SIP_028) + as.factor(GOASSESS_PSY_071) + as.factor(GOASSESS_PSY_050) + as.factor(GOASSESS_ADD_012) + as.factor(GOASSESS_ADD_011) + as.factor(GOASSESS_ADD_016) + as.factor(GOASSESS_ADD_021) + as.factor(GOASSESS_ODD_002) + as.factor(GOASSESS_ODD_003) + as.factor(GOASSESS_ADD_022) + as.factor(GOASSESS_ADD_013) + as.factor(GOASSESS_ADD_014) + as.factor(GOASSESS_ADD_020) + as.factor(GOASSESS_ADD_015) + as.factor(GOASSESS_ODD_001) + as.factor(GOASSESS_CDD_005) + as.factor(GOASSESS_ODD_005) + as.factor(GOASSESS_ODD_006) + as.factor(GOASSESS_CDD_001) + as.factor(GOASSESS_CDD_003) + as.factor(GOASSESS_CDD_008) + as.factor(GOASSESS_CDD_006) + as.factor(GOASSESS_CDD_007) + as.factor(GOASSESS_SCR_006) + as.factor(GOASSESS_CDD_004) + as.factor(GOASSESS_SIP_038) + as.factor(GOASSESS_DEP_001) + as.factor(GOASSESS_DEP_002) + as.factor(GOASSESS_SUI_002) + as.factor(GOASSESS_DEP_004) + as.factor(GOASSESS_SIP_032) + as.factor(GOASSESS_MAN_007) + as.factor(GOASSESS_DEP_006) + as.factor(GOASSESS_OCD_001) + as.factor(GOASSESS_PAN_004) + as.factor(GOASSESS_PAN_001) + as.factor(GOASSESS_SCR_007) + as.factor(GOASSESS_GAD_002) + as.factor(GOASSESS_OCD_007) + as.factor(GOASSESS_SUI_001) + as.factor(GOASSESS_OCD_005) + as.factor(GOASSESS_PAN_003) + as.factor(GOASSESS_MAN_005) + as.factor(GOASSESS_GAD_001) + as.factor(GOASSESS_SIP_033) + as.factor(GOASSESS_OCD_006) + as.factor(GOASSESS_OCD_004) + as.factor(GOASSESS_OCD_016) + as.factor(GOASSESS_OCD_008) + as.factor(GOASSESS_OCD_003) + as.factor(GOASSESS_MAN_004) + as.factor(GOASSESS_MAN_003) + as.factor(GOASSESS_OCD_019) + as.factor(GOASSESS_MAN_002) + as.factor(GOASSESS_MAN_006) + as.factor(GOASSESS_CDD_002) + as.factor(GOASSESS_MAN_001) + as.factor(GOASSESS_SCR_001) + as.factor(GOASSESS_OCD_002) + as.factor(GOASSESS_OCD_012) + as.factor(GOASSESS_SIP_039) + as.factor(GOASSESS_OCD_018) + as.factor(GOASSESS_PTD_009) + as.factor(GOASSESS_SCR_008) + as.factor(GOASSESS_AGR_006) + as.factor(GOASSESS_SOC_004) + as.factor(GOASSESS_AGR_005) + as.factor(GOASSESS_SOC_005) + as.factor(GOASSESS_AGR_002) + as.factor(GOASSESS_AGR_008) + as.factor(GOASSESS_SOC_001) + as.factor(GOASSESS_AGR_001) + as.factor(GOASSESS_SOC_003) + as.factor(GOASSESS_AGR_003) + as.factor(GOASSESS_AGR_004) + as.factor(GOASSESS_SOC_002) + as.factor(GOASSESS_PHB_004) + as.factor(GOASSESS_SEP_509) + as.factor(GOASSESS_PHB_007) + as.factor(GOASSESS_AGR_007) + as.factor(GOASSESS_PHB_006) + as.factor(GOASSESS_PHB_001) + as.factor(GOASSESS_OCD_013) + as.factor(GOASSESS_PHB_002) + as.factor(GOASSESS_SEP_508) + as.factor(GOASSESS_PHB_008) + as.factor(GOASSESS_OCD_011) + as.factor(GOASSESS_PHB_005) + as.factor(GOASSESS_OCD_017) + as.factor(GOASSESS_SEP_500) + as.factor(GOASSESS_OCD_015) + as.factor(GOASSESS_SEP_511) + as.factor(GOASSESS_PHB_003) + as.factor(GOASSESS_OCD_014) + as.factor(GOASSESS_SEP_510) + as.factor(GOASSESS_SUI_001_002) , data = PNC_data, overall="Total sample")

# Processing PNC vars
PNC_data<-dplyr::rename(PNC_data,EID=bblid); PNC_data$EID<-as.character(PNC_data$EID)
PNC_data<-dplyr::rename(PNC_data,wave=timepoint); PNC_data$wave<-as.numeric(PNC_data$wave)
PNC_data$Study<-"PNC"
PNC_data$Selection <- "Community"
PNC_data$Site<-"PNC-1"
#PNC_data<-PNC_data %>% mutate(Gender = case_when(gender=="Female" ~ 1, gender=="Male"~ 2))
PNC_data<-PNC_data %>% mutate(Gender = case_when(sex=="1" ~ "Male", sex=="2"~ "Female"))
PNC_data$Gender <- as.factor(PNC_data$Gender)
PNC_data<-dplyr::rename(PNC_data,Age=ageAtClinicalAssess1);
PNC_data$Age <- PNC_data$Age/12
PNC_data<-PNC_data %>% mutate(Age_group_3cat = case_when(Age>=5 & Age<11 ~ "5_to_10", 
                                                      Age>=11& Age<15 ~ "11_to_14",
                                                      Age>=15 ~ "15_or_higher"))
PNC_data$Age_group_3cat <- ordered(PNC_data$Age_group_3cat, levels = c("5_to_10", "11_to_14", "15_or_higher")) 

PNC_data<-dplyr::rename(PNC_data,Child_race=race);
PNC_data <- PNC_data %>% mutate(Child_race=car::recode(Child_race,"1='White'; 2='Black'; 3='Native'; 5='Mixed'; 4='Asian'; 6='Native'"))

# Education
PNC_data<-dplyr::rename(PNC_data,School_years=edu1)

# IQ - Use Cog (F1_Exec_Comp_Cog_Accuracy_Ar) or WRAT standardized score - cor.test(PNC_data$Cog, PNC_data$WRAT)
fit_iq_resid <- glm(Cog ~ Age + Gender, data=PNC_data); summary(fit_iq_resid)
IQ_resid <- rstandard(fit_iq_resid)
IQ_data <- PNC_data %>% dplyr::select(EID, Cog, Age, Gender) %>% drop_na() %>% dplyr::select(EID)
IQ_data <- cbind(IQ_data, IQ_resid)
PNC_data <- PNC_data %>% left_join(IQ_data, by="EID")
PNC_data$IQ <- (PNC_data$IQ_resid*15)+100
PNC_data <- PNC_data %>% dplyr::select(-IQ_resid)
summary.factor(PNC_data$IQ)
rm(IQ_data, fit_iq_resid, IQ_resid)


# DIAGNOSIS
colnames(PNC_data)<-str_replace(colnames(PNC_data), "goassessSmryGad", "DIAG_GEN_ANX")
colnames(PNC_data)<-str_replace(colnames(PNC_data), "goassessSmryPsy", "DIAG_PSYCH")
colnames(PNC_data)<-str_replace(colnames(PNC_data), "goassessSmryAdd", "DIAG_ADHD")
colnames(PNC_data)<-str_replace(colnames(PNC_data), "goassessSmryOdd", "DIAG_ODD")
colnames(PNC_data)<-str_replace(colnames(PNC_data), "goassessSmryCon", "DIAG_CD")
colnames(PNC_data)<-str_replace(colnames(PNC_data), "goassessSmryDep", "DIAG_DEP")
colnames(PNC_data)<-str_replace(colnames(PNC_data), "goassessSmryPan", "DIAG_PANIC")
colnames(PNC_data)<-str_replace(colnames(PNC_data), "goassessSmryOcd", "DIAG_OCD")
colnames(PNC_data)<-str_replace(colnames(PNC_data), "goassessSmryMan", "DIAG_MANIA")
colnames(PNC_data)<-str_replace(colnames(PNC_data), "goassessSmryPtd", "DIAG_PTSD")
colnames(PNC_data)<-str_replace(colnames(PNC_data), "goassessSmrySoc", "DIAG_SOC_PHOB")
colnames(PNC_data)<-str_replace(colnames(PNC_data), "goassessSmryAgr", "DIAG_AGORAPHOB")
colnames(PNC_data)<-str_replace(colnames(PNC_data), "goassessSmryPhb", "DIAG_SPEC_PHOB")
colnames(PNC_data)<-str_replace(colnames(PNC_data), "goassessSmrySep", "DIAG_SEP_ANX")
colnames(PNC_data)<-str_replace(colnames(PNC_data), "goassessSmryEat", "DIAG_EAT")
colnames(PNC_data)<-str_replace(colnames(PNC_data), "goassessSmryMood", "DIAG_Mood")
PNC_data$DIAG_DMDD <- NA
PNC_data$DIAG_AUTISM <- NA
PNC_data$DIAG_TIC <- NA
PNC_data$DIAG_Other_ANX <- NA
PNC_data <- PNC_data %>% mutate_at(vars(starts_with("DIAG")),dplyr::funs(case_when(.=="0" ~ 0,.=="1" ~ 0,.=="2" ~ 0,.=="3" ~ 1,.=="4" ~ 1)))
PNC_data <-  PNC_data %>% mutate_at(vars(contains("DIAG")),ordered) 

PNC_data <- PNC_data %>% mutate(DIAG_ANY= 
                case_when(DIAG_Mood==0 & DIAG_SEP_ANX==0 & DIAG_SPEC_PHOB==0 & DIAG_SOC_PHOB==0 & 
                          DIAG_PANIC==0 & DIAG_AGORAPHOB==0 & DIAG_PTSD==0 & DIAG_OCD==0 & 
                          DIAG_GEN_ANX==0 & DIAG_MANIA==0 & DIAG_ADHD==0 & DIAG_ODD==0 & 
                          DIAG_PSYCH==0 & DIAG_DEP==0 & DIAG_CD==0 & DIAG_EAT==0 ~ 0,
                          DIAG_Mood==1 | DIAG_SEP_ANX==1 | DIAG_SPEC_PHOB==1 | DIAG_SOC_PHOB==1 | 
                          DIAG_PANIC==1 | DIAG_AGORAPHOB==1 | DIAG_PTSD==1 | DIAG_OCD==1 | 
                          DIAG_GEN_ANX==1 | DIAG_MANIA==1 | DIAG_ADHD==1 | DIAG_ODD==1 | 
                          DIAG_PSYCH==1 | DIAG_DEP==1 | DIAG_CD==1 | DIAG_EAT==1 ~ 1))

# GOASSESS
#colnames(PNC_data)<-str_replace(colnames(PNC_data), "gad", "GOASSESS_GAD_")
#colnames(PNC_data)<-str_replace(colnames(PNC_data), "sip", "GOASSESS_SIP_")
#colnames(PNC_data)<-str_replace(colnames(PNC_data), "psy", "GOASSESS_PSY_")
#colnames(PNC_data)<-str_replace(colnames(PNC_data), "add", "GOASSESS_ADD_")
#colnames(PNC_data)<-str_replace(colnames(PNC_data), "odd", "GOASSESS_ODD_")
#colnames(PNC_data)<-str_replace(colnames(PNC_data), "cdd", "GOASSESS_CDD_")
#colnames(PNC_data)<-str_replace(colnames(PNC_data), "dep", "GOASSESS_DEP_")
#colnames(PNC_data)<-str_replace(colnames(PNC_data), "scr", "GOASSESS_SCR_")
#colnames(PNC_data)<-str_replace(colnames(PNC_data), "pan", "GOASSESS_PAN_")
#colnames(PNC_data)<-str_replace(colnames(PNC_data), "ocd", "GOASSESS_OCD_")
#colnames(PNC_data)<-str_replace(colnames(PNC_data), "man", "GOASSESS_MAN_")
#colnames(PNC_data)<-str_replace(colnames(PNC_data), "ptd", "GOASSESS_PTD_")
#colnames(PNC_data)<-str_replace(colnames(PNC_data), "soc", "GOASSESS_SOC_")
#colnames(PNC_data)<-str_replace(colnames(PNC_data), "agr", "GOASSESS_AGR_")
#colnames(PNC_data)<-str_replace(colnames(PNC_data), "phb", "GOASSESS_PHB_")
#colnames(PNC_data)<-str_replace(colnames(PNC_data), "sep", "GOASSESS_SEP_")
#colnames(PNC_data)<-str_replace(colnames(PNC_data), "sui", "GOASSESS_SUI_")
#PNC_data <-  PNC_data %>% mutate_at(vars(starts_with("GOASSESS")),as.numeric) 
#PNC_data <-  PNC_data %>% mutate_at(vars(starts_with("GOASSESS")),ordered) 

# Insert vars to match other data sets
PNC_data$Sampling_weight <- NA
PNC_data$Maternal_DIAG_ANY <- NA
PNC_data$Birth_weight<- NA
PNC_data$Birth_delivery <-NA
PNC_data$Birth_premature<-NA
PNC_data$Birth_preg_dur<-NA
PNC_data$BMI<-NA
PNC_data$School_repet <- NA
PNC_data$School_exp <- NA
PNC_data$School_susp <- NA

PNC_data$pSDQ_26 <- NA
PNC_data$pSDQ_26b <- NA
PNC_data$pSDQ_26c <- NA
PNC_data$pSDQ_26d <- NA
PNC_data$pSDQ_26e <- NA
PNC_data$pSDQ_26f <- NA

PNC_data$YSR_1<-NA; PNC_data$YSR_2<-NA; PNC_data$YSR_3<-NA; PNC_data$YSR_4<-NA; PNC_data$YSR_5<-NA; PNC_data$YSR_6<-NA; PNC_data$YSR_7<-NA; PNC_data$YSR_8<-NA; PNC_data$YSR_9<-NA; PNC_data$YSR_10<-NA;
PNC_data$YSR_11<-NA; PNC_data$YSR_12<-NA; PNC_data$YSR_13<-NA; PNC_data$YSR_14<-NA; PNC_data$YSR_15<-NA; PNC_data$YSR_16<-NA; PNC_data$YSR_17<-NA; PNC_data$YSR_18<-NA; PNC_data$YSR_19<-NA; PNC_data$YSR_20<-NA;
PNC_data$YSR_21<-NA; PNC_data$YSR_22<-NA; PNC_data$YSR_23<-NA; PNC_data$YSR_24<-NA; PNC_data$YSR_25<-NA; PNC_data$YSR_26<-NA; PNC_data$YSR_27<-NA; PNC_data$YSR_28<-NA; PNC_data$YSR_29<-NA; PNC_data$YSR_30<-NA;
PNC_data$YSR_31<-NA; PNC_data$YSR_32<-NA; PNC_data$YSR_33<-NA; PNC_data$YSR_34<-NA; PNC_data$YSR_35<-NA; PNC_data$YSR_36<-NA; PNC_data$YSR_37<-NA; PNC_data$YSR_38<-NA; PNC_data$YSR_39<-NA; PNC_data$YSR_40<-NA;
PNC_data$YSR_41<-NA; PNC_data$YSR_42<-NA; PNC_data$YSR_43<-NA; PNC_data$YSR_44<-NA; PNC_data$YSR_45<-NA; PNC_data$YSR_46<-NA; PNC_data$YSR_47<-NA; PNC_data$YSR_48<-NA; PNC_data$YSR_49<-NA; PNC_data$YSR_50<-NA;
PNC_data$YSR_51<-NA; PNC_data$YSR_52<-NA; PNC_data$YSR_53<-NA; PNC_data$YSR_54<-NA; PNC_data$YSR_55<-NA; PNC_data$YSR_56<-NA; PNC_data$YSR_57<-NA; PNC_data$YSR_58<-NA; PNC_data$YSR_59<-NA; PNC_data$YSR_60<-NA;
PNC_data$YSR_56A<-NA; PNC_data$YSR_56B<-NA; PNC_data$YSR_56C<-NA;PNC_data$YSR_56D<-NA; PNC_data$YSR_56E<-NA;
PNC_data$YSR_56F<-NA; PNC_data$YSR_56G<-NA; PNC_data$YSR_56H<-NA; 
PNC_data$YSR_61<-NA; PNC_data$YSR_62<-NA; PNC_data$YSR_63<-NA; PNC_data$YSR_64<-NA; PNC_data$YSR_65<-NA; PNC_data$YSR_66<-NA; PNC_data$YSR_67<-NA; PNC_data$YSR_68<-NA; PNC_data$YSR_69<-NA; PNC_data$YSR_70<-NA;
PNC_data$YSR_71<-NA; PNC_data$YSR_72<-NA; PNC_data$YSR_73<-NA; PNC_data$YSR_74<-NA; PNC_data$YSR_75<-NA; PNC_data$YSR_76<-NA; PNC_data$YSR_77<-NA; PNC_data$YSR_78<-NA; PNC_data$YSR_79<-NA; PNC_data$YSR_80<-NA;
PNC_data$YSR_81<-NA; PNC_data$YSR_82<-NA; PNC_data$YSR_83<-NA; PNC_data$YSR_84<-NA; PNC_data$YSR_85<-NA; PNC_data$YSR_86<-NA; PNC_data$YSR_87<-NA; PNC_data$YSR_88<-NA; PNC_data$YSR_89<-NA; PNC_data$YSR_90<-NA;
PNC_data$YSR_91<-NA; PNC_data$YSR_92<-NA; PNC_data$YSR_93<-NA; PNC_data$YSR_94<-NA; PNC_data$YSR_95<-NA; PNC_data$YSR_96<-NA; PNC_data$YSR_97<-NA; PNC_data$YSR_98<-NA; PNC_data$YSR_99<-NA; PNC_data$YSR_100<-NA;
PNC_data$YSR_101<-NA; PNC_data$YSR_102<-NA; PNC_data$YSR_103<-NA; PNC_data$YSR_104<-NA; PNC_data$YSR_105<-NA; PNC_data$YSR_106<-NA; PNC_data$YSR_107<-NA; PNC_data$YSR_108<-NA; PNC_data$YSR_109<-NA; PNC_data$YSR_110<-NA; PNC_data$YSR_111<-NA; PNC_data$YSR_112<-NA

PNC_data$TRF_1<-NA; PNC_data$TRF_2<-NA; PNC_data$TRF_3<-NA; PNC_data$TRF_4<-NA; PNC_data$TRF_5<-NA; PNC_data$TRF_6<-NA; PNC_data$TRF_7<-NA; PNC_data$TRF_8<-NA; PNC_data$TRF_9<-NA; PNC_data$TRF_10<-NA;
PNC_data$TRF_11<-NA; PNC_data$TRF_12<-NA; PNC_data$TRF_13<-NA; PNC_data$TRF_14<-NA; PNC_data$TRF_15<-NA; PNC_data$TRF_16<-NA; PNC_data$TRF_17<-NA; PNC_data$TRF_18<-NA; PNC_data$TRF_19<-NA; PNC_data$TRF_20<-NA;
PNC_data$TRF_21<-NA; PNC_data$TRF_22<-NA; PNC_data$TRF_23<-NA; PNC_data$TRF_24<-NA; PNC_data$TRF_25<-NA; PNC_data$TRF_26<-NA; PNC_data$TRF_27<-NA; PNC_data$TRF_28<-NA; PNC_data$TRF_29<-NA; PNC_data$TRF_30<-NA;
PNC_data$TRF_31<-NA; PNC_data$TRF_32<-NA; PNC_data$TRF_33<-NA; PNC_data$TRF_34<-NA; PNC_data$TRF_35<-NA; PNC_data$TRF_36<-NA; PNC_data$TRF_37<-NA; PNC_data$TRF_38<-NA; PNC_data$TRF_39<-NA; PNC_data$TRF_40<-NA;
PNC_data$TRF_41<-NA; PNC_data$TRF_42<-NA; PNC_data$TRF_43<-NA; PNC_data$TRF_44<-NA; PNC_data$TRF_45<-NA; PNC_data$TRF_46<-NA; PNC_data$TRF_47<-NA; PNC_data$TRF_48<-NA; PNC_data$TRF_49<-NA; PNC_data$TRF_50<-NA;
PNC_data$TRF_51<-NA; PNC_data$TRF_52<-NA; PNC_data$TRF_53<-NA; PNC_data$TRF_54<-NA; PNC_data$TRF_55<-NA; PNC_data$TRF_56<-NA; PNC_data$TRF_57<-NA; PNC_data$TRF_58<-NA; PNC_data$TRF_59<-NA; PNC_data$TRF_60<-NA;
PNC_data$TRF_56A<-NA; PNC_data$TRF_56B<-NA; PNC_data$TRF_56C<-NA;PNC_data$TRF_56D<-NA; PNC_data$TRF_56E<-NA;
PNC_data$TRF_56F<-NA; PNC_data$TRF_56G<-NA; PNC_data$TRF_56H<-NA; 
PNC_data$TRF_61<-NA; PNC_data$TRF_62<-NA; PNC_data$TRF_63<-NA; PNC_data$TRF_64<-NA; PNC_data$TRF_65<-NA; PNC_data$TRF_66<-NA; PNC_data$TRF_67<-NA; PNC_data$TRF_68<-NA; PNC_data$TRF_69<-NA; PNC_data$TRF_70<-NA;
PNC_data$TRF_71<-NA; PNC_data$TRF_72<-NA; PNC_data$TRF_73<-NA; PNC_data$TRF_74<-NA; PNC_data$TRF_75<-NA; PNC_data$TRF_76<-NA; PNC_data$TRF_77<-NA; PNC_data$TRF_78<-NA; PNC_data$TRF_79<-NA; PNC_data$TRF_80<-NA;
PNC_data$TRF_81<-NA; PNC_data$TRF_82<-NA; PNC_data$TRF_83<-NA; PNC_data$TRF_84<-NA; PNC_data$TRF_85<-NA; PNC_data$TRF_86<-NA; PNC_data$TRF_87<-NA; PNC_data$TRF_88<-NA; PNC_data$TRF_89<-NA; PNC_data$TRF_90<-NA;
PNC_data$TRF_91<-NA; PNC_data$TRF_92<-NA; PNC_data$TRF_93<-NA; PNC_data$TRF_94<-NA; PNC_data$TRF_95<-NA; PNC_data$TRF_96<-NA; PNC_data$TRF_97<-NA; PNC_data$TRF_98<-NA; PNC_data$TRF_99<-NA; PNC_data$TRF_100<-NA;
PNC_data$TRF_101<-NA; PNC_data$TRF_102<-NA; PNC_data$TRF_103<-NA; PNC_data$TRF_104<-NA; PNC_data$TRF_105<-NA; PNC_data$TRF_106<-NA; PNC_data$TRF_107<-NA; PNC_data$TRF_108<-NA; PNC_data$TRF_109<-NA; PNC_data$TRF_110<-NA; PNC_data$TRF_111<-NA; PNC_data$TRF_112<-NA; PNC_data$TRF_113<-NA

PNC_data$CBCL_1<-NA; PNC_data$CBCL_2<-NA; PNC_data$CBCL_3<-NA; PNC_data$CBCL_4<-NA; PNC_data$CBCL_5<-NA; PNC_data$CBCL_6<-NA; PNC_data$CBCL_7<-NA; PNC_data$CBCL_8<-NA; PNC_data$CBCL_9<-NA; PNC_data$CBCL_10<-NA;
PNC_data$CBCL_11<-NA; PNC_data$CBCL_12<-NA; PNC_data$CBCL_13<-NA; PNC_data$CBCL_14<-NA; PNC_data$CBCL_15<-NA; PNC_data$CBCL_16<-NA; PNC_data$CBCL_17<-NA; PNC_data$CBCL_18<-NA; PNC_data$CBCL_19<-NA; PNC_data$CBCL_20<-NA;
PNC_data$CBCL_21<-NA; PNC_data$CBCL_22<-NA; PNC_data$CBCL_23<-NA; PNC_data$CBCL_24<-NA; PNC_data$CBCL_25<-NA; PNC_data$CBCL_26<-NA; PNC_data$CBCL_27<-NA; PNC_data$CBCL_28<-NA; PNC_data$CBCL_29<-NA; PNC_data$CBCL_30<-NA;
PNC_data$CBCL_31<-NA; PNC_data$CBCL_32<-NA; PNC_data$CBCL_33<-NA; PNC_data$CBCL_34<-NA; PNC_data$CBCL_35<-NA; PNC_data$CBCL_36<-NA; PNC_data$CBCL_37<-NA; PNC_data$CBCL_38<-NA; PNC_data$CBCL_39<-NA; PNC_data$CBCL_40<-NA;
PNC_data$CBCL_41<-NA; PNC_data$CBCL_42<-NA; PNC_data$CBCL_43<-NA; PNC_data$CBCL_44<-NA; PNC_data$CBCL_45<-NA; PNC_data$CBCL_46<-NA; PNC_data$CBCL_47<-NA; PNC_data$CBCL_48<-NA; PNC_data$CBCL_49<-NA; PNC_data$CBCL_50<-NA;
PNC_data$CBCL_51<-NA; PNC_data$CBCL_52<-NA; PNC_data$CBCL_53<-NA; PNC_data$CBCL_54<-NA; PNC_data$CBCL_55<-NA; PNC_data$CBCL_56<-NA; PNC_data$CBCL_57<-NA; PNC_data$CBCL_58<-NA; PNC_data$CBCL_59<-NA; PNC_data$CBCL_60<-NA;
PNC_data$CBCL_56A<-NA; PNC_data$CBCL_56B<-NA; PNC_data$CBCL_56C<-NA;PNC_data$CBCL_56D<-NA; PNC_data$CBCL_56E<-NA;
PNC_data$CBCL_56F<-NA; PNC_data$CBCL_56G<-NA; PNC_data$CBCL_56H<-NA; 
PNC_data$CBCL_61<-NA; PNC_data$CBCL_62<-NA; PNC_data$CBCL_63<-NA; PNC_data$CBCL_64<-NA; PNC_data$CBCL_65<-NA; PNC_data$CBCL_66<-NA; PNC_data$CBCL_67<-NA; PNC_data$CBCL_68<-NA; PNC_data$CBCL_69<-NA; PNC_data$CBCL_70<-NA;
PNC_data$CBCL_71<-NA; PNC_data$CBCL_72<-NA; PNC_data$CBCL_73<-NA; PNC_data$CBCL_74<-NA; PNC_data$CBCL_75<-NA; PNC_data$CBCL_76<-NA; PNC_data$CBCL_77<-NA; PNC_data$CBCL_78<-NA; PNC_data$CBCL_79<-NA; PNC_data$CBCL_80<-NA;
PNC_data$CBCL_81<-NA; PNC_data$CBCL_82<-NA; PNC_data$CBCL_83<-NA; PNC_data$CBCL_84<-NA; PNC_data$CBCL_85<-NA; PNC_data$CBCL_86<-NA; PNC_data$CBCL_87<-NA; PNC_data$CBCL_88<-NA; PNC_data$CBCL_89<-NA; PNC_data$CBCL_90<-NA;
PNC_data$CBCL_91<-NA; PNC_data$CBCL_92<-NA; PNC_data$CBCL_93<-NA; PNC_data$CBCL_94<-NA; PNC_data$CBCL_95<-NA; PNC_data$CBCL_96<-NA; PNC_data$CBCL_97<-NA; PNC_data$CBCL_98<-NA; PNC_data$CBCL_99<-NA; PNC_data$CBCL_100<-NA;
PNC_data$CBCL_101<-NA; PNC_data$CBCL_102<-NA; PNC_data$CBCL_103<-NA; PNC_data$CBCL_104<-NA; PNC_data$CBCL_105<-NA; PNC_data$CBCL_106<-NA; PNC_data$CBCL_107<-NA; PNC_data$CBCL_108<-NA; PNC_data$CBCL_109<-NA; PNC_data$CBCL_110<-NA; PNC_data$CBCL_111<-NA; PNC_data$CBCL_112<-NA; PNC_data$CBCL_113<-NA

PNC_data$pSDQ_3<-NA; PNC_data$pSDQ_8<-NA; PNC_data$pSDQ_13<-NA; PNC_data$pSDQ_16<-NA; PNC_data$pSDQ_24<-NA; PNC_data$pSDQ_5<-NA; PNC_data$pSDQ_7<-NA; PNC_data$pSDQ_12<-NA; PNC_data$pSDQ_18<-NA; PNC_data$pSDQ_22<-NA; PNC_data$pSDQ_2<-NA; PNC_data$pSDQ_10<-NA; PNC_data$pSDQ_15<-NA; PNC_data$pSDQ_21<-NA; PNC_data$pSDQ_25<-NA; PNC_data$pSDQ_6<-NA; PNC_data$pSDQ_11<-NA; PNC_data$pSDQ_14<-NA; PNC_data$pSDQ_19<-NA; PNC_data$pSDQ_23<-NA; PNC_data$pSDQ_1<-NA; PNC_data$pSDQ_4<-NA; PNC_data$pSDQ_9<-NA; PNC_data$pSDQ_17<-NA; PNC_data$pSDQ_20<-NA;

PNC_data$sSDQ_3<-NA; PNC_data$sSDQ_8<-NA; PNC_data$sSDQ_13<-NA; PNC_data$sSDQ_16<-NA; PNC_data$sSDQ_24<-NA; PNC_data$sSDQ_5<-NA; PNC_data$sSDQ_7<-NA; PNC_data$sSDQ_12<-NA; PNC_data$sSDQ_18<-NA; PNC_data$sSDQ_22<-NA; PNC_data$sSDQ_2<-NA; PNC_data$sSDQ_10<-NA; PNC_data$sSDQ_15<-NA; PNC_data$sSDQ_21<-NA; PNC_data$sSDQ_25<-NA; PNC_data$sSDQ_6<-NA; PNC_data$sSDQ_11<-NA; PNC_data$sSDQ_14<-NA; PNC_data$sSDQ_19<-NA; PNC_data$sSDQ_23<-NA; PNC_data$sSDQ_1<-NA; PNC_data$sSDQ_4<-NA; PNC_data$sSDQ_9<-NA; PNC_data$sSDQ_17<-NA; PNC_data$sSDQ_20<-NA;

PNC_data$tSDQ_3<-NA; PNC_data$tSDQ_8<-NA; PNC_data$tSDQ_13<-NA; PNC_data$tSDQ_16<-NA; PNC_data$tSDQ_24<-NA; PNC_data$tSDQ_5<-NA; PNC_data$tSDQ_7<-NA; PNC_data$tSDQ_12<-NA; PNC_data$tSDQ_18<-NA; PNC_data$tSDQ_22<-NA; PNC_data$tSDQ_2<-NA; PNC_data$tSDQ_10<-NA; PNC_data$tSDQ_15<-NA; PNC_data$tSDQ_21<-NA; PNC_data$tSDQ_25<-NA; PNC_data$tSDQ_6<-NA; PNC_data$tSDQ_11<-NA; PNC_data$tSDQ_14<-NA; PNC_data$tSDQ_19<-NA; PNC_data$tSDQ_23<-NA; PNC_data$tSDQ_1<-NA; PNC_data$tSDQ_4<-NA; PNC_data$tSDQ_9<-NA; PNC_data$tSDQ_17<-NA; PNC_data$tSDQ_20<-NA;

PNC_data<- PNC_data %>% dplyr::select(EID,Study,Site, Selection,wave,Age,Age_group_3cat,Gender,Sampling_weight,Birth_weight,Birth_delivery,Birth_premature,Birth_preg_dur,Child_race,IQ,BMI,School_years,School_repet,School_exp,School_susp,Maternal_DIAG_ANY, YSR_1:YSR_112, CBCL_1:CBCL_113,YSR_1:TRF_113, pSDQ_3:tSDQ_20, pSDQ_26, pSDQ_26b:pSDQ_26f, GOASSESS_SIP_010:GOASSESS_SUI_009, SMRY_SUI, DIAG_SEP_ANX, DIAG_SPEC_PHOB, DIAG_SOC_PHOB, DIAG_PANIC, DIAG_AGORAPHOB, DIAG_PTSD, DIAG_OCD, DIAG_GEN_ANX, DIAG_DMDD, DIAG_MANIA, DIAG_ADHD, DIAG_ODD, DIAG_PSYCH, DIAG_DEP, DIAG_CD, DIAG_EAT, DIAG_AUTISM, DIAG_TIC, DIAG_Other_ANX, DIAG_ANY, tSDQ_1:tSDQ_25, sSDQ_1:sSDQ_25)
```

# Renaming variables for merging data in NKI
```{r Renaming variables for merging data in NKI, message=F, warning=F}
NKI_data <- import("RocklandSample_04JAN2021.csv")
NKI_data2 <- import("RocklandSample_01SET2021_cog.csv")

NKI_data_match_fu <- import("participants_sessions_mapping.csv") %>% dplyr::filter(association!="") %>% dplyr::filter(session!="TRT")  %>% dplyr::select(id, session, session_type, association, studies)

# Demos
NKI_data$EID<-str_sub(NKI_data$Identifiers, start = 1, end = 9)
NKI_data$wave<-str_sub(NKI_data$Identifiers, start = 11, end = 14)
NKI_data <- NKI_data %>% mutate(wave=car::recode(wave,"'BAS1'=1; 'BAS2'=1; 'BAS3'=1; 'FLU1'=2; 'FLU2'=3; 'FLU3'=3"))
NKI_data$wave <- as.numeric(NKI_data$wave)
NKI_data <- arrange(NKI_data, EID, wave)
NKI_data <- NKI_data %>% dplyr::select(-wiat_08)

NKI_data2$EID<-str_sub(NKI_data2$Identifiers, start = 1, end = 9)
NKI_data2$wave<-str_sub(NKI_data2$Identifiers, start = 11, end = 14)
#NKI_data2$Identifiers <- str_replace(NKI_data2$Identifiers, "BAS2", "BAS1")
NKI_data2 <- NKI_data2 %>% mutate(wave=car::recode(wave,"'BAS1'=1; 'BAS2'=1; 'BAS3'=1; 'FLU1'=2; 'FLU2'=3; 'FLU3'=3"))
NKI_data2$wave <- as.numeric(NKI_data2$wave)
NKI_data2 <- arrange(NKI_data2, EID, wave)
NKI_data2 <- NKI_data2 %>% dplyr::select(-Identifiers)
#n_occur <- data.frame(table(NKI_data2$Identifiers))
#n_occur[n_occur$Freq > 1,]
#NKI_data2[NKI_data2$Identifiers %in% n_occur$Var1[n_occur$Freq > 1],]
#NKI_data2 <- NKI_data2 %>% slice(-2)
#rm(n_occur)
NKI_data <- left_join(NKI_data, NKI_data2, by=c("EID", "wave")); names(NKI_data); rm(NKI_data2)
NKI_data <- NKI_data %>% dplyr::filter(nkicbcl_001!="") %>% dplyr::filter(nkicbcl_001!=".") %>% relocate(c(EID, wave))

NKI_data$Identifiers_check <- str_replace(NKI_data$Identifiers, ",BAS1", ",1")
NKI_data$Identifiers_check <- str_replace(NKI_data$Identifiers_check, ",BAS2", ",1")
NKI_data$Identifiers_check <- str_replace(NKI_data$Identifiers_check, ",BAS3", ",1")
NKI_data$Identifiers_check <- str_replace(NKI_data$Identifiers_check, ",FLU1", ",2")
NKI_data$Identifiers_check <- str_replace(NKI_data$Identifiers_check, ",FLU2", ",3")
NKI_data$Identifiers_check <- str_replace(NKI_data$Identifiers_check, ",FLU3", ",3")
n_occur <- data.frame(table(NKI_data$Identifiers_check))
n_occur[n_occur$Freq > 1,] #A00031219 - double data, same assessment BAS1
NKI_data <- NKI_data %>% slice(-12)
rm(n_occur, NKI_data_match_fu, NKI_data_waves)

NKI_data$Study<-"NKI"
NKI_data$Site<-"NKI-1"
NKI_data$Selection <- "Community"
NKI_data$Age <- as.numeric(NKI_data$nkicbcl_128)
NKI_data <- NKI_data %>% filter(Age!="NA") # filter to complete youth data
NKI_data<-NKI_data %>% mutate(Age_group_3cat = case_when(Age>=5 & Age<11 ~ "5_to_10", 
                                                      Age>=11& Age<15 ~ "11_to_14",
                                                      Age>=15 ~ "15_or_higher"))
NKI_data$Age_group_3cat <- ordered(NKI_data$Age_group_3cat, levels = c("5_to_10", "11_to_14", "15_or_higher")) 

NKI_data<-dplyr::rename(NKI_data,Gender=nkicbcl_127)
NKI_data<-NKI_data %>% mutate(Gender = case_when(Gender=="1" ~ "Male", Gender=="2"~ "Female"))
NKI_data$Gender <- as.factor(NKI_data$Gender)

NKI_data<-dplyr::rename(NKI_data,Child_race=dem_004)
NKI_data$Child_race <- as.numeric(NKI_data$Child_race)
summary.factor(NKI_data$Child_race)
NKI_data <- NKI_data %>% mutate(Child_race=car::recode(Child_race,"5='White';3='Black'; 2='Asian'; 1='Native'; 4='Native'; 6='Other'"))
#1= American Indian or Native Alaskan
#2= Asian
#3= Black  or African American
#4= Native Hawiian or Other Pacific Islander
#5= White
#6= Other Race

# IQ
NKI_data<-dplyr::rename(NKI_data,WASI=int_14)
NKI_data$WASI <- as.numeric(NKI_data$WASI)
fit_iq_resid <- glm(WASI ~ Age + Gender, data=NKI_data); summary(fit_iq_resid)
IQ_resid <- rstandard(fit_iq_resid)
IQ_data <- NKI_data %>% dplyr::select(EID, WASI, Gender, Age) %>% drop_na() %>% dplyr::select(EID)
IQ_data <- cbind(IQ_data, IQ_resid)
NKI_data <- NKI_data %>% left_join(IQ_data, by="EID")
NKI_data$IQ <- (NKI_data$IQ_resid*15)+100
rm(IQ_data, fit_iq_resid, IQ_resid)
NKI_data <- NKI_data %>% dplyr::select(-IQ_resid)
# Education
NKI_data$School_years <- as.numeric(NKI_data$sesc_10) 

# Diagnosis
NKI_data<-dplyr::rename(NKI_data,DX_01=`diag_01#desc`)
NKI_data<-dplyr::rename(NKI_data,DX_02=`diag_02#desc`)
NKI_data<-dplyr::rename(NKI_data,DX_03=`diag_03#desc`)
NKI_data<-dplyr::rename(NKI_data,DX_04=`diag_04#desc`)
NKI_data<-dplyr::rename(NKI_data,DX_05=`diag_05#desc`)
NKI_data<-dplyr::rename(NKI_data,DX_06=`diag_06#desc`)
NKI_data<-dplyr::rename(NKI_data,DX_07=`diag_07#desc`)
NKI_data<-dplyr::rename(NKI_data,DX_08=`diag_08#desc`)
NKI_data<-dplyr::rename(NKI_data,DX_09=`diag_09#desc`)
## Diagnosis Any
NKI_data <- NKI_data %>%  mutate(DIAG_ANY=
            case_when(DX_01=="."|DX_01=="" ~ NA_real_,
                      DX_01=="No Diagnosis or Condition on Axis I" ~ 0,
                      DX_01!="No Diagnosis or Condition on Axis I" ~ 1))
## Diagnosis specifics
NKI_data <- NKI_data %>%  mutate(DIAG_SEP_ANX=
            case_when(DX_01=="Separation Anxiety Disorder"|DX_02=="Separation Anxiety Disorder"|
                       DX_03=="Separation Anxiety Disorder"|DX_04=="Separation Anxiety Disorder"|
                       DX_05=="Separation Anxiety Disorder"|DX_06=="Separation Anxiety Disorder"|
                       DX_07=="Separation Anxiety Disorder"|DX_08=="Separation Anxiety Disorder"|
                       DX_09=="Separation Anxiety Disorder" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 & (DX_01!="Separation Anxiety Disorder"&DX_02!="Separation Anxiety Disorder"&
                                     DX_03!="Separation Anxiety Disorder"&DX_04!="Separation Anxiety Disorder"&
                                     DX_05!="Separation Anxiety Disorder"&DX_06!="Separation Anxiety Disorder"&
                                     DX_07!="Separation Anxiety Disorder"&DX_08!="Separation Anxiety Disorder"&
                                     DX_09!="Separation Anxiety Disorder") ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

NKI_data <- NKI_data %>%  mutate(DIAG_SPEC_PHOB=
            case_when(DX_01=="Specific Phobia"|DX_02=="Specific Phobia"|DX_03=="Specific Phobia"|
                       DX_04=="Specific Phobia"|DX_05=="Specific Phobia"|DX_06=="Specific Phobia"|
                       DX_07=="Specific Phobia"|DX_08=="Specific Phobia"|DX_09=="Specific Phobia" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 & (DX_01!="Specific Phobia"&DX_02!="Specific Phobia"&
                                      DX_03!="Specific Phobia"&DX_04!="Specific Phobia"&
                                      DX_05!="Specific Phobia"&DX_06!="Specific Phobia"&
                                      DX_07!="Specific Phobia"&DX_08!="Specific Phobia"&
                                      DX_09!="Specific Phobia") ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

NKI_data <- NKI_data %>%  mutate(DIAG_SOC_PHOB=
            case_when(DX_01=="Social Phobia"|DX_02=="Social Phobia"|
                       DX_03=="Social Phobia"|DX_04=="Social Phobia"|
                       DX_05=="Social Phobia"|DX_06=="Social Phobia"|
                       DX_07=="Social Phobia"|DX_08=="Social Phobia"|
                       DX_09=="Social Phobia" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 & (DX_01!="Social Phobia"&
                                     DX_02!="Social Phobia"&
                                     DX_03!="Social Phobia"&
                                     DX_04!="Social Phobia"&
                                     DX_05!="Social Phobia"&
                                     DX_06!="Social Phobia"&
                                     DX_07!="Social Phobia"&
                                     DX_08!="Social Phobia"&
                                     DX_09!="Social Phobia") ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

NKI_data <- NKI_data %>%  mutate(DIAG_PANIC=
            case_when(DX_01=="Panic Disorder Without Agoraphobia"|
                        DX_02=="Panic Disorder Without Agoraphobia"|
                        DX_03=="Panic Disorder Without Agoraphobia"|
                       DX_04=="Panic Disorder Without Agoraphobia"|
                        DX_05=="Panic Disorder Without Agoraphobia"|
                        DX_06=="Panic Disorder Without Agoraphobia"|
                       DX_07=="Panic Disorder Without Agoraphobia"|
                        DX_08=="Panic Disorder Without Agoraphobia"|
                        DX_09=="Panic Disorder Without Agoraphobia" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 & (DX_01!="Panic Disorder Without Agoraphobia"&
                                       DX_02!="Panic Disorder Without Agoraphobia"&
                                     DX_03!="Panic Disorder Without Agoraphobia"&
                                       DX_04!="Panic Disorder Without Agoraphobia"&
                                     DX_05!="Panic Disorder Without Agoraphobia"&
                                       DX_06!="Panic Disorder Without Agoraphobia"&
                                     DX_07!="Panic Disorder Without Agoraphobia"&
                                       DX_08!="Panic Disorder Without Agoraphobia"&
                                     DX_09!="Panic Disorder Without Agoraphobia") ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

NKI_data <- NKI_data %>%  mutate(DIAG_AGORAPHOB=
            case_when(DX_01=="Panic Disorder With Agoraphobia"|
                        DX_02=="Panic Disorder With Agoraphobia"|
                        DX_03=="Panic Disorder With Agoraphobia"|
                       DX_04=="Panic Disorder With Agoraphobia"|
                        DX_05=="Panic Disorder With Agoraphobia"|
                        DX_06=="Panic Disorder With Agoraphobia"|
                       DX_07=="Panic Disorder With Agoraphobia"|
                        DX_08=="Panic Disorder With Agoraphobia"|
                        DX_09=="Panic Disorder With Agoraphobia" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 & (DX_01!="Panic Disorder With Agoraphobia"&
                                       DX_02!="Panic Disorder With Agoraphobia"&
                                     DX_03!="Panic Disorder With Agoraphobia"&
                                       DX_04!="Panic Disorder With Agoraphobia"&
                                     DX_05!="Panic Disorder With Agoraphobia"&
                                       DX_06!="Panic Disorder With Agoraphobia"&
                                     DX_07!="Panic Disorder With Agoraphobia"&
                                       DX_08!="Panic Disorder With Agoraphobia"&
                                     DX_09!="Panic Disorder With Agoraphobia") ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

NKI_data <- NKI_data %>%  mutate(DIAG_GEN_ANX=
            case_when(DX_01=="Generalized Anxiety Disorder"|DX_02=="Generalized Anxiety Disorder"|
                       DX_03=="Generalized Anxiety Disorder"|DX_04=="Generalized Anxiety Disorder"|
                       DX_05=="Generalized Anxiety Disorder"|DX_06=="Generalized Anxiety Disorder"|
                       DX_07=="Generalized Anxiety Disorder"|DX_08=="Generalized Anxiety Disorder"|
                       DX_09=="Generalized Anxiety Disorder" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 & (DX_01!="Generalized Anxiety Disorder"&
                                     DX_02!="Generalized Anxiety Disorder"&
                                     DX_03!="Generalized Anxiety Disorder"&
                                     DX_04!="Generalized Anxiety Disorder"&
                                     DX_05!="Generalized Anxiety Disorder"&
                                     DX_06!="Generalized Anxiety Disorder"&
                                     DX_07!="Generalized Anxiety Disorder"&
                                     DX_08!="Generalized Anxiety Disorder"&
                                     DX_09!="Generalized Anxiety Disorder") ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

NKI_data <- NKI_data %>%  mutate(DIAG_PTSD=
            case_when(DX_01=="Posttraumatic Stress Disorder"|
                       DX_02=="Posttraumatic Stress Disorder"|
                       DX_03=="Posttraumatic Stress Disorder"|
                       DX_04=="Posttraumatic Stress Disorder"|
                       DX_05=="Posttraumatic Stress Disorder"|
                       DX_06=="Posttraumatic Stress Disorder"|
                       DX_07=="Posttraumatic Stress Disorder"|
                       DX_08=="Posttraumatic Stress Disorder"|
                       DX_09=="Posttraumatic Stress Disorder" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 & (DX_01!="Posttraumatic Stress Disorder"&
                                     DX_02!="Posttraumatic Stress Disorder"&
                                     DX_03!="Posttraumatic Stress Disorder"&
                                     DX_04!="Posttraumatic Stress Disorder"&
                                     DX_05!="Posttraumatic Stress Disorder"&
                                     DX_06!="Posttraumatic Stress Disorder"&
                                     DX_07!="Posttraumatic Stress Disorder"&
                                     DX_08!="Posttraumatic Stress Disorder"&
                                     DX_09!="Posttraumatic Stress Disorder") ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

NKI_data <- NKI_data %>%  mutate(DIAG_OCD=
            case_when(DX_01=="Obsessive-Compulsive Disorder"|
                       DX_02=="Obsessive-Compulsive Disorder"|
                       DX_03=="Obsessive-Compulsive Disorder"|
                       DX_04=="Obsessive-Compulsive Disorder"|
                       DX_05=="Obsessive-Compulsive Disorder"|
                       DX_06=="Obsessive-Compulsive Disorder"|
                       DX_07=="Obsessive-Compulsive Disorder"|
                       DX_08=="Obsessive-Compulsive Disorder"|
                       DX_09=="Obsessive-Compulsive Disorder" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 & (DX_01!="Obsessive-Compulsive Disorder"&
                                     DX_02!="Obsessive-Compulsive Disorder"&
                                     DX_03!="Obsessive-Compulsive Disorder"&
                                     DX_04!="Obsessive-Compulsive Disorder"&
                                     DX_05!="Obsessive-Compulsive Disorder"&
                                     DX_06!="Obsessive-Compulsive Disorder"&
                                     DX_07!="Obsessive-Compulsive Disorder"&
                                     DX_08!="Obsessive-Compulsive Disorder"&
                                     DX_09!="Obsessive-Compulsive Disorder") ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

NKI_data <- NKI_data %>%  mutate(DIAG_DMDD=
            case_when(DX_01=="Disruptive Behavior Disorder NOS"|
                       DX_02=="Disruptive Behavior Disorder NOS"|
                       DX_03=="Disruptive Behavior Disorder NOS"|
                       DX_04=="Disruptive Behavior Disorder NOS"|
                       DX_05=="Disruptive Behavior Disorder NOS"|
                       DX_06=="Disruptive Behavior Disorder NOS"|
                       DX_07=="Disruptive Behavior Disorder NOS"|
                       DX_08=="Disruptive Behavior Disorder NOS"|
                       DX_09=="Disruptive Behavior Disorder NOS" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 & (DX_01!="Disruptive Behavior Disorder NOS"&
                                     DX_02!="Disruptive Behavior Disorder NOS"&
                                     DX_03!="Disruptive Behavior Disorder NOS"&
                                     DX_04!="Disruptive Behavior Disorder NOS"&
                                     DX_05!="Disruptive Behavior Disorder NOS"&
                                     DX_06!="Disruptive Behavior Disorder NOS"&
                                     DX_07!="Disruptive Behavior Disorder NOS"&
                                     DX_08!="Disruptive Behavior Disorder NOS"&
                                     DX_09!="Disruptive Behavior Disorder NOS") ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

NKI_data <- NKI_data %>%  mutate(DIAG_ODD=
            case_when(DX_01=="Oppositional Defiant Disorder"|DX_02=="Oppositional Defiant Disorder"|
                       DX_03=="Oppositional Defiant Disorder"|DX_04=="Oppositional Defiant Disorder"|
                       DX_05=="Oppositional Defiant Disorder"|DX_06=="Oppositional Defiant Disorder"|
                       DX_07=="Oppositional Defiant Disorder"|DX_08=="Oppositional Defiant Disorder"|
                       DX_09=="Oppositional Defiant Disorder" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 & (DX_01!="Oppositional Defiant Disorder"&
                                     DX_02!="Oppositional Defiant Disorder"&
                                     DX_03!="Oppositional Defiant Disorder"&
                                     DX_04!="Oppositional Defiant Disorder"&
                                     DX_05!="Oppositional Defiant Disorder"&
                                     DX_06!="Oppositional Defiant Disorder"&
                                     DX_07!="Oppositional Defiant Disorder"&
                                     DX_08!="Oppositional Defiant Disorder"&
                                     DX_09!="Oppositional Defiant Disorder") ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

NKI_data$DIAG_MANIA <- NA

NKI_data <- NKI_data %>%  mutate(DIAG_ADHD=
            case_when(DX_01=="Attention-Deficit/Hyperactivity Disorder NOS"|
                        DX_02=="Attention-Deficit/Hyperactivity Disorder NOS"|
                        DX_03=="Attention-Deficit/Hyperactivity Disorder NOS"|
                        DX_04=="Attention-Deficit/Hyperactivity Disorder NOS"|
                        DX_05=="Attention-Deficit/Hyperactivity Disorder NOS"|
                        DX_06=="Attention-Deficit/Hyperactivity Disorder NOS"|
                        DX_07=="Attention-Deficit/Hyperactivity Disorder NOS"|
                        DX_08=="Attention-Deficit/Hyperactivity Disorder NOS"|
                        DX_09=="Attention-Deficit/Hyperactivity Disorder NOS" ~ 1,
                      DX_01=="Attention-Deficit/Hyperactivity Disorder, Combined Type"|
                        DX_02=="Attention-Deficit/Hyperactivity Disorder, Combined Type"|
                        DX_03=="Attention-Deficit/Hyperactivity Disorder, Combined Type"|
                        DX_04=="Attention-Deficit/Hyperactivity Disorder, Combined Type"|
                        DX_05=="Attention-Deficit/Hyperactivity Disorder, Combined Type"|
                        DX_06=="Attention-Deficit/Hyperactivity Disorder, Combined Type"|
                        DX_07=="Attention-Deficit/Hyperactivity Disorder, Combined Type"|
                        DX_08=="Attention-Deficit/Hyperactivity Disorder, Combined Type"|
                        DX_09=="Attention-Deficit/Hyperactivity Disorder, Combined Type" ~ 1,
                      DX_01=="Attention-Deficit/Hyperactivity Disorder, Predominantly Hyperactive-Impulsive Type"|
                        DX_02=="Attention-Deficit/Hyperactivity Disorder, Predominantly Hyperactive-Impulsive Type"|
                        DX_03=="Attention-Deficit/Hyperactivity Disorder, Predominantly Hyperactive-Impulsive Type"|
                        DX_04=="Attention-Deficit/Hyperactivity Disorder, Predominantly Hyperactive-Impulsive Type"|
                        DX_05=="Attention-Deficit/Hyperactivity Disorder, Predominantly Hyperactive-Impulsive Type"|
                        DX_06=="Attention-Deficit/Hyperactivity Disorder, Predominantly Hyperactive-Impulsive Type"|
                        DX_07=="Attention-Deficit/Hyperactivity Disorder, Predominantly Hyperactive-Impulsive Type"|
                        DX_08=="Attention-Deficit/Hyperactivity Disorder, Predominantly Hyperactive-Impulsive Type"|
                        DX_09=="Attention-Deficit/Hyperactivity Disorder, Predominantly Hyperactive-Impulsive Type" ~ 1,
                      DX_01=="Attention-Deficit/Hyperactivity Disorder, Predominantly Inattentive Type"|
                        DX_02=="Attention-Deficit/Hyperactivity Disorder, Predominantly Inattentive Type"|
                        DX_03=="Attention-Deficit/Hyperactivity Disorder, Predominantly Inattentive Type"|
                        DX_04=="Attention-Deficit/Hyperactivity Disorder, Predominantly Inattentive Type"|
                        DX_05=="Attention-Deficit/Hyperactivity Disorder, Predominantly Inattentive Type"|
                        DX_06=="Attention-Deficit/Hyperactivity Disorder, Predominantly Inattentive Type"|
                        DX_07=="Attention-Deficit/Hyperactivity Disorder, Predominantly Inattentive Type"|
                        DX_08=="Attention-Deficit/Hyperactivity Disorder, Predominantly Inattentive Type"|
                        DX_09=="Attention-Deficit/Hyperactivity Disorder, Predominantly Inattentive Type" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 &
                      ((DX_01!="Attention-Deficit/Hyperactivity Disorder NOS"&
                          DX_02!="Attention-Deficit/Hyperactivity Disorder NOS"&
                          DX_03!="Attention-Deficit/Hyperactivity Disorder NOS"&
                          DX_04!="Attention-Deficit/Hyperactivity Disorder NOS"&
                          DX_05!="Attention-Deficit/Hyperactivity Disorder NOS"&
                          DX_06!="Attention-Deficit/Hyperactivity Disorder NOS"&
                          DX_07!="Attention-Deficit/Hyperactivity Disorder NOS"&
                          DX_08!="Attention-Deficit/Hyperactivity Disorder NOS"&
                          DX_09!="Attention-Deficit/Hyperactivity Disorder NOS") &
                       (DX_01!="Attention-Deficit/Hyperactivity Disorder, Combined Type"&
                          DX_02!="Attention-Deficit/Hyperactivity Disorder, Combined Type"&
                          DX_03!="Attention-Deficit/Hyperactivity Disorder, Combined Type"&
                          DX_04!="Attention-Deficit/Hyperactivity Disorder, Combined Type"&
                          DX_05!="Attention-Deficit/Hyperactivity Disorder, Combined Type"&
                          DX_06!="Attention-Deficit/Hyperactivity Disorder, Combined Type"&
                          DX_07!="Attention-Deficit/Hyperactivity Disorder, Combined Type"&
                          DX_08!="Attention-Deficit/Hyperactivity Disorder, Combined Type"&
                          DX_09!="Attention-Deficit/Hyperactivity Disorder, Combined Type") &
                         (DX_01!="Attention-Deficit/Hyperactivity Disorder, Predominantly Hyperactive-Impulsive Type"&
                          DX_02!="Attention-Deficit/Hyperactivity Disorder, Predominantly Hyperactive-Impulsive Type"&
                          DX_03!="Attention-Deficit/Hyperactivity Disorder, Predominantly Hyperactive-Impulsive Type"&
                          DX_04!="Attention-Deficit/Hyperactivity Disorder, Predominantly Hyperactive-Impulsive Type"&
                          DX_05!="Attention-Deficit/Hyperactivity Disorder, Predominantly Hyperactive-Impulsive Type"&
                          DX_06!="Attention-Deficit/Hyperactivity Disorder, Predominantly Hyperactive-Impulsive Type"&
                          DX_07!="Attention-Deficit/Hyperactivity Disorder, Predominantly Hyperactive-Impulsive Type"&
                          DX_08!="Attention-Deficit/Hyperactivity Disorder, Predominantly Hyperactive-Impulsive Type"&
                          DX_09!="Attention-Deficit/Hyperactivity Disorder, Predominantly Hyperactive-Impulsive Type") &
                       (DX_01!="Attention-Deficit/Hyperactivity Disorder, Predominantly Inattentive Type"&
                          DX_02!="Attention-Deficit/Hyperactivity Disorder, Predominantly Inattentive Type"&
                          DX_03!="Attention-Deficit/Hyperactivity Disorder, Predominantly Inattentive Type"&
                          DX_04!="Attention-Deficit/Hyperactivity Disorder, Predominantly Inattentive Type"&
                          DX_05!="Attention-Deficit/Hyperactivity Disorder, Predominantly Inattentive Type"&
                          DX_06!="Attention-Deficit/Hyperactivity Disorder, Predominantly Inattentive Type"&
                          DX_07!="Attention-Deficit/Hyperactivity Disorder, Predominantly Inattentive Type"&
                          DX_08!="Attention-Deficit/Hyperactivity Disorder, Predominantly Inattentive Type"&
                          DX_09!="Attention-Deficit/Hyperactivity Disorder, Predominantly Inattentive Type")) ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

NKI_data <- NKI_data %>%  mutate(DIAG_PSYCH=
            case_when(DX_01=="Brief Psychotic Disorder"|
                        DX_02=="Brief Psychotic Disorder"|
                        DX_03=="Brief Psychotic Disorder"|
                        DX_04=="Brief Psychotic Disorder"|
                        DX_05=="Brief Psychotic Disorder"|
                        DX_06=="Brief Psychotic Disorder"|
                        DX_07=="Brief Psychotic Disorder"|
                        DX_08=="Brief Psychotic Disorder"|
                        DX_09=="Brief Psychotic Disorder" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 &
                      (DX_01!="Brief Psychotic Disorder"&
                          DX_02!="Brief Psychotic Disorder"&
                          DX_03!="Brief Psychotic Disorder"&
                          DX_04!="Brief Psychotic Disorder"&
                          DX_05!="Brief Psychotic Disorder"&
                          DX_06!="Brief Psychotic Disorder"&
                          DX_07!="Brief Psychotic Disorder"&
                          DX_08!="Brief Psychotic Disorder"&
                          DX_09!="Brief Psychotic Disorder") ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

NKI_data <- NKI_data %>%  mutate(DIAG_DEP=
            case_when(DX_01=="Major Depressive Disorder, Recurrent, In Full Remission"|
                        DX_02=="Major Depressive Disorder, Recurrent, In Full Remission"|
                        DX_03=="Major Depressive Disorder, Recurrent, In Full Remission"|
                        DX_04=="Major Depressive Disorder, Recurrent, In Full Remission"|
                        DX_05=="Major Depressive Disorder, Recurrent, In Full Remission"|
                        DX_06=="Major Depressive Disorder, Recurrent, In Full Remission"|
                        DX_07=="Major Depressive Disorder, Recurrent, In Full Remission"|
                        DX_08=="Major Depressive Disorder, Recurrent, In Full Remission"|
                        DX_09=="Major Depressive Disorder, Recurrent, In Full Remission"~ 1,
                      DX_01=="Depressive Disorder NOS"|
                        DX_02=="Depressive Disorder NOS"|
                        DX_03=="Depressive Disorder NOS"|
                        DX_04=="Depressive Disorder NOS"|
                        DX_05=="Depressive Disorder NOS"|
                        DX_06=="Depressive Disorder NOS"|
                        DX_07=="Depressive Disorder NOS"|
                        DX_08=="Depressive Disorder NOS"|
                        DX_09=="Depressive Disorder NOS"~ 1,
                       DX_01=="Dysthymic Disorder"|
                        DX_02=="Dysthymic Disorder"|
                        DX_03=="Dysthymic Disorder"|
                        DX_04=="Dysthymic Disorder"|
                        DX_05=="Dysthymic Disorder"|
                        DX_06=="Dysthymic Disorder"|
                        DX_07=="Dysthymic Disorder"|
                        DX_08=="Dysthymic Disorder"|
                        DX_09=="Dysthymic Disorder"~ 1,
                      DX_01=="Major Depressive Disorder, Recurrent, Severe With Psychotic Features"|
                        DX_02=="Major Depressive Disorder, Recurrent, Severe With Psychotic Features"|
                        DX_03=="Major Depressive Disorder, Recurrent, Severe With Psychotic Features"|
                        DX_04=="Major Depressive Disorder, Recurrent, Severe With Psychotic Features"|
                        DX_05=="Major Depressive Disorder, Recurrent, Severe With Psychotic Features"|
                        DX_06=="Major Depressive Disorder, Recurrent, Severe With Psychotic Features"|
                        DX_07=="Major Depressive Disorder, Recurrent, Severe With Psychotic Features"|
                        DX_08=="Major Depressive Disorder, Recurrent, Severe With Psychotic Features"|
                        DX_09=="Major Depressive Disorder, Recurrent, Severe With Psychotic Features"~ 1,
                      DX_01=="Major Depressive Disorder, Recurrent, Unspecified"|
                        DX_02=="Major Depressive Disorder, Recurrent, Unspecified"|
                        DX_03=="Major Depressive Disorder, Recurrent, Unspecified"|
                        DX_04=="Major Depressive Disorder, Recurrent, Unspecified"|
                        DX_05=="Major Depressive Disorder, Recurrent, Unspecified"|
                        DX_06=="Major Depressive Disorder, Recurrent, Unspecified"|
                        DX_07=="Major Depressive Disorder, Recurrent, Unspecified"|
                        DX_08=="Major Depressive Disorder, Recurrent, Unspecified"|
                        DX_09=="Major Depressive Disorder, Recurrent, Unspecified"~ 1,
                      DX_01==" Major Depressive Disorder, Single Episode, In Full Remission"|
                        DX_02=="Major Depressive Disorder, Single Episode, In Full Remission"|
                        DX_03=="Major Depressive Disorder, Single Episode, In Full Remission"|
                        DX_04=="Major Depressive Disorder, Single Episode, In Full Remission"|
                        DX_05=="Major Depressive Disorder, Single Episode, In Full Remission"|
                        DX_06=="Major Depressive Disorder, Single Episode, In Full Remission"|
                        DX_07=="Major Depressive Disorder, Single Episode, In Full Remission"|
                        DX_08=="Major Depressive Disorder, Single Episode, In Full Remission"|
                        DX_09=="Major Depressive Disorder, Single Episode, In Full Remission"~ 1,
                      DX_01=="Major Depressive Disorder, Single Episode, Mild"|
                        DX_02=="Major Depressive Disorder, Single Episode, Mild"|
                        DX_03=="Major Depressive Disorder, Single Episode, Mild"|
                        DX_04=="Major Depressive Disorder, Single Episode, Mild"|
                        DX_05=="Major Depressive Disorder, Single Episode, Mild"|
                        DX_06=="Major Depressive Disorder, Single Episode, Mild"|
                        DX_07=="Major Depressive Disorder, Single Episode, Mild"|
                        DX_08=="Major Depressive Disorder, Single Episode, Mild"|
                        DX_09=="Major Depressive Disorder, Single Episode, Mild"~ 1,
                      DX_01=="Major Depressive Disorder, Single Episode, Moderate"|
                        DX_02=="Major Depressive Disorder, Single Episode, Moderate"|
                        DX_03=="Major Depressive Disorder, Single Episode, Moderate"|
                        DX_04=="Major Depressive Disorder, Single Episode, Moderate"|
                        DX_05=="Major Depressive Disorder, Single Episode, Moderate"|
                        DX_06=="Major Depressive Disorder, Single Episode, Moderate"|
                        DX_07=="Major Depressive Disorder, Single Episode, Moderate"|
                        DX_08=="Major Depressive Disorder, Single Episode, Moderate"|
                        DX_09=="Major Depressive Disorder, Single Episode, Moderate"~ 1,
                      DX_01=="Major Depressive Disorder, Single Episode, Severe Without Psychotic Features"|
                        DX_02=="Major Depressive Disorder, Single Episode, Severe Without Psychotic Features"|
                        DX_03=="Major Depressive Disorder, Single Episode, Severe Without Psychotic Features"|
                        DX_04=="Major Depressive Disorder, Single Episode, Severe Without Psychotic Features"|
                        DX_05=="Major Depressive Disorder, Single Episode, Severe Without Psychotic Features"|
                        DX_06=="Major Depressive Disorder, Single Episode, Severe Without Psychotic Features"|
                        DX_07=="Major Depressive Disorder, Single Episode, Severe Without Psychotic Features"|
                        DX_08=="Major Depressive Disorder, Single Episode, Severe Without Psychotic Features"|
                        DX_09=="Major Depressive Disorder, Single Episode, Severe Without Psychotic Features"~ 1,
                       DX_01==" Major Depressive Disorder, Single Episode, Unspecified"|
                        DX_02=="Major Depressive Disorder, Single Episode, Unspecified"|
                        DX_03=="Major Depressive Disorder, Single Episode, Unspecified"|
                        DX_04=="Major Depressive Disorder, Single Episode, Unspecified"|
                        DX_05=="Major Depressive Disorder, Single Episode, Unspecified"|
                        DX_06=="Major Depressive Disorder, Single Episode, Unspecified"|
                        DX_07=="Major Depressive Disorder, Single Episode, Unspecified"|
                        DX_08=="Major Depressive Disorder, Single Episode, Unspecified"|
                        DX_09=="Major Depressive Disorder, Single Episode, Unspecified"~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 &
                      ((DX_01!="Major Depressive Disorder, Recurrent, In Full Remission"&
                          DX_02!="Major Depressive Disorder, Recurrent, In Full Remission"&
                          DX_03!="Major Depressive Disorder, Recurrent, In Full Remission"&
                          DX_04!="Major Depressive Disorder, Recurrent, In Full Remission"&
                          DX_05!="Major Depressive Disorder, Recurrent, In Full Remission"&
                          DX_06!="Major Depressive Disorder, Recurrent, In Full Remission"&
                          DX_07!="Major Depressive Disorder, Recurrent, In Full Remission"&
                          DX_08!="Major Depressive Disorder, Recurrent, In Full Remission"&
                          DX_09!="Major Depressive Disorder, Recurrent, In Full Remission") &
                         (DX_01!="Depressive Disorder NOS"&
                          DX_02!="Depressive Disorder NOS"&
                          DX_03!="Depressive Disorder NOS"&
                          DX_04!="Depressive Disorder NOS"&
                          DX_05!="Depressive Disorder NOS"&
                          DX_06!="Depressive Disorder NOS"&
                          DX_07!="Depressive Disorder NOS"&
                          DX_08!="Depressive Disorder NOS"&
                          DX_09!="Dysthymic Disorder") &
                         (DX_01!="Dysthymic Disorder"&
                          DX_02!="Dysthymic Disorder"&
                          DX_03!="Dysthymic Disorder"&
                          DX_04!="Dysthymic Disorder"&
                          DX_05!="Dysthymic Disorder"&
                          DX_06!="Dysthymic Disorder"&
                          DX_07!="Dysthymic Disorder"&
                          DX_08!="Dysthymic Disorder"&
                          DX_09!="Dysthymic Disorder") &
                       (DX_01!="Major Depressive Disorder, Recurrent, Severe With Psychotic Features"&
                          DX_02!="Major Depressive Disorder, Recurrent, Severe With Psychotic Features"&
                          DX_03!="Major Depressive Disorder, Recurrent, Severe With Psychotic Features"&
                          DX_04!="Major Depressive Disorder, Recurrent, Severe With Psychotic Features"&
                          DX_05!="Major Depressive Disorder, Recurrent, Severe With Psychotic Features"&
                          DX_06!="Major Depressive Disorder, Recurrent, Severe With Psychotic Features"&
                          DX_07!="Major Depressive Disorder, Recurrent, Severe With Psychotic Features"&
                          DX_08!="Major Depressive Disorder, Recurrent, Severe With Psychotic Features"&
                          DX_09!="Major Depressive Disorder, Recurrent, Severe With Psychotic Features") &
                       (DX_01!=" Major Depressive Disorder, Recurrent, Unspecified"&
                          DX_02!="Major Depressive Disorder, Recurrent, Unspecified"&
                          DX_03!="Major Depressive Disorder, Recurrent, Unspecified"&
                          DX_04!="Major Depressive Disorder, Recurrent, Unspecified"&
                          DX_05!="Major Depressive Disorder, Recurrent, Unspecified"&
                          DX_06!="Major Depressive Disorder, Recurrent, Unspecified"&
                          DX_07!="Major Depressive Disorder, Recurrent, Unspecified"&
                          DX_08!="Major Depressive Disorder, Recurrent, Unspecified"&
                          DX_09!="Major Depressive Disorder, Recurrent, Unspecified") &
                         (DX_01!="Major Depressive Disorder, Single Episode, In Full Remission"&
                          DX_02!="Major Depressive Disorder, Single Episode, In Full Remission"&
                          DX_03!="Major Depressive Disorder, Single Episode, In Full Remission"&
                          DX_04!="Major Depressive Disorder, Single Episode, In Full Remission"&
                          DX_05!="Major Depressive Disorder, Single Episode, In Full Remission"&
                          DX_06!="Major Depressive Disorder, Single Episode, In Full Remission"&
                          DX_07!="Major Depressive Disorder, Single Episode, In Full Remission"&
                          DX_08!="Major Depressive Disorder, Single Episode, In Full Remission"&
                          DX_09!="Major Depressive Disorder, Single Episode, In Full Remission") &
                         (DX_01!="Major Depressive Disorder, Single Episode, Mild"&
                          DX_02!="Major Depressive Disorder, Single Episode, Mild"&
                          DX_03!="Major Depressive Disorder, Single Episode, Mild"&
                          DX_04!="Major Depressive Disorder, Single Episode, Mild"&
                          DX_05!="Major Depressive Disorder, Single Episode, Mild"&
                          DX_06!="Major Depressive Disorder, Single Episode, Mild"&
                          DX_07!="Major Depressive Disorder, Single Episode, Mild"&
                          DX_08!="Major Depressive Disorder, Single Episode, Mild"&
                          DX_09!="Major Depressive Disorder, Single Episode, Mild") &
                         (DX_01!="Major Depressive Disorder, Single Episode, Moderate"&
                          DX_02!="Major Depressive Disorder, Single Episode, Moderate"&
                          DX_03!="Major Depressive Disorder, Single Episode, Moderate"&
                          DX_04!="Major Depressive Disorder, Single Episode, Moderate"&
                          DX_05!="Major Depressive Disorder, Single Episode, Moderate"&
                          DX_06!="Major Depressive Disorder, Single Episode, Moderate"&
                          DX_07!="Major Depressive Disorder, Single Episode, Moderate"&
                          DX_08!="Major Depressive Disorder, Single Episode, Moderate"&
                          DX_09!="Major Depressive Disorder, Single Episode, Moderate") &
                         (DX_01!="Major Depressive Disorder, Single Episode, Severe Without Psychotic Features"&
                          DX_02!="Major Depressive Disorder, Single Episode, Severe Without Psychotic Features"&
                          DX_03!="Major Depressive Disorder, Single Episode, Severe Without Psychotic Features"&
                          DX_04!="Major Depressive Disorder, Single Episode, Severe Without Psychotic Features"&
                          DX_05!="Major Depressive Disorder, Single Episode, Severe Without Psychotic Features"&
                          DX_06!="Major Depressive Disorder, Single Episode, Severe Without Psychotic Features"&
                          DX_07!="Major Depressive Disorder, Single Episode, Severe Without Psychotic Features"&
                          DX_08!="Major Depressive Disorder, Single Episode, Severe Without Psychotic Features"&
                          DX_09!="Major Depressive Disorder, Single Episode, Severe Without Psychotic Features") &
                         (DX_01!="Major Depressive Disorder, Single Episode, Unspecified"&
                          DX_02!="Major Depressive Disorder, Single Episode, Unspecified"&
                          DX_03!="Major Depressive Disorder, Single Episode, Unspecified"&
                          DX_04!="Major Depressive Disorder, Single Episode, Unspecified"&
                          DX_05!="Major Depressive Disorder, Single Episode, Unspecified"&
                          DX_06!="Major Depressive Disorder, Single Episode, Unspecified"&
                          DX_07!="Major Depressive Disorder, Single Episode, Unspecified"&
                          DX_08!="Major Depressive Disorder, Single Episode, Unspecified"&
                          DX_09!="Major Depressive Disorder, Single Episode, Unspecified")) ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

NKI_data <- NKI_data %>%  mutate(DIAG_CD=
            case_when(DX_01=="Conduct Disorder Childhood-Onset Type (new code as of 10/01/96)"|
                        DX_02=="Conduct Disorder Childhood-Onset Type (new code as of 10/01/96)"|
                        DX_03=="Conduct Disorder Childhood-Onset Type (new code as of 10/01/96)"|
                        DX_04=="Conduct Disorder Childhood-Onset Type (new code as of 10/01/96)"|
                        DX_05=="Conduct Disorder Childhood-Onset Type (new code as of 10/01/96)"|
                        DX_06=="Conduct Disorder Childhood-Onset Type (new code as of 10/01/96)"|
                        DX_07=="Conduct Disorder Childhood-Onset Type (new code as of 10/01/96)"|
                        DX_08=="Conduct Disorder Childhood-Onset Type (new code as of 10/01/96)"|
                        DX_09=="Conduct Disorder Childhood-Onset Type (new code as of 10/01/96)" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 &
                      ((DX_01!="Conduct Disorder Childhood-Onset Type (new code as of 10/01/96)"&
                          DX_02!="Conduct Disorder Childhood-Onset Type (new code as of 10/01/96)"&
                          DX_03!="Conduct Disorder Childhood-Onset Type (new code as of 10/01/96)"&
                          DX_04!="Conduct Disorder Childhood-Onset Type (new code as of 10/01/96)"&
                          DX_05!="Conduct Disorder Childhood-Onset Type (new code as of 10/01/96)"&
                          DX_06!="Conduct Disorder Childhood-Onset Type (new code as of 10/01/96)"&
                          DX_07!="Conduct Disorder Childhood-Onset Type (new code as of 10/01/96)"&
                          DX_08!="Conduct Disorder Childhood-Onset Type (new code as of 10/01/96)"&
                          DX_09!="Conduct Disorder Childhood-Onset Type (new code as of 10/01/96)")) ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

NKI_data <- NKI_data %>%  mutate(DIAG_EAT=
            case_when(DX_01=="Anorexia Nervosa"| #adaptar conforme esse primeiro
                        DX_02=="Anorexia Nervosa"|
                        DX_03=="Anorexia Nervosa"|
                        DX_04=="Anorexia Nervosa"|
                        DX_05=="Anorexia Nervosa"|
                        DX_06=="Anorexia Nervosa"|
                        DX_07=="Anorexia Nervosa"|
                        DX_08=="Anorexia Nervosa"|
                        DX_09=="Anorexia Nervosa" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 &
                      ((DX_01!="Anorexia Nervosa"&
                          DX_02!="Anorexia Nervosa"&
                          DX_03!="Anorexia Nervosa"&
                          DX_04!="Anorexia Nervosa"&
                          DX_05!="Anorexia Nervosa"&
                          DX_06!="Anorexia Nervosa"&
                          DX_07!="Anorexia Nervosa"&
                          DX_08!="Anorexia Nervosa"&
                          DX_09!="Anorexia Nervosa")) ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

NKI_data <- NKI_data %>%  mutate(DIAG_AUTISM=
            case_when(DX_01=="Asperger's Disorder"|
                        DX_02=="Asperger's Disorder"|
                        DX_03=="Asperger's Disorder"|
                        DX_04=="Asperger's Disorder"|
                        DX_05=="Asperger's Disorder"|
                        DX_06=="Asperger's Disorder"|
                        DX_07=="Asperger's Disorder"|
                        DX_08=="Asperger's Disorder"|
                        DX_09=="Asperger's Disorder"~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 &
                      ((DX_01!="Asperger's Disorder"&
                          DX_02!="Asperger's Disorder"&
                          DX_03!="Asperger's Disorder"&
                          DX_04!="Asperger's Disorder"&
                          DX_05!="Asperger's Disorder"&
                          DX_06!="Asperger's Disorder"&
                          DX_07!="Asperger's Disorder"&
                          DX_08!="Asperger's Disorder"&
                          DX_09!="Asperger's Disorder")) ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

NKI_data <- NKI_data %>%  mutate(DIAG_TIC=
            case_when(DX_01=="Chronic Motor or Vocal Tic Disorder"|
                        DX_02=="Chronic Motor or Vocal Tic Disorder"|
                        DX_03=="Chronic Motor or Vocal Tic Disorder"|
                        DX_04=="Chronic Motor or Vocal Tic Disorder"|
                        DX_05=="Chronic Motor or Vocal Tic Disorder"|
                        DX_06=="Chronic Motor or Vocal Tic Disorder"|
                        DX_07=="Chronic Motor or Vocal Tic Disorder"|
                        DX_08=="Chronic Motor or Vocal Tic Disorder"|
                        DX_09=="Chronic Motor or Vocal Tic Disorder" ~ 1,
                      DX_01=="Tic Disorder NOS"|
                        DX_02=="Tic Disorder NOS"|
                        DX_03=="Tic Disorder NOS"|
                        DX_04=="Tic Disorder NOS"|
                        DX_05=="Tic Disorder NOS"|
                        DX_06=="Tic Disorder NOS"|
                        DX_07=="Tic Disorder NOS"|
                        DX_08=="Tic Disorder NOS"|
                        DX_09=="Tic Disorder NOS" ~ 1,
                     DX_01=="Tourette's Disorder"|
                        DX_02=="Tourette's Disorder"|
                        DX_03=="Tourette's Disorder"|
                        DX_04=="Tourette's Disorder"|
                        DX_05=="Tourette's Disorder"|
                        DX_06=="Tourette's Disorder"|
                        DX_07=="Tourette's Disorder"|
                        DX_08=="Tourette's Disorder"|
                        DX_09=="Tourette's Disorder" ~ 1,
                     DX_01=="Transient Tic Disorder"|
                        DX_02=="Transient Tic Disorder"|
                        DX_03=="Transient Tic Disorder"|
                        DX_04=="Transient Tic Disorder"|
                        DX_05=="Transient Tic Disorder"|
                        DX_06=="Transient Tic Disorder"|
                        DX_07=="Transient Tic Disorder"|
                        DX_08=="Transient Tic Disorder"|
                        DX_09=="Transient Tic Disorder" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 &
                      ((DX_01!="Chronic Motor or Vocal Tic Disorder"&
                          DX_02!="Chronic Motor or Vocal Tic Disorder"&
                          DX_03!="Chronic Motor or Vocal Tic Disorder"&
                          DX_04!="Chronic Motor or Vocal Tic Disorder"&
                          DX_05!="Chronic Motor or Vocal Tic Disorder"&
                          DX_06!="Chronic Motor or Vocal Tic Disorder"&
                          DX_07!="Chronic Motor or Vocal Tic Disorder"&
                          DX_08!="Chronic Motor or Vocal Tic Disorder"&
                          DX_09!="Chronic Motor or Vocal Tic Disorder") &
                       (DX_01!="Tic Disorder NOS"&
                          DX_02!="Tic Disorder NOS"&
                          DX_03!="Tic Disorder NOS"&
                          DX_04!="Tic Disorder NOS"&
                          DX_05!="Tic Disorder NOS"&
                          DX_06!="Tic Disorder NOS"&
                          DX_07!="Tic Disorder NOS"&
                          DX_08!="Tic Disorder NOS"&
                          DX_09!="Tic Disorder NOS") &
                       (DX_01!="Tourette's Disorder"&
                          DX_02!="Tourette's Disorder"&
                          DX_03!="Tourette's Disorder"&
                          DX_04!="Tourette's Disorder"&
                          DX_05!="Tourette's Disorder"&
                          DX_06!="Tourette's Disorder"&
                          DX_07!="Tourette's Disorder"&
                          DX_08!="Tourette's Disorder"&
                          DX_09!="Tourette's Disorder") &
                       (DX_01!="Transient Tic Disorder"&
                          DX_02!="Transient Tic Disorder"&
                          DX_03!="Transient Tic Disorder"&
                          DX_04!="Transient Tic Disorder"&
                          DX_05!="Transient Tic Disorder"&
                          DX_06!="Transient Tic Disorder"&
                          DX_07!="Transient Tic Disorder"&
                          DX_08!="Transient Tic Disorder"&
                          DX_09!="Transient Tic Disorder")) ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

NKI_data <- NKI_data %>%  mutate(DIAG_Other_ANX=
            case_when(DX_01=="Anxiety Disorder NOS"|
                        DX_02=="Anxiety Disorder NOS"|
                        DX_03=="Anxiety Disorder NOS"|
                        DX_04=="Anxiety Disorder NOS"|
                        DX_05=="Anxiety Disorder NOS"|
                        DX_06=="Anxiety Disorder NOS"|
                        DX_07=="Anxiety Disorder NOS"|
                        DX_08=="Anxiety Disorder NOS"|
                        DX_09=="Anxiety Disorder NOS" ~ 1,
                      DIAG_ANY==0 ~ 0,
                      DIAG_ANY==1 & ((DX_01!="Anxiety Disorder NOS"&
                                     DX_02!="Anxiety Disorder NOS"&
                                     DX_03!="Anxiety Disorder NOS"&
                                     DX_04!="Anxiety Disorder NOS"&
                                     DX_05!="Anxiety Disorder NOS"&
                                     DX_06!="Anxiety Disorder NOS"&
                                     DX_07!="Anxiety Disorder NOS"&
                                     DX_08!="Anxiety Disorder NOS"&
                                     DX_09!="Anxiety Disorder NOS")) ~ 0,
                      DIAG_ANY==NA ~ NA_real_))

# CBCL
colnames(NKI_data)<-str_replace(colnames(NKI_data), "nkicbcl", "CBCL")
colnames(NKI_data)<-str_replace(colnames(NKI_data), "CBCL_00", "CBCL_")
colnames(NKI_data)<-str_replace(colnames(NKI_data), "CBCL_0", "CBCL_")
NKI_data<-dplyr::rename(NKI_data,CBCL_2=CBCL_2a)
NKI_data<-dplyr::rename(NKI_data,CBCL_9=CBCL_9a)
NKI_data<-dplyr::rename(NKI_data,CBCL_29=CBCL_29a)
NKI_data<-dplyr::rename(NKI_data,CBCL_40=CBCL_40a)
NKI_data<-dplyr::rename(NKI_data,CBCL_46=CBCL_46a)
NKI_data<-dplyr::rename(NKI_data,CBCL_58=CBCL_58a)
NKI_data<-dplyr::rename(NKI_data,CBCL_66=CBCL_66a)
NKI_data<-dplyr::rename(NKI_data,CBCL_70=CBCL_70a)
NKI_data<-dplyr::rename(NKI_data,CBCL_73=CBCL_73a)
NKI_data<-dplyr::rename(NKI_data,CBCL_77=CBCL_77a)
NKI_data<-dplyr::rename(NKI_data,CBCL_79=CBCL_79a)
NKI_data<-dplyr::rename(NKI_data,CBCL_83=CBCL_83a)
NKI_data<-dplyr::rename(NKI_data,CBCL_84=CBCL_84a)
NKI_data<-dplyr::rename(NKI_data,CBCL_85=CBCL_85a)
NKI_data<-dplyr::rename(NKI_data,CBCL_92=CBCL_92a)
NKI_data<-dplyr::rename(NKI_data,CBCL_100=CBCL_100a)
NKI_data<-dplyr::rename(NKI_data,CBCL_105=CBCL_105a)
NKI_data<-dplyr::rename(NKI_data,CBCL_113=CBCL_113a)
NKI_data<-dplyr::rename(NKI_data,CBCL_56A=CBCL_56a)
NKI_data<-dplyr::rename(NKI_data,CBCL_56B=CBCL_56b)
NKI_data<-dplyr::rename(NKI_data,CBCL_56C=CBCL_56c)
NKI_data<-dplyr::rename(NKI_data,CBCL_56D=CBCL_56da)
NKI_data<-dplyr::rename(NKI_data,CBCL_56E=CBCL_56e)
NKI_data<-dplyr::rename(NKI_data,CBCL_56F=CBCL_56f)
NKI_data<-dplyr::rename(NKI_data,CBCL_56G=CBCL_56g)
NKI_data<-dplyr::rename(NKI_data,CBCL_56H=CBCL_56ha)
NKI_data <-  NKI_data %>% mutate_at(vars(starts_with("CBCL")),as.numeric) 
NKI_data<-NKI_data %>% mutate(CBCL_56A = car::recode(CBCL_56A, "NA=99"))
NKI_data<-NKI_data %>% mutate(CBCL_56B = car::recode(CBCL_56B, "NA=99"))
NKI_data<-NKI_data %>% mutate(CBCL_56C = car::recode(CBCL_56C, "NA=99"))
NKI_data<-NKI_data %>% mutate(CBCL_56D = car::recode(CBCL_56D, "NA=99"))
NKI_data<-NKI_data %>% mutate(CBCL_56E = car::recode(CBCL_56E, "NA=99"))
NKI_data<-NKI_data %>% mutate(CBCL_56F = car::recode(CBCL_56F, "NA=99"))
NKI_data<-NKI_data %>% mutate(CBCL_56G = car::recode(CBCL_56G, "NA=99"))
NKI_data<-NKI_data %>% mutate(CBCL_56H = car::recode(CBCL_56H, "NA=99"))
NKI_data <- NKI_data %>%  mutate(CBCL_56=
            case_when(CBCL_56A==99 &CBCL_56B==99 &CBCL_56C==99 &CBCL_56D==99 &
                       CBCL_56E==99 &CBCL_56F==99 &CBCL_56G==99 &CBCL_56H==99 ~ NA_real_,
                      (CBCL_56A==2 |CBCL_56B==2 |CBCL_56C==2 |CBCL_56D==2 |
                       CBCL_56E==2 |CBCL_56F==2 |CBCL_56G==2 |CBCL_56H==2) ~ 2,
                      (CBCL_56A==1 |CBCL_56B==1 |CBCL_56C==1 |CBCL_56D==1 |
                       CBCL_56E==1 |CBCL_56F==1 |CBCL_56G==1 |CBCL_56H==1) & 
                       (CBCL_56A!=2 |CBCL_56B!=2 |CBCL_56C!=2 |CBCL_56D!=2 |
                       CBCL_56E!=2 |CBCL_56F!=2 |CBCL_56G!=2 |CBCL_56H!=2) ~ 1,
                      CBCL_56A==0 &CBCL_56B==0 &CBCL_56C==0 &CBCL_56D==0 &
                       CBCL_56E==0 &CBCL_56F==0 &CBCL_56G==0 &CBCL_56H==0 ~ 0))

NKI_data<-NKI_data %>% mutate(CBCL_56A = car::recode(CBCL_56A, "99=NA"))
NKI_data<-NKI_data %>% mutate(CBCL_56B = car::recode(CBCL_56B, "99=NA"))
NKI_data<-NKI_data %>% mutate(CBCL_56C = car::recode(CBCL_56C, "99=NA"))
NKI_data<-NKI_data %>% mutate(CBCL_56D = car::recode(CBCL_56D, "99=NA"))
NKI_data<-NKI_data %>% mutate(CBCL_56E = car::recode(CBCL_56E, "99=NA"))
NKI_data<-NKI_data %>% mutate(CBCL_56F = car::recode(CBCL_56F, "99=NA"))
NKI_data<-NKI_data %>% mutate(CBCL_56G = car::recode(CBCL_56G, "99=NA"))
NKI_data<-NKI_data %>% mutate(CBCL_56H = car::recode(CBCL_56H, "99=NA"))
NKI_data <-  NKI_data %>% mutate_at(vars(starts_with("CBCL")),ordered) 

#YSR
colnames(NKI_data)<-str_replace(colnames(NKI_data), "ysr_", "YSR_")
colnames(NKI_data)<-str_replace(colnames(NKI_data), "YSR_00", "YSR_")
colnames(NKI_data)<-str_replace(colnames(NKI_data), "YSR_0", "YSR_")
NKI_data <-  NKI_data %>% mutate_at(vars(starts_with("YSR")),as.numeric) 
NKI_data<-dplyr::rename(NKI_data,YSR_2=YSR_2a)
NKI_data<-dplyr::rename(NKI_data,YSR_9=YSR_9a)
NKI_data<-dplyr::rename(NKI_data,YSR_29=YSR_29a)
NKI_data<-dplyr::rename(NKI_data,YSR_40=YSR_40a)
NKI_data<-dplyr::rename(NKI_data,YSR_46=YSR_46a)
NKI_data<-dplyr::rename(NKI_data,YSR_58=YSR_58a)
NKI_data<-dplyr::rename(NKI_data,YSR_66=YSR_66a)
NKI_data<-dplyr::rename(NKI_data,YSR_70=YSR_70a)
NKI_data<-dplyr::rename(NKI_data,YSR_73=YSR_73a)
NKI_data<-dplyr::rename(NKI_data,YSR_77=YSR_77a)
NKI_data<-dplyr::rename(NKI_data,YSR_79=YSR_79a)
NKI_data<-dplyr::rename(NKI_data,YSR_83=YSR_83a)
NKI_data<-dplyr::rename(NKI_data,YSR_84=YSR_84a)
NKI_data<-dplyr::rename(NKI_data,YSR_85=YSR_85a)
NKI_data<-dplyr::rename(NKI_data,YSR_100=YSR_100a)
NKI_data<-dplyr::rename(NKI_data,YSR_105=YSR_105a)
NKI_data<-dplyr::rename(NKI_data,YSR_56A=YSR_56a)
NKI_data<-dplyr::rename(NKI_data,YSR_56B=YSR_56b)
NKI_data<-dplyr::rename(NKI_data,YSR_56C=YSR_56c)
NKI_data<-dplyr::rename(NKI_data,YSR_56D=YSR_56d1)
NKI_data<-dplyr::rename(NKI_data,YSR_56E=YSR_56e)
NKI_data<-dplyr::rename(NKI_data,YSR_56F=YSR_56f)
NKI_data<-dplyr::rename(NKI_data,YSR_56G=YSR_56g)
NKI_data<-dplyr::rename(NKI_data,YSR_56H=YSR_56h1)
NKI_data<-NKI_data %>% mutate(YSR_56A = car::recode(YSR_56A, "NA=99"))
NKI_data<-NKI_data %>% mutate(YSR_56B = car::recode(YSR_56B, "NA=99"))
NKI_data<-NKI_data %>% mutate(YSR_56C = car::recode(YSR_56C, "NA=99"))
NKI_data<-NKI_data %>% mutate(YSR_56D = car::recode(YSR_56D, "NA=99"))
NKI_data<-NKI_data %>% mutate(YSR_56E = car::recode(YSR_56E, "NA=99"))
NKI_data<-NKI_data %>% mutate(YSR_56F = car::recode(YSR_56F, "NA=99"))
NKI_data<-NKI_data %>% mutate(YSR_56G = car::recode(YSR_56G, "NA=99"))
NKI_data<-NKI_data %>% mutate(YSR_56H = car::recode(YSR_56H, "NA=99"))
NKI_data <- NKI_data %>%  mutate(YSR_56=
            case_when(YSR_56A==99 &YSR_56B==99 &YSR_56C==99 &YSR_56D==99 &
                       YSR_56E==99 &YSR_56F==99 &YSR_56G==99 &YSR_56H==99 ~ NA_real_,
                      (YSR_56A==2 |YSR_56B==2 |YSR_56C==2 |YSR_56D==2 |
                       YSR_56E==2 |YSR_56F==2 |YSR_56G==2 |YSR_56H==2) ~ 2,
                      (YSR_56A==1 |YSR_56B==1 |YSR_56C==1 |YSR_56D==1 |
                       YSR_56E==1 |YSR_56F==1 |YSR_56G==1 |YSR_56H==1) & 
                       (YSR_56A!=2 |YSR_56B!=2 |YSR_56C!=2 |YSR_56D!=2 |
                       YSR_56E!=2 |YSR_56F!=2 |YSR_56G!=2 |YSR_56H!=2) ~ 1,
                      TRUE ~ 0))
NKI_data<-NKI_data %>% mutate(YSR_56A = car::recode(YSR_56A, "99=NA"))
NKI_data<-NKI_data %>% mutate(YSR_56B = car::recode(YSR_56B, "99=NA"))
NKI_data<-NKI_data %>% mutate(YSR_56C = car::recode(YSR_56C, "99=NA"))
NKI_data<-NKI_data %>% mutate(YSR_56D = car::recode(YSR_56D, "99=NA"))
NKI_data<-NKI_data %>% mutate(YSR_56E = car::recode(YSR_56E, "99=NA"))
NKI_data<-NKI_data %>% mutate(YSR_56F = car::recode(YSR_56F, "99=NA"))
NKI_data<-NKI_data %>% mutate(YSR_56G = car::recode(YSR_56G, "99=NA"))
NKI_data<-NKI_data %>% mutate(YSR_56H = car::recode(YSR_56H, "99=NA"))
NKI_data_cbcl <- NKI_data_cbcl %>%mutate_at(vars(starts_with("YSR")),ordered) 


# Insert vars to match other data sets
NKI_data$Maternal_DIAG_ANY <- NA
NKI_data$Sampling_weight <- NA  
NKI_data$Birth_weight <- NA  
NKI_data$Birth_delivery <- NA  
NKI_data$Birth_premature <- NA 
NKI_data$Birth_preg_dur <- NA  
NKI_data$BMI <- NA  
NKI_data$School_repet <- NA
NKI_data$School_exp <- NA
NKI_data$School_susp <- NA  
NKI_data$TRF_1<-NA; NKI_data$TRF_2<-NA; NKI_data$TRF_3<-NA; NKI_data$TRF_4<-NA; NKI_data$TRF_5<-NA; NKI_data$TRF_6<-NA; NKI_data$TRF_7<-NA; NKI_data$TRF_8<-NA; NKI_data$TRF_9<-NA; NKI_data$TRF_10<-NA;
NKI_data$TRF_11<-NA; NKI_data$TRF_12<-NA; NKI_data$TRF_13<-NA; NKI_data$TRF_14<-NA; NKI_data$TRF_15<-NA; NKI_data$TRF_16<-NA; NKI_data$TRF_17<-NA; NKI_data$TRF_18<-NA; NKI_data$TRF_19<-NA; NKI_data$TRF_20<-NA;
NKI_data$TRF_21<-NA; NKI_data$TRF_22<-NA; NKI_data$TRF_23<-NA; NKI_data$TRF_24<-NA; NKI_data$TRF_25<-NA; NKI_data$TRF_26<-NA; NKI_data$TRF_27<-NA; NKI_data$TRF_28<-NA; NKI_data$TRF_29<-NA; NKI_data$TRF_30<-NA;
NKI_data$TRF_31<-NA; NKI_data$TRF_32<-NA; NKI_data$TRF_33<-NA; NKI_data$TRF_34<-NA; NKI_data$TRF_35<-NA; NKI_data$TRF_36<-NA; NKI_data$TRF_37<-NA; NKI_data$TRF_38<-NA; NKI_data$TRF_39<-NA; NKI_data$TRF_40<-NA;
NKI_data$TRF_41<-NA; NKI_data$TRF_42<-NA; NKI_data$TRF_43<-NA; NKI_data$TRF_44<-NA; NKI_data$TRF_45<-NA; NKI_data$TRF_46<-NA; NKI_data$TRF_47<-NA; NKI_data$TRF_48<-NA; NKI_data$TRF_49<-NA; NKI_data$TRF_50<-NA;
NKI_data$TRF_51<-NA; NKI_data$TRF_52<-NA; NKI_data$TRF_53<-NA; NKI_data$TRF_54<-NA; NKI_data$TRF_55<-NA; NKI_data$TRF_56<-NA; NKI_data$TRF_57<-NA; NKI_data$TRF_58<-NA; NKI_data$TRF_59<-NA; NKI_data$TRF_60<-NA;
NKI_data$TRF_56A<-NA; NKI_data$TRF_56B<-NA; NKI_data$TRF_56C<-NA;NKI_data$TRF_56D<-NA; NKI_data$TRF_56E<-NA;
NKI_data$TRF_56F<-NA; NKI_data$TRF_56G<-NA; NKI_data$TRF_56H<-NA; 
NKI_data$TRF_61<-NA; NKI_data$TRF_62<-NA; NKI_data$TRF_63<-NA; NKI_data$TRF_64<-NA; NKI_data$TRF_65<-NA; NKI_data$TRF_66<-NA; NKI_data$TRF_67<-NA; NKI_data$TRF_68<-NA; NKI_data$TRF_69<-NA; NKI_data$TRF_70<-NA;
NKI_data$TRF_71<-NA; NKI_data$TRF_72<-NA; NKI_data$TRF_73<-NA; NKI_data$TRF_74<-NA; NKI_data$TRF_75<-NA; NKI_data$TRF_76<-NA; NKI_data$TRF_77<-NA; NKI_data$TRF_78<-NA; NKI_data$TRF_79<-NA; NKI_data$TRF_80<-NA;
NKI_data$TRF_81<-NA; NKI_data$TRF_82<-NA; NKI_data$TRF_83<-NA; NKI_data$TRF_84<-NA; NKI_data$TRF_85<-NA; NKI_data$TRF_86<-NA; NKI_data$TRF_87<-NA; NKI_data$TRF_88<-NA; NKI_data$TRF_89<-NA; NKI_data$TRF_90<-NA;
NKI_data$TRF_91<-NA; NKI_data$TRF_92<-NA; NKI_data$TRF_93<-NA; NKI_data$TRF_94<-NA; NKI_data$TRF_95<-NA; NKI_data$TRF_96<-NA; NKI_data$TRF_97<-NA; NKI_data$TRF_98<-NA; NKI_data$TRF_99<-NA; NKI_data$TRF_100<-NA;
NKI_data$TRF_101<-NA; NKI_data$TRF_102<-NA; NKI_data$TRF_103<-NA; NKI_data$TRF_104<-NA; NKI_data$TRF_105<-NA; NKI_data$TRF_106<-NA; NKI_data$TRF_107<-NA; NKI_data$TRF_108<-NA; NKI_data$TRF_109<-NA; NKI_data$TRF_110<-NA; NKI_data$TRF_111<-NA; NKI_data$TRF_112<-NA; NKI_data$TRF_113<-NA

NKI_data$pSDQ_3<-NA; NKI_data$pSDQ_8<-NA; NKI_data$pSDQ_13<-NA; NKI_data$pSDQ_16<-NA; NKI_data$pSDQ_24<-NA; NKI_data$pSDQ_5<-NA; NKI_data$pSDQ_7<-NA; NKI_data$pSDQ_12<-NA; NKI_data$pSDQ_18<-NA; NKI_data$pSDQ_22<-NA; NKI_data$pSDQ_2<-NA; NKI_data$pSDQ_10<-NA; NKI_data$pSDQ_15<-NA; NKI_data$pSDQ_21<-NA; NKI_data$pSDQ_25<-NA; NKI_data$pSDQ_6<-NA; NKI_data$pSDQ_11<-NA; NKI_data$pSDQ_14<-NA; NKI_data$pSDQ_19<-NA; NKI_data$pSDQ_23<-NA; NKI_data$pSDQ_1<-NA; NKI_data$pSDQ_4<-NA; NKI_data$pSDQ_9<-NA; NKI_data$pSDQ_17<-NA; NKI_data$pSDQ_20<-NA; NKI_data$pSDQ_26 <- NA
NKI_data$pSDQ_26b <- NA
NKI_data$pSDQ_26c <- NA
NKI_data$pSDQ_26d <- NA
NKI_data$pSDQ_26e <- NA
NKI_data$pSDQ_26f <- NA

NKI_data$sSDQ_3<-NA; NKI_data$sSDQ_8<-NA; NKI_data$sSDQ_13<-NA; NKI_data$sSDQ_16<-NA; NKI_data$sSDQ_24<-NA; NKI_data$sSDQ_5<-NA; NKI_data$sSDQ_7<-NA; NKI_data$sSDQ_12<-NA; NKI_data$sSDQ_18<-NA; NKI_data$sSDQ_22<-NA; NKI_data$sSDQ_2<-NA; NKI_data$sSDQ_10<-NA; NKI_data$sSDQ_15<-NA; NKI_data$sSDQ_21<-NA; NKI_data$sSDQ_25<-NA; NKI_data$sSDQ_6<-NA; NKI_data$sSDQ_11<-NA; NKI_data$sSDQ_14<-NA; NKI_data$sSDQ_19<-NA; NKI_data$sSDQ_23<-NA; NKI_data$sSDQ_1<-NA; NKI_data$sSDQ_4<-NA; NKI_data$sSDQ_9<-NA; NKI_data$sSDQ_17<-NA; NKI_data$sSDQ_20<-NA;

NKI_data$tSDQ_3<-NA; NKI_data$tSDQ_8<-NA; NKI_data$tSDQ_13<-NA; NKI_data$tSDQ_16<-NA; NKI_data$tSDQ_24<-NA; NKI_data$tSDQ_5<-NA; NKI_data$tSDQ_7<-NA; NKI_data$tSDQ_12<-NA; NKI_data$tSDQ_18<-NA; NKI_data$tSDQ_22<-NA; NKI_data$tSDQ_2<-NA; NKI_data$tSDQ_10<-NA; NKI_data$tSDQ_15<-NA; NKI_data$tSDQ_21<-NA; NKI_data$tSDQ_25<-NA; NKI_data$tSDQ_6<-NA; NKI_data$tSDQ_11<-NA; NKI_data$tSDQ_14<-NA; NKI_data$tSDQ_19<-NA; NKI_data$tSDQ_23<-NA; NKI_data$tSDQ_1<-NA; NKI_data$tSDQ_4<-NA; NKI_data$tSDQ_9<-NA; NKI_data$tSDQ_17<-NA; NKI_data$tSDQ_20<-NA;

NKI_data$GOASSESS_SIP_010 <- NA ; NKI_data$GOASSESS_SIP_007 <- NA ; NKI_data$GOASSESS_SIP_012 <- NA ; NKI_data$GOASSESS_SIP_008 <- NA ; NKI_data$GOASSESS_SIP_013 <- NA ; NKI_data$GOASSESS_SIP_011 <- NA ; NKI_data$GOASSESS_SIP_005 <- NA ; NKI_data$GOASSESS_SIP_006 <- NA ; NKI_data$GOASSESS_SIP_004 <- NA ; NKI_data$GOASSESS_SIP_003 <- NA ; NKI_data$GOASSESS_SIP_009 <- NA ; NKI_data$GOASSESS_SIP_014 <- NA ; NKI_data$GOASSESS_PSY_001 <- NA ; NKI_data$GOASSESS_PSY_060 <- NA ; NKI_data$GOASSESS_PSY_029 <- NA ; NKI_data$GOASSESS_SIP_027 <- NA ; NKI_data$GOASSESS_PSY_070 <- NA ; NKI_data$GOASSESS_SIP_028 <- NA ; NKI_data$GOASSESS_PSY_071 <- NA ; NKI_data$GOASSESS_PSY_050 <- NA ; NKI_data$GOASSESS_ADD_012 <- NA ; NKI_data$GOASSESS_ADD_011 <- NA ; NKI_data$GOASSESS_ADD_016 <- NA ; NKI_data$GOASSESS_ADD_021 <- NA ; NKI_data$GOASSESS_ODD_002 <- NA ; NKI_data$GOASSESS_ODD_003 <- NA ; NKI_data$GOASSESS_ADD_022 <- NA ; NKI_data$GOASSESS_ADD_013 <- NA ; NKI_data$GOASSESS_ADD_014 <- NA ; NKI_data$GOASSESS_ADD_020 <- NA ; NKI_data$GOASSESS_ADD_015 <- NA ; NKI_data$GOASSESS_ODD_001 <- NA ; NKI_data$GOASSESS_CDD_005 <- NA ; NKI_data$GOASSESS_ODD_005 <- NA ; NKI_data$GOASSESS_ODD_006 <- NA ; NKI_data$GOASSESS_CDD_001 <- NA ; 
NKI_data$GOASSESS_CDD_003 <- NA ; NKI_data$GOASSESS_CDD_008 <- NA ; NKI_data$GOASSESS_CDD_006 <- NA ; NKI_data$GOASSESS_CDD_007 <- NA ; NKI_data$GOASSESS_SCR_006 <- NA ; NKI_data$GOASSESS_CDD_004 <- NA ; NKI_data$GOASSESS_SIP_038 <- NA ; NKI_data$GOASSESS_DEP_001 <- NA ; NKI_data$GOASSESS_DEP_002 <- NA ; NKI_data$GOASSESS_SUI_002 <- NA ; NKI_data$GOASSESS_DEP_004 <- NA ; NKI_data$GOASSESS_SIP_032 <- NA ; 
NKI_data$GOASSESS_MAN_007 <- NA ; NKI_data$GOASSESS_DEP_006 <- NA ; NKI_data$GOASSESS_OCD_001 <- NA ; NKI_data$GOASSESS_PAN_004 <- NA ; NKI_data$GOASSESS_PAN_001 <- NA ; NKI_data$GOASSESS_SCR_007 <- NA ; NKI_data$GOASSESS_GAD_002 <- NA ; NKI_data$GOASSESS_OCD_007 <- NA ; NKI_data$GOASSESS_SUI_001 <- NA ; NKI_data$GOASSESS_OCD_005 <- NA ; NKI_data$GOASSESS_PAN_003 <- NA ; NKI_data$GOASSESS_MAN_005 <- NA ; 
NKI_data$GOASSESS_GAD_001 <- NA ; NKI_data$GOASSESS_SIP_033 <- NA ; NKI_data$GOASSESS_OCD_006 <- NA ; NKI_data$GOASSESS_OCD_004 <- NA ; NKI_data$GOASSESS_OCD_016 <- NA ; NKI_data$GOASSESS_OCD_008 <- NA ; NKI_data$GOASSESS_OCD_003 <- NA ; NKI_data$GOASSESS_MAN_004 <- NA ; NKI_data$GOASSESS_MAN_003 <- NA ; NKI_data$GOASSESS_OCD_019 <- NA ; NKI_data$GOASSESS_MAN_002 <- NA ; NKI_data$GOASSESS_MAN_006 <- NA ; 
NKI_data$GOASSESS_CDD_002 <- NA ; NKI_data$GOASSESS_MAN_001 <- NA ; NKI_data$GOASSESS_SCR_001 <- NA ; NKI_data$GOASSESS_OCD_002 <- NA ; NKI_data$GOASSESS_OCD_012 <- NA ; NKI_data$GOASSESS_SIP_039 <- NA ; NKI_data$GOASSESS_OCD_018 <- NA ; NKI_data$GOASSESS_PTD_009 <- NA ; NKI_data$GOASSESS_SCR_008 <- NA ; NKI_data$GOASSESS_AGR_006 <- NA ; NKI_data$GOASSESS_SOC_004 <- NA ; NKI_data$GOASSESS_AGR_005 <- NA ; 
NKI_data$GOASSESS_SOC_005 <- NA ; NKI_data$GOASSESS_AGR_002 <- NA ; NKI_data$GOASSESS_AGR_008 <- NA ; NKI_data$GOASSESS_SOC_001 <- NA ; NKI_data$GOASSESS_AGR_001 <- NA ; NKI_data$GOASSESS_SOC_003 <- NA ; NKI_data$GOASSESS_AGR_003 <- NA ; NKI_data$GOASSESS_AGR_004 <- NA ; NKI_data$GOASSESS_SOC_002 <- NA ; NKI_data$GOASSESS_PHB_004 <- NA ; NKI_data$GOASSESS_SEP_509 <- NA ; NKI_data$GOASSESS_PHB_007 <- NA ; 
NKI_data$GOASSESS_AGR_007 <- NA ; NKI_data$GOASSESS_PHB_006 <- NA ; NKI_data$GOASSESS_PHB_001 <- NA ; NKI_data$GOASSESS_OCD_013 <- NA ; NKI_data$GOASSESS_PHB_002 <- NA ; NKI_data$GOASSESS_SEP_508 <- NA ; NKI_data$GOASSESS_PHB_008 <- NA ; NKI_data$GOASSESS_OCD_011 <- NA ; NKI_data$GOASSESS_PHB_005 <- NA ; NKI_data$GOASSESS_OCD_017 <- NA ; NKI_data$GOASSESS_SEP_500 <- NA ; NKI_data$GOASSESS_OCD_015 <- NA ; 
NKI_data$GOASSESS_SEP_511 <- NA ; NKI_data$GOASSESS_PHB_003 <- NA ; NKI_data$GOASSESS_OCD_014 <- NA ; NKI_data$GOASSESS_SEP_510 <- NA ; NKI_data$GOASSESS_SUI_001_002 <- NA ; NKI_data$GOASSESS_SUI_003 <- NA ; NKI_data$GOASSESS_SUI_004 <- NA ; NKI_data$GOASSESS_SUI_005 <- NA ; NKI_data$GOASSESS_SUI_006 <- NA ; NKI_data$GOASSESS_SUI_007 <- NA ; NKI_data$GOASSESS_SUI_008 <- NA ; NKI_data$GOASSESS_SUI_009 <- NA ; NKI_data$SMRY_SUI <- NA

NKI_data<- NKI_data %>% dplyr::select(EID,Study,Site, Selection,wave,Age,Age_group_3cat,Gender,Sampling_weight,Birth_weight,Birth_delivery,Birth_premature,Birth_preg_dur,Child_race,IQ,BMI,School_years,School_repet,School_exp,School_susp,Maternal_DIAG_ANY, YSR_1:YSR_112, YSR_56, CBCL_1:CBCL_113, CBCL_56, TRF_1:TRF_113, pSDQ_3:tSDQ_20, pSDQ_26, pSDQ_26b:pSDQ_26f, GOASSESS_SIP_010:SMRY_SUI, DIAG_SEP_ANX, DIAG_SPEC_PHOB, DIAG_SOC_PHOB, DIAG_PANIC, DIAG_AGORAPHOB, DIAG_PTSD, DIAG_OCD, DIAG_GEN_ANX, DIAG_DMDD, DIAG_MANIA, DIAG_ADHD, DIAG_ODD, DIAG_PSYCH, DIAG_DEP, DIAG_CD, DIAG_EAT, DIAG_AUTISM, DIAG_TIC, DIAG_Other_ANX, DIAG_ANY, tSDQ_1:tSDQ_25, sSDQ_1:sSDQ_25)

# Test variable name matching against BHRC - see error message:
#nki_var_list <- list(names(NKI_data)); nki_var_list <- nki_var_list[[1]]
#bhrc_data_vars<- BHRC_data %>% dplyr::select(nki_var_list)
```

# Renaming variables for merging data in CCNP
```{r Renaming variables for merging data in CCNP, message=F, warning=F}
CCNP_w1<-rio::import(file="CCNP_CBCL_1st.xlsx")
CCNP_w2<-rio::import(file="CCNP_CBCL_2nd.xlsx")
CCNP_w3<-rio::import(file="CCNP_CBCL_3rd.xlsx")
CCNP_w3<-dplyr::rename(CCNP_w3,CCNP_ID=Colornest_ID)
CCNP_w1$wave <- 1
CCNP_w2$wave <- 2
CCNP_w3$wave <- 3
CCNP_data <- rbind(CCNP_w1, CCNP_w2, CCNP_w3)
rm(CCNP_w1, CCNP_w2, CCNP_w3)

CCNP_data<-dplyr::select_all(CCNP_data, .funs = funs(paste0("CBCL_", .)))
CCNP_data<-dplyr::rename(CCNP_data,EID=CBCL_CCNP_ID)
CCNP_data<-dplyr::rename(CCNP_data,Gender=CBCL_Gender)
CCNP_data <- CCNP_data %>% mutate(Gender=car::recode(Gender,"'M'='Male'; 'F'='Female'"))
CCNP_data$Gender <- as.factor(CCNP_data$Gender)

CCNP_data<-dplyr::rename(CCNP_data,Age=CBCL_Age)
CCNP_data<-CCNP_data %>% mutate(Age_group_3cat = case_when(Age>=5 & Age<11 ~ "5_to_10", 
                                                      Age>=11& Age<15 ~ "11_to_14",
                                                      Age>=15 ~ "15_or_higher"))
CCNP_data$Age_group_3cat <- ordered(CCNP_data$Age_group_3cat, levels = c("5_to_10", "11_to_14", "15_or_higher")) 

CCNP_data$Study<-"CCNP"
CCNP_data$Site<-"CCNP-1"
CCNP_data$Selection <- "Community"
CCNP_data<-dplyr::rename(CCNP_data,wave=CBCL_wave)

# CBCL
CCNP_data<-dplyr::rename(CCNP_data,CBCL_56A=CBCL_a)
CCNP_data<-dplyr::rename(CCNP_data,CBCL_56B=CBCL_b)
CCNP_data<-dplyr::rename(CCNP_data,CBCL_56C=CBCL_c)
CCNP_data<-dplyr::rename(CCNP_data,CBCL_56D=CBCL_d)
CCNP_data<-dplyr::rename(CCNP_data,CBCL_56E=CBCL_e)
CCNP_data<-dplyr::rename(CCNP_data,CBCL_56F=CBCL_f)
CCNP_data<-dplyr::rename(CCNP_data,CBCL_56G=CBCL_g)
CCNP_data<-dplyr::rename(CCNP_data,CBCL_56H=CBCL_h)
CCNP_data <-  CCNP_data %>% mutate_at(vars(starts_with("CBCL")),as.numeric) 
CCNP_data <-  CCNP_data %>% mutate_at(vars(starts_with("CBCL")),ordered) 
CCNP_data<-dplyr::select(-`CBCL_Total Raw`)


# Insert vars to match other data sets

CCNP_data$Sampling_weight <- NA  
CCNP_data$Birth_weight <- NA  
CCNP_data$Birth_delivery <- NA  
CCNP_data$Birth_premature <- NA 
CCNP_data$Birth_preg_dur <- NA  
CCNP_data$Child_race <- NA  
CCNP_data$IQ <- NA  
CCNP_data$BMI <- NA  
CCNP_data$School_years <- NA  
CCNP_data$School_repet <- NA
CCNP_data$School_exp <- NA
CCNP_data$School_susp <- NA  
CCNP_data$Maternal_DIAG_ANY <- NA

CCNP_data$pSDQ_26 <- NA
CCNP_data$pSDQ_26b <- NA
CCNP_data$pSDQ_26c <- NA
CCNP_data$pSDQ_26d <- NA
CCNP_data$pSDQ_26e <- NA
CCNP_data$pSDQ_26f <- NA

CCNP_data$DIAG_SEP_ANX <- NA  
CCNP_data$DIAG_SPEC_PHOB <- NA  
CCNP_data$DIAG_SOC_PHOB <- NA  
CCNP_data$DIAG_PANIC <- NA 
CCNP_data$DIAG_AGORAPHOB <- NA 
CCNP_data$DIAG_PTSD <- NA  
CCNP_data$DIAG_OCD <- NA 
CCNP_data$DIAG_GEN_ANX <- NA 
CCNP_data$DIAG_DMDD <- NA 
CCNP_data$DIAG_MANIA <- NA 
CCNP_data$DIAG_ADHD <- NA 
CCNP_data$DIAG_ODD <- NA  
CCNP_data$DIAG_PSYCH <- NA  
CCNP_data$DIAG_DEP <- NA 
CCNP_data$DIAG_CD <- NA  
CCNP_data$DIAG_EAT <- NA 
CCNP_data$DIAG_AUTISM <- NA  
CCNP_data$DIAG_TIC <- NA 
CCNP_data$DIAG_Other_ANX <- NA 
CCNP_data$DIAG_ANY <- NA 

CCNP_data$YSR_1<-NA; CCNP_data$YSR_2<-NA; CCNP_data$YSR_3<-NA; CCNP_data$YSR_4<-NA; CCNP_data$YSR_5<-NA; CCNP_data$YSR_6<-NA; CCNP_data$YSR_7<-NA; CCNP_data$YSR_8<-NA; CCNP_data$YSR_9<-NA; CCNP_data$YSR_10<-NA;
CCNP_data$YSR_11<-NA; CCNP_data$YSR_12<-NA; CCNP_data$YSR_13<-NA; CCNP_data$YSR_14<-NA; CCNP_data$YSR_15<-NA; CCNP_data$YSR_16<-NA; CCNP_data$YSR_17<-NA; CCNP_data$YSR_18<-NA; CCNP_data$YSR_19<-NA; CCNP_data$YSR_20<-NA;
CCNP_data$YSR_21<-NA; CCNP_data$YSR_22<-NA; CCNP_data$YSR_23<-NA; CCNP_data$YSR_24<-NA; CCNP_data$YSR_25<-NA; CCNP_data$YSR_26<-NA; CCNP_data$YSR_27<-NA; CCNP_data$YSR_28<-NA; CCNP_data$YSR_29<-NA; CCNP_data$YSR_30<-NA;
CCNP_data$YSR_31<-NA; CCNP_data$YSR_32<-NA; CCNP_data$YSR_33<-NA; CCNP_data$YSR_34<-NA; CCNP_data$YSR_35<-NA; CCNP_data$YSR_36<-NA; CCNP_data$YSR_37<-NA; CCNP_data$YSR_38<-NA; CCNP_data$YSR_39<-NA; CCNP_data$YSR_40<-NA;
CCNP_data$YSR_41<-NA; CCNP_data$YSR_42<-NA; CCNP_data$YSR_43<-NA; CCNP_data$YSR_44<-NA; CCNP_data$YSR_45<-NA; CCNP_data$YSR_46<-NA; CCNP_data$YSR_47<-NA; CCNP_data$YSR_48<-NA; CCNP_data$YSR_49<-NA; CCNP_data$YSR_50<-NA;
CCNP_data$YSR_51<-NA; CCNP_data$YSR_52<-NA; CCNP_data$YSR_53<-NA; CCNP_data$YSR_54<-NA; CCNP_data$YSR_55<-NA; CCNP_data$YSR_56<-NA; CCNP_data$YSR_57<-NA; CCNP_data$YSR_58<-NA; CCNP_data$YSR_59<-NA; CCNP_data$YSR_60<-NA;
CCNP_data$YSR_56A<-NA; CCNP_data$YSR_56B<-NA; CCNP_data$YSR_56C<-NA;CCNP_data$YSR_56D<-NA; CCNP_data$YSR_56E<-NA;
CCNP_data$YSR_56F<-NA; CCNP_data$YSR_56G<-NA; CCNP_data$YSR_56H<-NA; 
CCNP_data$YSR_61<-NA; CCNP_data$YSR_62<-NA; CCNP_data$YSR_63<-NA; CCNP_data$YSR_64<-NA; CCNP_data$YSR_65<-NA; CCNP_data$YSR_66<-NA; CCNP_data$YSR_67<-NA; CCNP_data$YSR_68<-NA; CCNP_data$YSR_69<-NA; CCNP_data$YSR_70<-NA;
CCNP_data$YSR_71<-NA; CCNP_data$YSR_72<-NA; CCNP_data$YSR_73<-NA; CCNP_data$YSR_74<-NA; CCNP_data$YSR_75<-NA; CCNP_data$YSR_76<-NA; CCNP_data$YSR_77<-NA; CCNP_data$YSR_78<-NA; CCNP_data$YSR_79<-NA; CCNP_data$YSR_80<-NA;
CCNP_data$YSR_81<-NA; CCNP_data$YSR_82<-NA; CCNP_data$YSR_83<-NA; CCNP_data$YSR_84<-NA; CCNP_data$YSR_85<-NA; CCNP_data$YSR_86<-NA; CCNP_data$YSR_87<-NA; CCNP_data$YSR_88<-NA; CCNP_data$YSR_89<-NA; CCNP_data$YSR_90<-NA;
CCNP_data$YSR_91<-NA; CCNP_data$YSR_92<-NA; CCNP_data$YSR_93<-NA; CCNP_data$YSR_94<-NA; CCNP_data$YSR_95<-NA; CCNP_data$YSR_96<-NA; CCNP_data$YSR_97<-NA; CCNP_data$YSR_98<-NA; CCNP_data$YSR_99<-NA; CCNP_data$YSR_100<-NA;
CCNP_data$YSR_101<-NA; CCNP_data$YSR_102<-NA; CCNP_data$YSR_103<-NA; CCNP_data$YSR_104<-NA; CCNP_data$YSR_105<-NA; CCNP_data$YSR_106<-NA; CCNP_data$YSR_107<-NA; CCNP_data$YSR_108<-NA; CCNP_data$YSR_109<-NA; CCNP_data$YSR_110<-NA; CCNP_data$YSR_111<-NA; CCNP_data$YSR_112<-NA

CCNP_data$TRF_1<-NA; CCNP_data$TRF_2<-NA; CCNP_data$TRF_3<-NA; CCNP_data$TRF_4<-NA; CCNP_data$TRF_5<-NA; CCNP_data$TRF_6<-NA; CCNP_data$TRF_7<-NA; CCNP_data$TRF_8<-NA; CCNP_data$TRF_9<-NA; CCNP_data$TRF_10<-NA;
CCNP_data$TRF_11<-NA; CCNP_data$TRF_12<-NA; CCNP_data$TRF_13<-NA; CCNP_data$TRF_14<-NA; CCNP_data$TRF_15<-NA; CCNP_data$TRF_16<-NA; CCNP_data$TRF_17<-NA; CCNP_data$TRF_18<-NA; CCNP_data$TRF_19<-NA; CCNP_data$TRF_20<-NA;
CCNP_data$TRF_21<-NA; CCNP_data$TRF_22<-NA; CCNP_data$TRF_23<-NA; CCNP_data$TRF_24<-NA; CCNP_data$TRF_25<-NA; CCNP_data$TRF_26<-NA; CCNP_data$TRF_27<-NA; CCNP_data$TRF_28<-NA; CCNP_data$TRF_29<-NA; CCNP_data$TRF_30<-NA;
CCNP_data$TRF_31<-NA; CCNP_data$TRF_32<-NA; CCNP_data$TRF_33<-NA; CCNP_data$TRF_34<-NA; CCNP_data$TRF_35<-NA; CCNP_data$TRF_36<-NA; CCNP_data$TRF_37<-NA; CCNP_data$TRF_38<-NA; CCNP_data$TRF_39<-NA; CCNP_data$TRF_40<-NA;
CCNP_data$TRF_41<-NA; CCNP_data$TRF_42<-NA; CCNP_data$TRF_43<-NA; CCNP_data$TRF_44<-NA; CCNP_data$TRF_45<-NA; CCNP_data$TRF_46<-NA; CCNP_data$TRF_47<-NA; CCNP_data$TRF_48<-NA; CCNP_data$TRF_49<-NA; CCNP_data$TRF_50<-NA;
CCNP_data$TRF_51<-NA; CCNP_data$TRF_52<-NA; CCNP_data$TRF_53<-NA; CCNP_data$TRF_54<-NA; CCNP_data$TRF_55<-NA; CCNP_data$TRF_56<-NA; CCNP_data$TRF_57<-NA; CCNP_data$TRF_58<-NA; CCNP_data$TRF_59<-NA; CCNP_data$TRF_60<-NA;
CCNP_data$TRF_56A<-NA; CCNP_data$TRF_56B<-NA; CCNP_data$TRF_56C<-NA;CCNP_data$TRF_56D<-NA; CCNP_data$TRF_56E<-NA;
CCNP_data$TRF_56F<-NA; CCNP_data$TRF_56G<-NA; CCNP_data$TRF_56H<-NA; 
CCNP_data$TRF_61<-NA; CCNP_data$TRF_62<-NA; CCNP_data$TRF_63<-NA; CCNP_data$TRF_64<-NA; CCNP_data$TRF_65<-NA; CCNP_data$TRF_66<-NA; CCNP_data$TRF_67<-NA; CCNP_data$TRF_68<-NA; CCNP_data$TRF_69<-NA; CCNP_data$TRF_70<-NA;
CCNP_data$TRF_71<-NA; CCNP_data$TRF_72<-NA; CCNP_data$TRF_73<-NA; CCNP_data$TRF_74<-NA; CCNP_data$TRF_75<-NA; CCNP_data$TRF_76<-NA; CCNP_data$TRF_77<-NA; CCNP_data$TRF_78<-NA; CCNP_data$TRF_79<-NA; CCNP_data$TRF_80<-NA;
CCNP_data$TRF_81<-NA; CCNP_data$TRF_82<-NA; CCNP_data$TRF_83<-NA; CCNP_data$TRF_84<-NA; CCNP_data$TRF_85<-NA; CCNP_data$TRF_86<-NA; CCNP_data$TRF_87<-NA; CCNP_data$TRF_88<-NA; CCNP_data$TRF_89<-NA; CCNP_data$TRF_90<-NA;
CCNP_data$TRF_91<-NA; CCNP_data$TRF_92<-NA; CCNP_data$TRF_93<-NA; CCNP_data$TRF_94<-NA; CCNP_data$TRF_95<-NA; CCNP_data$TRF_96<-NA; CCNP_data$TRF_97<-NA; CCNP_data$TRF_98<-NA; CCNP_data$TRF_99<-NA; CCNP_data$TRF_100<-NA;
CCNP_data$TRF_101<-NA; CCNP_data$TRF_102<-NA; CCNP_data$TRF_103<-NA; CCNP_data$TRF_104<-NA; CCNP_data$TRF_105<-NA; CCNP_data$TRF_106<-NA; CCNP_data$TRF_107<-NA; CCNP_data$TRF_108<-NA; CCNP_data$TRF_109<-NA; CCNP_data$TRF_110<-NA; CCNP_data$TRF_111<-NA; CCNP_data$TRF_112<-NA; CCNP_data$TRF_113<-NA

CCNP_data$pSDQ_3<-NA; CCNP_data$pSDQ_8<-NA; CCNP_data$pSDQ_13<-NA; CCNP_data$pSDQ_16<-NA; CCNP_data$pSDQ_24<-NA; CCNP_data$pSDQ_5<-NA; CCNP_data$pSDQ_7<-NA; CCNP_data$pSDQ_12<-NA; CCNP_data$pSDQ_18<-NA; CCNP_data$pSDQ_22<-NA; CCNP_data$pSDQ_2<-NA; CCNP_data$pSDQ_10<-NA; CCNP_data$pSDQ_15<-NA; CCNP_data$pSDQ_21<-NA; CCNP_data$pSDQ_25<-NA; CCNP_data$pSDQ_6<-NA; CCNP_data$pSDQ_11<-NA; CCNP_data$pSDQ_14<-NA; CCNP_data$pSDQ_19<-NA; CCNP_data$pSDQ_23<-NA; CCNP_data$pSDQ_1<-NA; CCNP_data$pSDQ_4<-NA; CCNP_data$pSDQ_9<-NA; CCNP_data$pSDQ_17<-NA; CCNP_data$pSDQ_20<-NA;

CCNP_data$sSDQ_3<-NA; CCNP_data$sSDQ_8<-NA; CCNP_data$sSDQ_13<-NA; CCNP_data$sSDQ_16<-NA; CCNP_data$sSDQ_24<-NA; CCNP_data$sSDQ_5<-NA; CCNP_data$sSDQ_7<-NA; CCNP_data$sSDQ_12<-NA; CCNP_data$sSDQ_18<-NA; CCNP_data$sSDQ_22<-NA; CCNP_data$sSDQ_2<-NA; CCNP_data$sSDQ_10<-NA; CCNP_data$sSDQ_15<-NA; CCNP_data$sSDQ_21<-NA; CCNP_data$sSDQ_25<-NA; CCNP_data$sSDQ_6<-NA; CCNP_data$sSDQ_11<-NA; CCNP_data$sSDQ_14<-NA; CCNP_data$sSDQ_19<-NA; CCNP_data$sSDQ_23<-NA; CCNP_data$sSDQ_1<-NA; CCNP_data$sSDQ_4<-NA; CCNP_data$sSDQ_9<-NA; CCNP_data$sSDQ_17<-NA; CCNP_data$sSDQ_20<-NA;

CCNP_data$tSDQ_3<-NA; CCNP_data$tSDQ_8<-NA; CCNP_data$tSDQ_13<-NA; CCNP_data$tSDQ_16<-NA; CCNP_data$tSDQ_24<-NA; CCNP_data$tSDQ_5<-NA; CCNP_data$tSDQ_7<-NA; CCNP_data$tSDQ_12<-NA; CCNP_data$tSDQ_18<-NA; CCNP_data$tSDQ_22<-NA; CCNP_data$tSDQ_2<-NA; CCNP_data$tSDQ_10<-NA; CCNP_data$tSDQ_15<-NA; CCNP_data$tSDQ_21<-NA; CCNP_data$tSDQ_25<-NA; CCNP_data$tSDQ_6<-NA; CCNP_data$tSDQ_11<-NA; CCNP_data$tSDQ_14<-NA; CCNP_data$tSDQ_19<-NA; CCNP_data$tSDQ_23<-NA; CCNP_data$tSDQ_1<-NA; CCNP_data$tSDQ_4<-NA; CCNP_data$tSDQ_9<-NA; CCNP_data$tSDQ_17<-NA; CCNP_data$tSDQ_20<-NA;

CCNP_data$GOASSESS_SIP_010 <- NA ; CCNP_data$GOASSESS_SIP_007 <- NA ; CCNP_data$GOASSESS_SIP_012 <- NA ; CCNP_data$GOASSESS_SIP_008 <- NA ; CCNP_data$GOASSESS_SIP_013 <- NA ; CCNP_data$GOASSESS_SIP_011 <- NA ; CCNP_data$GOASSESS_SIP_005 <- NA ; CCNP_data$GOASSESS_SIP_006 <- NA ; CCNP_data$GOASSESS_SIP_004 <- NA ; CCNP_data$GOASSESS_SIP_003 <- NA ; CCNP_data$GOASSESS_SIP_009 <- NA ; CCNP_data$GOASSESS_SIP_014 <- NA ; CCNP_data$GOASSESS_PSY_001 <- NA ; CCNP_data$GOASSESS_PSY_060 <- NA ; CCNP_data$GOASSESS_PSY_029 <- NA ; CCNP_data$GOASSESS_SIP_027 <- NA ; CCNP_data$GOASSESS_PSY_070 <- NA ; CCNP_data$GOASSESS_SIP_028 <- NA ; CCNP_data$GOASSESS_PSY_071 <- NA ; CCNP_data$GOASSESS_PSY_050 <- NA ; CCNP_data$GOASSESS_ADD_012 <- NA ; CCNP_data$GOASSESS_ADD_011 <- NA ; CCNP_data$GOASSESS_ADD_016 <- NA ; CCNP_data$GOASSESS_ADD_021 <- NA ; CCNP_data$GOASSESS_ODD_002 <- NA ; CCNP_data$GOASSESS_ODD_003 <- NA ; CCNP_data$GOASSESS_ADD_022 <- NA ; CCNP_data$GOASSESS_ADD_013 <- NA ; CCNP_data$GOASSESS_ADD_014 <- NA ; CCNP_data$GOASSESS_ADD_020 <- NA ; CCNP_data$GOASSESS_ADD_015 <- NA ; CCNP_data$GOASSESS_ODD_001 <- NA ; CCNP_data$GOASSESS_CDD_005 <- NA ; CCNP_data$GOASSESS_ODD_005 <- NA ; CCNP_data$GOASSESS_ODD_006 <- NA ; CCNP_data$GOASSESS_CDD_001 <- NA ; 
CCNP_data$GOASSESS_CDD_003 <- NA ; CCNP_data$GOASSESS_CDD_008 <- NA ; CCNP_data$GOASSESS_CDD_006 <- NA ; CCNP_data$GOASSESS_CDD_007 <- NA ; CCNP_data$GOASSESS_SCR_006 <- NA ; CCNP_data$GOASSESS_CDD_004 <- NA ; CCNP_data$GOASSESS_SIP_038 <- NA ; CCNP_data$GOASSESS_DEP_001 <- NA ; CCNP_data$GOASSESS_DEP_002 <- NA ; CCNP_data$GOASSESS_SUI_002 <- NA ; CCNP_data$GOASSESS_DEP_004 <- NA ; CCNP_data$GOASSESS_SIP_032 <- NA ; 
CCNP_data$GOASSESS_MAN_007 <- NA ; CCNP_data$GOASSESS_DEP_006 <- NA ; CCNP_data$GOASSESS_OCD_001 <- NA ; CCNP_data$GOASSESS_PAN_004 <- NA ; CCNP_data$GOASSESS_PAN_001 <- NA ; CCNP_data$GOASSESS_SCR_007 <- NA ; CCNP_data$GOASSESS_GAD_002 <- NA ; CCNP_data$GOASSESS_OCD_007 <- NA ; CCNP_data$GOASSESS_SUI_001 <- NA ; CCNP_data$GOASSESS_OCD_005 <- NA ; CCNP_data$GOASSESS_PAN_003 <- NA ; CCNP_data$GOASSESS_MAN_005 <- NA ; 
CCNP_data$GOASSESS_GAD_001 <- NA ; CCNP_data$GOASSESS_SIP_033 <- NA ; CCNP_data$GOASSESS_OCD_006 <- NA ; CCNP_data$GOASSESS_OCD_004 <- NA ; CCNP_data$GOASSESS_OCD_016 <- NA ; CCNP_data$GOASSESS_OCD_008 <- NA ; CCNP_data$GOASSESS_OCD_003 <- NA ; CCNP_data$GOASSESS_MAN_004 <- NA ; CCNP_data$GOASSESS_MAN_003 <- NA ; CCNP_data$GOASSESS_OCD_019 <- NA ; CCNP_data$GOASSESS_MAN_002 <- NA ; CCNP_data$GOASSESS_MAN_006 <- NA ; 
CCNP_data$GOASSESS_CDD_002 <- NA ; CCNP_data$GOASSESS_MAN_001 <- NA ; CCNP_data$GOASSESS_SCR_001 <- NA ; CCNP_data$GOASSESS_OCD_002 <- NA ; CCNP_data$GOASSESS_OCD_012 <- NA ; CCNP_data$GOASSESS_SIP_039 <- NA ; CCNP_data$GOASSESS_OCD_018 <- NA ; CCNP_data$GOASSESS_PTD_009 <- NA ; CCNP_data$GOASSESS_SCR_008 <- NA ; CCNP_data$GOASSESS_AGR_006 <- NA ; CCNP_data$GOASSESS_SOC_004 <- NA ; CCNP_data$GOASSESS_AGR_005 <- NA ; 
CCNP_data$GOASSESS_SOC_005 <- NA ; CCNP_data$GOASSESS_AGR_002 <- NA ; CCNP_data$GOASSESS_AGR_008 <- NA ; CCNP_data$GOASSESS_SOC_001 <- NA ; CCNP_data$GOASSESS_AGR_001 <- NA ; CCNP_data$GOASSESS_SOC_003 <- NA ; CCNP_data$GOASSESS_AGR_003 <- NA ; CCNP_data$GOASSESS_AGR_004 <- NA ; CCNP_data$GOASSESS_SOC_002 <- NA ; CCNP_data$GOASSESS_PHB_004 <- NA ; CCNP_data$GOASSESS_SEP_509 <- NA ; CCNP_data$GOASSESS_PHB_007 <- NA ; 
CCNP_data$GOASSESS_AGR_007 <- NA ; CCNP_data$GOASSESS_PHB_006 <- NA ; CCNP_data$GOASSESS_PHB_001 <- NA ; CCNP_data$GOASSESS_OCD_013 <- NA ; CCNP_data$GOASSESS_PHB_002 <- NA ; CCNP_data$GOASSESS_SEP_508 <- NA ; CCNP_data$GOASSESS_PHB_008 <- NA ; CCNP_data$GOASSESS_OCD_011 <- NA ; CCNP_data$GOASSESS_PHB_005 <- NA ; CCNP_data$GOASSESS_OCD_017 <- NA ; CCNP_data$GOASSESS_SEP_500 <- NA ; CCNP_data$GOASSESS_OCD_015 <- NA ; 
CCNP_data$GOASSESS_SEP_511 <- NA ; CCNP_data$GOASSESS_PHB_003 <- NA ; CCNP_data$GOASSESS_OCD_014 <- NA ; CCNP_data$GOASSESS_SEP_510 <- NA ; CCNP_data$GOASSESS_SUI_001_002 <- NA ; CCNP_data$GOASSESS_SUI_003 <- NA ; CCNP_data$GOASSESS_SUI_004 <- NA ; CCNP_data$GOASSESS_SUI_005 <- NA ; CCNP_data$GOASSESS_SUI_006 <- NA ; CCNP_data$GOASSESS_SUI_007 <- NA ; CCNP_data$GOASSESS_SUI_008 <- NA ; CCNP_data$GOASSESS_SUI_009 <- NA ; CCNP_data$SMRY_SUI <- NA

CCNP_data<- CCNP_data %>% dplyr::select(EID,Study,Site, Selection,wave,Age,Age_group_3cat,Gender,Sampling_weight,Birth_weight,Birth_delivery,Birth_premature,Birth_preg_dur,Child_race,IQ,BMI,School_years,School_repet,School_exp,School_susp,Maternal_DIAG_ANY, YSR_1:YSR_112, CBCL_1:CBCL_113,YSR_1:TRF_113, pSDQ_3:tSDQ_20, GOASSESS_SIP_010:SMRY_SUI, DIAG_SEP_ANX, DIAG_SPEC_PHOB, DIAG_SOC_PHOB, DIAG_PANIC, DIAG_AGORAPHOB, DIAG_PTSD, DIAG_OCD, DIAG_GEN_ANX, DIAG_DMDD, DIAG_MANIA, DIAG_ADHD, DIAG_ODD, DIAG_PSYCH, DIAG_DEP, DIAG_CD, DIAG_EAT, DIAG_AUTISM, DIAG_TIC, DIAG_Other_ANX, DIAG_ANY, tSDQ_1:tSDQ_25, sSDQ_1:sSDQ_25, pSDQ_26, pSDQ_26b:pSDQ_26f)

```


# Renaming variables for merging data in ECAS
```{r Renaming variables for merging data in ECAS, message=F, warning=F}
ECAS_data <- import("CBCL_PACCT_R01.xlsx")

ECAS_data<-dplyr::rename(ECAS_data,EID=IDENT_SUBID)
ECAS_data$Study<-"ECAS"
ECAS_data$Site<-"ECAS-1"
ECAS_data$Selection <- "Referred"
ECAS_data$wave <- 1

# CBCL
ECAS_data<-dplyr::rename(ECAS_data,CBCL_1=CBCL_acts_young)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_2=CBCL_allergy) #drinks alcohol without parents'approval
ECAS_data$CBCL_2 <- NA
ECAS_data<-dplyr::rename(ECAS_data,CBCL_3=CBCL_argues)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_4=CBCL_asthma) #fails to finish things he/she starts
ECAS_data$CBCL_4 <- NA
ECAS_data<-dplyr::rename(ECAS_data,CBCL_5=CBCL_behav_opp_sex) #there is very little she enjoys
ECAS_data$CBCL_5 <- NA
ECAS_data<-dplyr::rename(ECAS_data,CBCL_6=CBCL_bowel_movement)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_7=CBCL_bragging)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_8=CBCL_no_concentrate)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_9=CBCL_obsession)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_10=CBCL_restless)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_11=CBCL_clings)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_12=CBCL_loneliness)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_13=CBCL_confused)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_14=CBCL_cries)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_15=CBCL_cruel_to_animal)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_16=CBCL_cruel_to_others)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_17=CBCL_daydreams)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_18=CBCL_attempts_suicide)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_19=CBCL_demands_attention)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_20=CBCL_destroys_own_things)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_21=CBCL_destroys_others_things)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_22=CBCL_disobedient_home)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_23=CBCL_disobedient_school)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_24=CBCL_not_eat_well)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_25=CBCL_not_along_kids)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_26=CBCL_no_guilt_misbeh)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_27=CBCL_jealous)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_28=CBCL_eat_nonfood) #breaks rules at home, school elsewhere
ECAS_data$CBCL_28 <- NA
ECAS_data<-dplyr::rename(ECAS_data,CBCL_29=CBCL_fears_things)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_30=CBCL_fears_school)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_31=CBCL_fears_doing_bad)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_32=CBCL_must_be_perfect)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_33=CBCL_complains_no_love)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_34=CBCL_feels_others_getting_them)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_35=CBCL_feels_worthless)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_36=CBCL_accident_prone)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_37=CBCL_many_fights)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_38=CBCL_get_teased)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_39=CBCL_hangs_wtroubled_others)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_40=CBCL_hears_nonexisting_voices)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_41=CBCL_impulsive)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_42=CBCL_be_alone)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_43=CBCL_lying)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_44=CBCL_bites_fingernails)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_45=CBCL_nervous)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_46=CBCL_twitching)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_47=CBCL_nightmares)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_48=CBCL_not_liked)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_49=CBCL_constipated)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_50=CBCL_too_fearful)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_51=CBCL_dizzy)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_52=CBCL_guilty)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_53=CBCL_overeating)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_54=CBCL_overtired)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_55=CBCL_overweight)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_56A=CBCL_aches)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_56B=CBCL_headaches)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_56C=CBCL_nausea)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_56D=CBCL_problems_eyes)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_56E=CBCL_rashes)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_56F=CBCL_stomachaches)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_56G=CBCL_vomiting)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_56H=CBCL_other_physical)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_57=CBCL_physically_attacks)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_58=CBCL_picks_nose)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_59=CBCL_plays_sexparts_public)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_60=CBCL_plays_sexparts_toomuch)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_61=CBCL_poor_schoolwork)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_62=CBCL_clumsy)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_63=CBCL_play_olderkids)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_64=CBCL_play_youngerkids)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_65=CBCL_refuses_talk)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_66=CBCL_compulsions)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_67=CBCL_runs_from_home)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_68=CBCL_screams)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_69=CBCL_secretive)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_70=CBCL_see_nonexisting)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_71=CBCL_selfconscious)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_72=CBCL_sets_fires)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_73=CBCL_sexual_prob)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_74=CBCL_showing_off)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_75=CBCL_shy)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_76=CBCL_sleeps_less)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_77=CBCL_sleeps_more)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_78=CBCL_smears_bowel_movement) #inattentive/easily distracted
ECAS_data$CBCL_78 <- NA
ECAS_data<-dplyr::rename(ECAS_data,CBCL_79=CBCL_speech_prob)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_80=CBCL_stares_blank)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_81=CBCL_steals_home)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_82=CBCL_steals_outside)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_83=CBCL_stores_notneeded)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_84=CBCL_strange_behav)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_85=CBCL_strange_ideas)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_86=CBCL_stubborn)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_87=CBCL_sudden_mood_changes)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_88=CBCL_sulks)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_89=CBCL_suspicious)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_90=CBCL_swearing)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_91=CBCL_talks_killing_self)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_92=CBCL_talks_in_sleep)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_93=CBCL_talks_much)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_94=CBCL_teases_lot)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_95=CBCL_hot_temper)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_96=CBCL_thinks_sex)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_97=CBCL_threatens_people)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_98=CBCL_thumb_sucking)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_99=CBCL_too_clean) #smokes, chews, or sniffs tobacco
ECAS_data$CBCL_99 <- NA
ECAS_data<-dplyr::rename(ECAS_data,CBCL_100=CBCL_trouble_sleeping)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_101=CBCL_truancy)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_102=CBCL_underactive)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_103=CBCL_unhappy)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_104=CBCL_loud)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_105=CBCL_uses_alcohol)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_106=CBCL_vandalism)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_107=CBCL_wets_self)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_108=CBCL_wets_bed)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_109=CBCL_whining)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_110=CBCL_wishes_oppo_sex)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_111=CBCL_withdrawn)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_112=CBCL_worries)
ECAS_data<-dplyr::rename(ECAS_data,CBCL_113=CBCL_oth_problem)
ECAS_data <-  ECAS_data %>% mutate_at(vars(starts_with("CBCL")),as.numeric) 

ECAS_data<-ECAS_data %>% mutate(CBCL_56A = car::recode(CBCL_56A, "NA=99"))
ECAS_data<-ECAS_data %>% mutate(CBCL_56B = car::recode(CBCL_56B, "NA=99"))
ECAS_data<-ECAS_data %>% mutate(CBCL_56C = car::recode(CBCL_56C, "NA=99"))
ECAS_data<-ECAS_data %>% mutate(CBCL_56D = car::recode(CBCL_56D, "NA=99"))
ECAS_data<-ECAS_data %>% mutate(CBCL_56E = car::recode(CBCL_56E, "NA=99"))
ECAS_data<-ECAS_data %>% mutate(CBCL_56F = car::recode(CBCL_56F, "NA=99"))
ECAS_data<-ECAS_data %>% mutate(CBCL_56G = car::recode(CBCL_56G, "NA=99"))
ECAS_data<-ECAS_data %>% mutate(CBCL_56H = car::recode(CBCL_56H, "NA=99"))
ECAS_data <- ECAS_data %>%  mutate(CBCL_56=
            case_when(CBCL_56A==99 &CBCL_56B==99 &CBCL_56C==99 &CBCL_56D==99 &
                       CBCL_56E==99 &CBCL_56F==99 &CBCL_56G==99 &CBCL_56H==99 ~ NA_real_,
                      (CBCL_56A==2 |CBCL_56B==2 |CBCL_56C==2 |CBCL_56D==2 |
                       CBCL_56E==2 |CBCL_56F==2 |CBCL_56G==2 |CBCL_56H==2) ~ 2,
                      (CBCL_56A==1 |CBCL_56B==1 |CBCL_56C==1 |CBCL_56D==1 |
                       CBCL_56E==1 |CBCL_56F==1 |CBCL_56G==1 |CBCL_56H==1) & 
                       (CBCL_56A!=2 |CBCL_56B!=2 |CBCL_56C!=2 |CBCL_56D!=2 |
                       CBCL_56E!=2 |CBCL_56F!=2 |CBCL_56G!=2 |CBCL_56H!=2) ~ 1,
                       CBCL_56A==0 &CBCL_56B==0 &CBCL_56C==0 &CBCL_56D==0 &
                       CBCL_56E==0 &CBCL_56F==0 &CBCL_56G==0 &CBCL_56H==0 ~ 0))
ECAS_data<-ECAS_data %>% mutate(CBCL_56A = car::recode(CBCL_56A, "99=NA"))
ECAS_data<-ECAS_data %>% mutate(CBCL_56B = car::recode(CBCL_56B, "99=NA"))
ECAS_data<-ECAS_data %>% mutate(CBCL_56C = car::recode(CBCL_56C, "99=NA"))
ECAS_data<-ECAS_data %>% mutate(CBCL_56D = car::recode(CBCL_56D, "99=NA"))
ECAS_data<-ECAS_data %>% mutate(CBCL_56E = car::recode(CBCL_56E, "99=NA"))
ECAS_data<-ECAS_data %>% mutate(CBCL_56F = car::recode(CBCL_56F, "99=NA"))
ECAS_data<-ECAS_data %>% mutate(CBCL_56G = car::recode(CBCL_56G, "99=NA"))
ECAS_data<-ECAS_data %>% mutate(CBCL_56H = car::recode(CBCL_56H, "99=NA"))

ECAS_data <-  ECAS_data %>% mutate_at(vars(starts_with("CBCL")),ordered) 


# Insert vars to match other data sets

ECAS_data$Age <- NA  
ECAS_data$Age_group_3cat <- NA  
ECAS_data$Gender <- NA  
ECAS_data$Sampling_weight <- NA  
ECAS_data$Birth_weight <- NA  
ECAS_data$Birth_delivery <- NA  
ECAS_data$Birth_premature <- NA 
ECAS_data$Birth_preg_dur <- NA  
ECAS_data$Child_race <- NA  
ECAS_data$IQ <- NA  
ECAS_data$BMI <- NA  
ECAS_data$School_years <- NA  
ECAS_data$School_repet <- NA
ECAS_data$School_exp <- NA
ECAS_data$School_susp <- NA  
ECAS_data$Maternal_DIAG_ANY <- NA

ECAS_data$pSDQ_26 <- NA
ECAS_data$pSDQ_26b <- NA
ECAS_data$pSDQ_26c <- NA
ECAS_data$pSDQ_26d <- NA
ECAS_data$pSDQ_26e <- NA
ECAS_data$pSDQ_26f <- NA

ECAS_data$DIAG_SEP_ANX <- NA  
ECAS_data$DIAG_SPEC_PHOB <- NA  
ECAS_data$DIAG_SOC_PHOB <- NA  
ECAS_data$DIAG_PANIC <- NA 
ECAS_data$DIAG_AGORAPHOB <- NA 
ECAS_data$DIAG_PTSD <- NA  
ECAS_data$DIAG_OCD <- NA 
ECAS_data$DIAG_GEN_ANX <- NA 
ECAS_data$DIAG_DMDD <- NA 
ECAS_data$DIAG_MANIA <- NA 
ECAS_data$DIAG_ADHD <- NA 
ECAS_data$DIAG_ODD <- NA  
ECAS_data$DIAG_PSYCH <- NA  
ECAS_data$DIAG_DEP <- NA 
ECAS_data$DIAG_CD <- NA  
ECAS_data$DIAG_EAT <- NA 
ECAS_data$DIAG_AUTISM <- NA  
ECAS_data$DIAG_TIC <- NA 
ECAS_data$DIAG_Other_ANX <- NA 
ECAS_data$DIAG_ANY <- NA 

ECAS_data$YSR_1<-NA; ECAS_data$YSR_2<-NA; ECAS_data$YSR_3<-NA; ECAS_data$YSR_4<-NA; ECAS_data$YSR_5<-NA; ECAS_data$YSR_6<-NA; ECAS_data$YSR_7<-NA; ECAS_data$YSR_8<-NA; ECAS_data$YSR_9<-NA; ECAS_data$YSR_10<-NA;
ECAS_data$YSR_11<-NA; ECAS_data$YSR_12<-NA; ECAS_data$YSR_13<-NA; ECAS_data$YSR_14<-NA; ECAS_data$YSR_15<-NA; ECAS_data$YSR_16<-NA; ECAS_data$YSR_17<-NA; ECAS_data$YSR_18<-NA; ECAS_data$YSR_19<-NA; ECAS_data$YSR_20<-NA;
ECAS_data$YSR_21<-NA; ECAS_data$YSR_22<-NA; ECAS_data$YSR_23<-NA; ECAS_data$YSR_24<-NA; ECAS_data$YSR_25<-NA; ECAS_data$YSR_26<-NA; ECAS_data$YSR_27<-NA; ECAS_data$YSR_28<-NA; ECAS_data$YSR_29<-NA; ECAS_data$YSR_30<-NA;
ECAS_data$YSR_31<-NA; ECAS_data$YSR_32<-NA; ECAS_data$YSR_33<-NA; ECAS_data$YSR_34<-NA; ECAS_data$YSR_35<-NA; ECAS_data$YSR_36<-NA; ECAS_data$YSR_37<-NA; ECAS_data$YSR_38<-NA; ECAS_data$YSR_39<-NA; ECAS_data$YSR_40<-NA;
ECAS_data$YSR_41<-NA; ECAS_data$YSR_42<-NA; ECAS_data$YSR_43<-NA; ECAS_data$YSR_44<-NA; ECAS_data$YSR_45<-NA; ECAS_data$YSR_46<-NA; ECAS_data$YSR_47<-NA; ECAS_data$YSR_48<-NA; ECAS_data$YSR_49<-NA; ECAS_data$YSR_50<-NA;
ECAS_data$YSR_51<-NA; ECAS_data$YSR_52<-NA; ECAS_data$YSR_53<-NA; ECAS_data$YSR_54<-NA; ECAS_data$YSR_55<-NA; ECAS_data$YSR_56<-NA; ECAS_data$YSR_57<-NA; ECAS_data$YSR_58<-NA; ECAS_data$YSR_59<-NA; ECAS_data$YSR_60<-NA;
ECAS_data$YSR_56A<-NA; ECAS_data$YSR_56B<-NA; ECAS_data$YSR_56C<-NA;ECAS_data$YSR_56D<-NA; ECAS_data$YSR_56E<-NA;
ECAS_data$YSR_56F<-NA; ECAS_data$YSR_56G<-NA; ECAS_data$YSR_56H<-NA; 
ECAS_data$YSR_61<-NA; ECAS_data$YSR_62<-NA; ECAS_data$YSR_63<-NA; ECAS_data$YSR_64<-NA; ECAS_data$YSR_65<-NA; ECAS_data$YSR_66<-NA; ECAS_data$YSR_67<-NA; ECAS_data$YSR_68<-NA; ECAS_data$YSR_69<-NA; ECAS_data$YSR_70<-NA;
ECAS_data$YSR_71<-NA; ECAS_data$YSR_72<-NA; ECAS_data$YSR_73<-NA; ECAS_data$YSR_74<-NA; ECAS_data$YSR_75<-NA; ECAS_data$YSR_76<-NA; ECAS_data$YSR_77<-NA; ECAS_data$YSR_78<-NA; ECAS_data$YSR_79<-NA; ECAS_data$YSR_80<-NA;
ECAS_data$YSR_81<-NA; ECAS_data$YSR_82<-NA; ECAS_data$YSR_83<-NA; ECAS_data$YSR_84<-NA; ECAS_data$YSR_85<-NA; ECAS_data$YSR_86<-NA; ECAS_data$YSR_87<-NA; ECAS_data$YSR_88<-NA; ECAS_data$YSR_89<-NA; ECAS_data$YSR_90<-NA;
ECAS_data$YSR_91<-NA; ECAS_data$YSR_92<-NA; ECAS_data$YSR_93<-NA; ECAS_data$YSR_94<-NA; ECAS_data$YSR_95<-NA; ECAS_data$YSR_96<-NA; ECAS_data$YSR_97<-NA; ECAS_data$YSR_98<-NA; ECAS_data$YSR_99<-NA; ECAS_data$YSR_100<-NA;
ECAS_data$YSR_101<-NA; ECAS_data$YSR_102<-NA; ECAS_data$YSR_103<-NA; ECAS_data$YSR_104<-NA; ECAS_data$YSR_105<-NA; ECAS_data$YSR_106<-NA; ECAS_data$YSR_107<-NA; ECAS_data$YSR_108<-NA; ECAS_data$YSR_109<-NA; ECAS_data$YSR_110<-NA; ECAS_data$YSR_111<-NA; ECAS_data$YSR_112<-NA

ECAS_data$TRF_1<-NA; ECAS_data$TRF_2<-NA; ECAS_data$TRF_3<-NA; ECAS_data$TRF_4<-NA; ECAS_data$TRF_5<-NA; ECAS_data$TRF_6<-NA; ECAS_data$TRF_7<-NA; ECAS_data$TRF_8<-NA; ECAS_data$TRF_9<-NA; ECAS_data$TRF_10<-NA;
ECAS_data$TRF_11<-NA; ECAS_data$TRF_12<-NA; ECAS_data$TRF_13<-NA; ECAS_data$TRF_14<-NA; ECAS_data$TRF_15<-NA; ECAS_data$TRF_16<-NA; ECAS_data$TRF_17<-NA; ECAS_data$TRF_18<-NA; ECAS_data$TRF_19<-NA; ECAS_data$TRF_20<-NA;
ECAS_data$TRF_21<-NA; ECAS_data$TRF_22<-NA; ECAS_data$TRF_23<-NA; ECAS_data$TRF_24<-NA; ECAS_data$TRF_25<-NA; ECAS_data$TRF_26<-NA; ECAS_data$TRF_27<-NA; ECAS_data$TRF_28<-NA; ECAS_data$TRF_29<-NA; ECAS_data$TRF_30<-NA;
ECAS_data$TRF_31<-NA; ECAS_data$TRF_32<-NA; ECAS_data$TRF_33<-NA; ECAS_data$TRF_34<-NA; ECAS_data$TRF_35<-NA; ECAS_data$TRF_36<-NA; ECAS_data$TRF_37<-NA; ECAS_data$TRF_38<-NA; ECAS_data$TRF_39<-NA; ECAS_data$TRF_40<-NA;
ECAS_data$TRF_41<-NA; ECAS_data$TRF_42<-NA; ECAS_data$TRF_43<-NA; ECAS_data$TRF_44<-NA; ECAS_data$TRF_45<-NA; ECAS_data$TRF_46<-NA; ECAS_data$TRF_47<-NA; ECAS_data$TRF_48<-NA; ECAS_data$TRF_49<-NA; ECAS_data$TRF_50<-NA;
ECAS_data$TRF_51<-NA; ECAS_data$TRF_52<-NA; ECAS_data$TRF_53<-NA; ECAS_data$TRF_54<-NA; ECAS_data$TRF_55<-NA; ECAS_data$TRF_56<-NA; ECAS_data$TRF_57<-NA; ECAS_data$TRF_58<-NA; ECAS_data$TRF_59<-NA; ECAS_data$TRF_60<-NA;
ECAS_data$TRF_56A<-NA; ECAS_data$TRF_56B<-NA; ECAS_data$TRF_56C<-NA;ECAS_data$TRF_56D<-NA; ECAS_data$TRF_56E<-NA;
ECAS_data$TRF_56F<-NA; ECAS_data$TRF_56G<-NA; ECAS_data$TRF_56H<-NA; 
ECAS_data$TRF_61<-NA; ECAS_data$TRF_62<-NA; ECAS_data$TRF_63<-NA; ECAS_data$TRF_64<-NA; ECAS_data$TRF_65<-NA; ECAS_data$TRF_66<-NA; ECAS_data$TRF_67<-NA; ECAS_data$TRF_68<-NA; ECAS_data$TRF_69<-NA; ECAS_data$TRF_70<-NA;
ECAS_data$TRF_71<-NA; ECAS_data$TRF_72<-NA; ECAS_data$TRF_73<-NA; ECAS_data$TRF_74<-NA; ECAS_data$TRF_75<-NA; ECAS_data$TRF_76<-NA; ECAS_data$TRF_77<-NA; ECAS_data$TRF_78<-NA; ECAS_data$TRF_79<-NA; ECAS_data$TRF_80<-NA;
ECAS_data$TRF_81<-NA; ECAS_data$TRF_82<-NA; ECAS_data$TRF_83<-NA; ECAS_data$TRF_84<-NA; ECAS_data$TRF_85<-NA; ECAS_data$TRF_86<-NA; ECAS_data$TRF_87<-NA; ECAS_data$TRF_88<-NA; ECAS_data$TRF_89<-NA; ECAS_data$TRF_90<-NA;
ECAS_data$TRF_91<-NA; ECAS_data$TRF_92<-NA; ECAS_data$TRF_93<-NA; ECAS_data$TRF_94<-NA; ECAS_data$TRF_95<-NA; ECAS_data$TRF_96<-NA; ECAS_data$TRF_97<-NA; ECAS_data$TRF_98<-NA; ECAS_data$TRF_99<-NA; ECAS_data$TRF_100<-NA;
ECAS_data$TRF_101<-NA; ECAS_data$TRF_102<-NA; ECAS_data$TRF_103<-NA; ECAS_data$TRF_104<-NA; ECAS_data$TRF_105<-NA; ECAS_data$TRF_106<-NA; ECAS_data$TRF_107<-NA; ECAS_data$TRF_108<-NA; ECAS_data$TRF_109<-NA; ECAS_data$TRF_110<-NA; ECAS_data$TRF_111<-NA; ECAS_data$TRF_112<-NA; ECAS_data$TRF_113<-NA

ECAS_data$pSDQ_3<-NA; ECAS_data$pSDQ_8<-NA; ECAS_data$pSDQ_13<-NA; ECAS_data$pSDQ_16<-NA; ECAS_data$pSDQ_24<-NA; ECAS_data$pSDQ_5<-NA; ECAS_data$pSDQ_7<-NA; ECAS_data$pSDQ_12<-NA; ECAS_data$pSDQ_18<-NA; ECAS_data$pSDQ_22<-NA; ECAS_data$pSDQ_2<-NA; ECAS_data$pSDQ_10<-NA; ECAS_data$pSDQ_15<-NA; ECAS_data$pSDQ_21<-NA; ECAS_data$pSDQ_25<-NA; ECAS_data$pSDQ_6<-NA; ECAS_data$pSDQ_11<-NA; ECAS_data$pSDQ_14<-NA; ECAS_data$pSDQ_19<-NA; ECAS_data$pSDQ_23<-NA; ECAS_data$pSDQ_1<-NA; ECAS_data$pSDQ_4<-NA; ECAS_data$pSDQ_9<-NA; ECAS_data$pSDQ_17<-NA; ECAS_data$pSDQ_20<-NA;

ECAS_data$sSDQ_3<-NA; ECAS_data$sSDQ_8<-NA; ECAS_data$sSDQ_13<-NA; ECAS_data$sSDQ_16<-NA; ECAS_data$sSDQ_24<-NA; ECAS_data$sSDQ_5<-NA; ECAS_data$sSDQ_7<-NA; ECAS_data$sSDQ_12<-NA; ECAS_data$sSDQ_18<-NA; ECAS_data$sSDQ_22<-NA; ECAS_data$sSDQ_2<-NA; ECAS_data$sSDQ_10<-NA; ECAS_data$sSDQ_15<-NA; ECAS_data$sSDQ_21<-NA; ECAS_data$sSDQ_25<-NA; ECAS_data$sSDQ_6<-NA; ECAS_data$sSDQ_11<-NA; ECAS_data$sSDQ_14<-NA; ECAS_data$sSDQ_19<-NA; ECAS_data$sSDQ_23<-NA; ECAS_data$sSDQ_1<-NA; ECAS_data$sSDQ_4<-NA; ECAS_data$sSDQ_9<-NA; ECAS_data$sSDQ_17<-NA; ECAS_data$sSDQ_20<-NA;

ECAS_data$tSDQ_3<-NA; ECAS_data$tSDQ_8<-NA; ECAS_data$tSDQ_13<-NA; ECAS_data$tSDQ_16<-NA; ECAS_data$tSDQ_24<-NA; ECAS_data$tSDQ_5<-NA; ECAS_data$tSDQ_7<-NA; ECAS_data$tSDQ_12<-NA; ECAS_data$tSDQ_18<-NA; ECAS_data$tSDQ_22<-NA; ECAS_data$tSDQ_2<-NA; ECAS_data$tSDQ_10<-NA; ECAS_data$tSDQ_15<-NA; ECAS_data$tSDQ_21<-NA; ECAS_data$tSDQ_25<-NA; ECAS_data$tSDQ_6<-NA; ECAS_data$tSDQ_11<-NA; ECAS_data$tSDQ_14<-NA; ECAS_data$tSDQ_19<-NA; ECAS_data$tSDQ_23<-NA; ECAS_data$tSDQ_1<-NA; ECAS_data$tSDQ_4<-NA; ECAS_data$tSDQ_9<-NA; ECAS_data$tSDQ_17<-NA; ECAS_data$tSDQ_20<-NA;

ECAS_data$GOASSESS_SIP_010 <- NA ; ECAS_data$GOASSESS_SIP_007 <- NA ; ECAS_data$GOASSESS_SIP_012 <- NA ; ECAS_data$GOASSESS_SIP_008 <- NA ; ECAS_data$GOASSESS_SIP_013 <- NA ; ECAS_data$GOASSESS_SIP_011 <- NA ; ECAS_data$GOASSESS_SIP_005 <- NA ; ECAS_data$GOASSESS_SIP_006 <- NA ; ECAS_data$GOASSESS_SIP_004 <- NA ; ECAS_data$GOASSESS_SIP_003 <- NA ; ECAS_data$GOASSESS_SIP_009 <- NA ; ECAS_data$GOASSESS_SIP_014 <- NA ; ECAS_data$GOASSESS_PSY_001 <- NA ; ECAS_data$GOASSESS_PSY_060 <- NA ; ECAS_data$GOASSESS_PSY_029 <- NA ; ECAS_data$GOASSESS_SIP_027 <- NA ; ECAS_data$GOASSESS_PSY_070 <- NA ; ECAS_data$GOASSESS_SIP_028 <- NA ; ECAS_data$GOASSESS_PSY_071 <- NA ; ECAS_data$GOASSESS_PSY_050 <- NA ; ECAS_data$GOASSESS_ADD_012 <- NA ; ECAS_data$GOASSESS_ADD_011 <- NA ; ECAS_data$GOASSESS_ADD_016 <- NA ; ECAS_data$GOASSESS_ADD_021 <- NA ; ECAS_data$GOASSESS_ODD_002 <- NA ; ECAS_data$GOASSESS_ODD_003 <- NA ; ECAS_data$GOASSESS_ADD_022 <- NA ; ECAS_data$GOASSESS_ADD_013 <- NA ; ECAS_data$GOASSESS_ADD_014 <- NA ; ECAS_data$GOASSESS_ADD_020 <- NA ; ECAS_data$GOASSESS_ADD_015 <- NA ; ECAS_data$GOASSESS_ODD_001 <- NA ; ECAS_data$GOASSESS_CDD_005 <- NA ; ECAS_data$GOASSESS_ODD_005 <- NA ; ECAS_data$GOASSESS_ODD_006 <- NA ; ECAS_data$GOASSESS_CDD_001 <- NA ; 
ECAS_data$GOASSESS_CDD_003 <- NA ; ECAS_data$GOASSESS_CDD_008 <- NA ; ECAS_data$GOASSESS_CDD_006 <- NA ; ECAS_data$GOASSESS_CDD_007 <- NA ; ECAS_data$GOASSESS_SCR_006 <- NA ; ECAS_data$GOASSESS_CDD_004 <- NA ; ECAS_data$GOASSESS_SIP_038 <- NA ; ECAS_data$GOASSESS_DEP_001 <- NA ; ECAS_data$GOASSESS_DEP_002 <- NA ; ECAS_data$GOASSESS_SUI_002 <- NA ; ECAS_data$GOASSESS_DEP_004 <- NA ; ECAS_data$GOASSESS_SIP_032 <- NA ; 
ECAS_data$GOASSESS_MAN_007 <- NA ; ECAS_data$GOASSESS_DEP_006 <- NA ; ECAS_data$GOASSESS_OCD_001 <- NA ; ECAS_data$GOASSESS_PAN_004 <- NA ; ECAS_data$GOASSESS_PAN_001 <- NA ; ECAS_data$GOASSESS_SCR_007 <- NA ; ECAS_data$GOASSESS_GAD_002 <- NA ; ECAS_data$GOASSESS_OCD_007 <- NA ; ECAS_data$GOASSESS_SUI_001 <- NA ; ECAS_data$GOASSESS_OCD_005 <- NA ; ECAS_data$GOASSESS_PAN_003 <- NA ; ECAS_data$GOASSESS_MAN_005 <- NA ; 
ECAS_data$GOASSESS_GAD_001 <- NA ; ECAS_data$GOASSESS_SIP_033 <- NA ; ECAS_data$GOASSESS_OCD_006 <- NA ; ECAS_data$GOASSESS_OCD_004 <- NA ; ECAS_data$GOASSESS_OCD_016 <- NA ; ECAS_data$GOASSESS_OCD_008 <- NA ; ECAS_data$GOASSESS_OCD_003 <- NA ; ECAS_data$GOASSESS_MAN_004 <- NA ; ECAS_data$GOASSESS_MAN_003 <- NA ; ECAS_data$GOASSESS_OCD_019 <- NA ; ECAS_data$GOASSESS_MAN_002 <- NA ; ECAS_data$GOASSESS_MAN_006 <- NA ; 
ECAS_data$GOASSESS_CDD_002 <- NA ; ECAS_data$GOASSESS_MAN_001 <- NA ; ECAS_data$GOASSESS_SCR_001 <- NA ; ECAS_data$GOASSESS_OCD_002 <- NA ; ECAS_data$GOASSESS_OCD_012 <- NA ; ECAS_data$GOASSESS_SIP_039 <- NA ; ECAS_data$GOASSESS_OCD_018 <- NA ; ECAS_data$GOASSESS_PTD_009 <- NA ; ECAS_data$GOASSESS_SCR_008 <- NA ; ECAS_data$GOASSESS_AGR_006 <- NA ; ECAS_data$GOASSESS_SOC_004 <- NA ; ECAS_data$GOASSESS_AGR_005 <- NA ; 
ECAS_data$GOASSESS_SOC_005 <- NA ; ECAS_data$GOASSESS_AGR_002 <- NA ; ECAS_data$GOASSESS_AGR_008 <- NA ; ECAS_data$GOASSESS_SOC_001 <- NA ; ECAS_data$GOASSESS_AGR_001 <- NA ; ECAS_data$GOASSESS_SOC_003 <- NA ; ECAS_data$GOASSESS_AGR_003 <- NA ; ECAS_data$GOASSESS_AGR_004 <- NA ; ECAS_data$GOASSESS_SOC_002 <- NA ; ECAS_data$GOASSESS_PHB_004 <- NA ; ECAS_data$GOASSESS_SEP_509 <- NA ; ECAS_data$GOASSESS_PHB_007 <- NA ; 
ECAS_data$GOASSESS_AGR_007 <- NA ; ECAS_data$GOASSESS_PHB_006 <- NA ; ECAS_data$GOASSESS_PHB_001 <- NA ; ECAS_data$GOASSESS_OCD_013 <- NA ; ECAS_data$GOASSESS_PHB_002 <- NA ; ECAS_data$GOASSESS_SEP_508 <- NA ; ECAS_data$GOASSESS_PHB_008 <- NA ; ECAS_data$GOASSESS_OCD_011 <- NA ; ECAS_data$GOASSESS_PHB_005 <- NA ; ECAS_data$GOASSESS_OCD_017 <- NA ; ECAS_data$GOASSESS_SEP_500 <- NA ; ECAS_data$GOASSESS_OCD_015 <- NA ; 
ECAS_data$GOASSESS_SEP_511 <- NA ; ECAS_data$GOASSESS_PHB_003 <- NA ; ECAS_data$GOASSESS_OCD_014 <- NA ; ECAS_data$GOASSESS_SEP_510 <- NA ; ECAS_data$GOASSESS_SUI_001_002 <- NA ; ECAS_data$GOASSESS_SUI_003 <- NA ; ECAS_data$GOASSESS_SUI_004 <- NA ; ECAS_data$GOASSESS_SUI_005 <- NA ; ECAS_data$GOASSESS_SUI_006 <- NA ; ECAS_data$GOASSESS_SUI_007 <- NA ; ECAS_data$GOASSESS_SUI_008 <- NA ; ECAS_data$GOASSESS_SUI_009 <- NA ; ECAS_data$SMRY_SUI <- NA

ECAS_data<- ECAS_data %>% dplyr::select(EID,Study,Site, Selection,wave,Age,Age_group_3cat,Gender,Sampling_weight,Birth_weight,Birth_delivery,Birth_premature,Birth_preg_dur,Child_race,IQ,BMI,School_years,School_repet,School_exp,School_susp,Maternal_DIAG_ANY, YSR_1:YSR_112, CBCL_1:CBCL_113, CBCL_56,YSR_1:TRF_113, pSDQ_3:tSDQ_20, pSDQ_26, pSDQ_26b:pSDQ_26f, GOASSESS_SIP_010:SMRY_SUI, DIAG_SEP_ANX, DIAG_SPEC_PHOB, DIAG_SOC_PHOB, DIAG_PANIC, DIAG_AGORAPHOB, DIAG_PTSD, DIAG_OCD, DIAG_GEN_ANX, DIAG_DMDD, DIAG_MANIA, DIAG_ADHD, DIAG_ODD, DIAG_PSYCH, DIAG_DEP, DIAG_CD, DIAG_EAT, DIAG_AUTISM, DIAG_TIC, DIAG_Other_ANX, DIAG_ANY, tSDQ_1:tSDQ_25, sSDQ_1:sSDQ_25)

# Testing if names match among data sets - see error 
hbn_var_list <- list(names(HBN_data)); hbn_var_list <- hbn_var_list[[1]] 
ECAS_data_vars<- ECAS_data %>% dplyr::select(hbn_var_list) 
rm(hbn_var_list, ECAS_data_vars)
```


# Processing merged dataset
```{r processing merged dataset, message=F, warning=F}
# Append datasets
mydata<-rbind(HBN_data, BHRC_data, PNC_data, NKI_data, CCNP_data, ECAS_data)
mydata<-mydata %>% mutate(CBCL_24 = car::recode(CBCL_24, "4=2"))
mydata<-mydata %>% mutate(CBCL_29 = car::recode(CBCL_29, "10=2"))
mydata<-mydata %>% mutate(CBCL_52 = car::recode(CBCL_52, "99=NA"))
mydata<-mydata %>% mutate(CBCL_40 = car::recode(CBCL_40, "11=2"))

# New age group
mydata<-mydata %>% mutate(Age_group_2cat = case_when(Age>=5 & Age<11 ~ "5_to_10", 
                                                      Age>=11 ~ "11_or_higher"))
mydata$Age_group_2cat <- ordered(mydata$Age_group_2cat, levels = c("5_to_10", "11_or_higher")) 

# Educational level - still in primary or >= secondary level 
mydata<-mydata %>% mutate(Educational_level = case_when(
  (School_years>=0 & School_years<9 & Study!="BHRC") | (School_years>=0 & School_years<10 & Study=="BHRC") ~ "Primary school", 
  (School_years>=9 & Study!="BHRC") | (School_years>=10 & Study=="BHRC") ~ "Secondary school"))
mydata$Educational_level <- ordered(mydata$Educational_level, levels = c("Primary school", "Secondary school")) 

# IQ groups
mydata<-mydata %>% mutate(IQ_group = case_when(IQ>=0 & IQ<90 ~ "Below average", 
                                               IQ>=90 & IQ<110 ~ "Average",
                                               IQ>=110 ~ "Above average"))
mydata$IQ_group <- ordered(mydata$IQ_group, levels = c("Below average", "Average", "Above average")) 

# Race/ethnicityin two categories
mydata <- mydata %>% mutate(Child_race_2cat=car::recode(Child_race,"'White'='White';'Black'='Non-White'; 'Mixed'='Non-White';'Asian'='Non-White'; 'Asian'='Non-White'; 'Native'='Non-White'; 'Other'='Non-White'; 'Unknown'='Non-White'"))

# BMI according to WHO classification 
## Reference: https://www.who.int/growthref/who2007_bmi_for_age/en/
mydata <- mydata %>% mutate(BMI_cat=
                     case_when(Gender=="Female" & Age>=5 & Age<6 & BMI<12.7 ~ "Underweight",
                               Gender=="Female" & Age>=5 & Age<6 & BMI>=12.7 & BMI<17.0 ~ "Normal",
                               Gender=="Female" & Age>=5 & Age<6 & BMI>=17.0 & BMI<19.2 ~ "Overweight",
                               Gender=="Female" & Age>=5 & Age<6 & BMI>=19.2 ~ "Obese",
                               Gender=="Female" & Age>=6 & Age<7 & BMI<12.7 ~ "Underweight",
                               Gender=="Female" & Age>=6 & Age<7 & BMI>=12.7 & BMI<17.3 ~ "Normal",
                               Gender=="Female" & Age>=6 & Age<7 & BMI>=17.3 & BMI<19.7 ~ "Overweight",
                               Gender=="Female" & Age>=6 & Age<7 & BMI>=19.7 ~ "Obese",
                               Gender=="Female" & Age>=7 & Age<8 & BMI<12.9 ~ "Underweight",
                               Gender=="Female" & Age>=7 & Age<8 & BMI>=12.9 & BMI<17.7 ~ "Normal",
                               Gender=="Female" & Age>=7 & Age<8 & BMI>=17.7 & BMI<20.5 ~ "Overweight",
                               Gender=="Female" & Age>=7 & Age<8 & BMI>=20.5 ~ "Obese",
                               Gender=="Female" & Age>=8 & Age<9 & BMI<13.1 ~ "Underweight",
                               Gender=="Female" & Age>=8 & Age<9 & BMI>=13.1 & BMI<18.3 ~ "Normal",
                               Gender=="Female" & Age>=8 & Age<9 & BMI>=18.3 & BMI<21.4 ~ "Overweight",
                               Gender=="Female" & Age>=8 & Age<9 & BMI>=21.4 ~ "Obese",
                               Gender=="Female" & Age>=9 & Age<10 & BMI<13.4 ~ "Underweight",
                               Gender=="Female" & Age>=9 & Age<10 & BMI>=13.4 & BMI<19.0 ~ "Normal",
                               Gender=="Female" & Age>=9 & Age<10 & BMI>=19.0 & BMI<22.5 ~ "Overweight",
                               Gender=="Female" & Age>=9 & Age<10 & BMI>=22.5 ~ "Obese",
                               Gender=="Female" & Age>=10 & Age<11 & BMI<13.8 ~ "Underweight",
                               Gender=="Female" & Age>=10 & Age<11 & BMI>=13.8 & BMI<19.8 ~ "Normal",
                               Gender=="Female" & Age>=10 & Age<11 & BMI>=19.8 & BMI<23.6 ~ "Overweight",
                               Gender=="Female" & Age>=10 & Age<11 & BMI>=23.6 ~ "Obese",
                               Gender=="Female" & Age>=11 & Age<12 & BMI<14.3 ~ "Underweight",
                               Gender=="Female" & Age>=11 & Age<12 & BMI>=14.3 & BMI<20.7 ~ "Normal",
                               Gender=="Female" & Age>=11 & Age<12 & BMI>=20.7 & BMI<24.9 ~ "Overweight",
                               Gender=="Female" & Age>=11 & Age<12 & BMI>=24.9 ~ "Obese",
                               Gender=="Female" & Age>=12 & Age<13 & BMI<14.9 ~ "Underweight",
                               Gender=="Female" & Age>=12 & Age<13 & BMI>=14.9 & BMI<21.7 ~ "Normal",
                               Gender=="Female" & Age>=12 & Age<13 & BMI>=21.7 & BMI<26.1 ~ "Overweight",
                               Gender=="Female" & Age>=12 & Age<13 & BMI>=26.1 ~ "Obese",
                               Gender=="Female" & Age>=13 & Age<14 & BMI<15.4 ~ "Underweight",
                               Gender=="Female" & Age>=13 & Age<14 & BMI>=15.4 & BMI<22.7 ~ "Normal",
                               Gender=="Female" & Age>=13 & Age<14 & BMI>=22.7 & BMI<27.2 ~ "Overweight",
                               Gender=="Female" & Age>=13 & Age<14 & BMI>=27.2 ~ "Obese",
                               Gender=="Female" & Age>=14 & Age<15 & BMI<15.8 ~ "Underweight",
                               Gender=="Female" & Age>=14 & Age<15 & BMI>=15.8 & BMI<23.5 ~ "Normal",
                               Gender=="Female" & Age>=14 & Age<15 & BMI>=23.5 & BMI<28.2 ~ "Overweight",
                               Gender=="Female" & Age>=14 & Age<15 & BMI>=28.2 ~ "Obese",
                               Gender=="Female" & Age>=15 & Age<16 & BMI<16.2 ~ "Underweight",
                               Gender=="Female" & Age>=15 & Age<16 & BMI>=16.2 & BMI<24.1 ~ "Normal",
                               Gender=="Female" & Age>=15 & Age<16 & BMI>=24.1 & BMI<28.8 ~ "Overweight",
                               Gender=="Female" & Age>=15 & Age<16 & BMI>=28.8 ~ "Obese",
                               Gender=="Female" & Age>=16 & Age<17 & BMI<16.3 ~ "Underweight",
                               Gender=="Female" & Age>=16 & Age<17 & BMI>=16.3 & BMI<24.5 ~ "Normal",
                               Gender=="Female" & Age>=16 & Age<17 & BMI>=24.5 & BMI<29.3 ~ "Overweight",
                               Gender=="Female" & Age>=16 & Age<17 & BMI>=29.3 ~ "Obese",
                               Gender=="Female" & Age>=17 & Age<18 & BMI<16.4 ~ "Underweight",
                               Gender=="Female" & Age>=17 & Age<18 & BMI>=16.4 & BMI<24.8 ~ "Normal",
                               Gender=="Female" & Age>=17 & Age<18 & BMI>=24.8 & BMI<29.5 ~ "Overweight",
                               Gender=="Female" & Age>=17 & Age<18 & BMI>=29.5 ~ "Obese",
                               Gender=="Female" & Age>=18 & Age<19 & BMI<16.5 ~ "Underweight",
                               Gender=="Female" & Age>=18 & Age<19 & BMI>=16.5 & BMI<25.0 ~ "Normal",
                               Gender=="Female" & Age>=18 & Age<19 & BMI>=25.0 & BMI<29.7 ~ "Overweight",
                               Gender=="Female" & Age>=18 & Age<19 & BMI>=29.7 ~ "Obese",
                               Gender=="Female" & Age>=19 & BMI<16.5 ~ "Underweight",
                               Gender=="Female" & Age>=19 & BMI>=16.5 & BMI<25.0 ~ "Normal",
                               Gender=="Female" & Age>=19 & BMI>=25.0 & BMI<29.7 ~ "Overweight",
                               Gender=="Female" & Age>=19 & BMI>=29.7 ~ "Obese",
                               Gender=="Male" & Age>=5 & Age<6 & BMI<13.0 ~ "Underweight",
                               Gender=="Male" & Age>=13 & Age<6 & BMI>=13.0 & BMI<16.7 ~ "Normal",
                               Gender=="Male" & Age>=13 & Age<6 & BMI>=16.7 & BMI<18.5 ~ "Overweight",
                               Gender=="Male" & Age>=13 & Age<6 & BMI>=18.5 ~ "Obese",
                               Gender=="Male" & Age>=6 & Age<7 & BMI<13.1 ~ "Underweight",
                               Gender=="Male" & Age>=6 & Age<7 & BMI>=13.1 & BMI<17.0 ~ "Normal",
                               Gender=="Male" & Age>=6 & Age<7 & BMI>=17.0 & BMI<19.0 ~ "Overweight",
                               Gender=="Male" & Age>=6 & Age<7 & BMI>=19.0 ~ "Obese",
                               Gender=="Male" & Age>=7 & Age<8 & BMI<13.3 ~ "Underweight",
                               Gender=="Male" & Age>=7 & Age<8 & BMI>=13.3 & BMI<17.4 ~ "Normal",
                               Gender=="Male" & Age>=7 & Age<8 & BMI>=17.4 & BMI<19.6 ~ "Overweight",
                               Gender=="Male" & Age>=7 & Age<8 & BMI>=19.6 ~ "Obese",
                               Gender=="Male" & Age>=8 & Age<9 & BMI<13.5 ~ "Underweight",
                               Gender=="Male" & Age>=8 & Age<9 & BMI>=13.5 & BMI<17.9 ~ "Normal",
                               Gender=="Male" & Age>=8 & Age<9 & BMI>=17.9 & BMI<20.4 ~ "Overweight",
                               Gender=="Male" & Age>=8 & Age<9 & BMI>=20.4 ~ "Obese",
                               Gender=="Male" & Age>=9 & Age<10 & BMI<13.7 ~ "Underweight",
                               Gender=="Male" & Age>=9 & Age<10 & BMI>=13.7 & BMI<18.4 ~ "Normal",
                               Gender=="Male" & Age>=9 & Age<10 & BMI>=18.4 & BMI<21.3 ~ "Overweight",
                               Gender=="Male" & Age>=9 & Age<10 & BMI>=21.3 ~ "Obese",
                               Gender=="Male" & Age>=10 & Age<11 & BMI<14.0 ~ "Underweight",
                               Gender=="Male" & Age>=10 & Age<11 & BMI>=14.0 & BMI<19.1 ~ "Normal",
                               Gender=="Male" & Age>=10 & Age<11 & BMI>=19.1 & BMI<22.4 ~ "Overweight",
                               Gender=="Male" & Age>=10 & Age<11 & BMI>=22.4 ~ "Obese",
                               Gender=="Male" & Age>=11 & Age<12 & BMI<14.4 ~ "Underweight",
                               Gender=="Male" & Age>=11 & Age<12 & BMI>=14.4 & BMI<19.9 ~ "Normal",
                               Gender=="Male" & Age>=11 & Age<12 & BMI>=19.9 & BMI<23.5 ~ "Overweight",
                               Gender=="Male" & Age>=11 & Age<12 & BMI>=23.5 ~ "Obese",
                               Gender=="Male" & Age>=12 & Age<13 & BMI<14.9 ~ "Underweight",
                               Gender=="Male" & Age>=12 & Age<13 & BMI>=14.9 & BMI<20.8 ~ "Normal",
                               Gender=="Male" & Age>=12 & Age<13 & BMI>=20.8 & BMI<24.7 ~ "Overweight",
                               Gender=="Male" & Age>=12 & Age<13 & BMI>=24.7 ~ "Obese",
                               Gender=="Male" & Age>=13 & Age<14 & BMI<15.4 ~ "Underweight",
                               Gender=="Male" & Age>=13 & Age<14 & BMI>=15.4 & BMI<21.7 ~ "Normal",
                               Gender=="Male" & Age>=13 & Age<14 & BMI>=21.7 & BMI<25.8 ~ "Overweight",
                               Gender=="Male" & Age>=13 & Age<14 & BMI>=25.8 ~ "Obese",
                               Gender=="Male" & Age>=14 & Age<15 & BMI<16.0 ~ "Underweight",
                               Gender=="Male" & Age>=14 & Age<15 & BMI>=16.0 & BMI<22.6 ~ "Normal",
                               Gender=="Male" & Age>=14 & Age<15 & BMI>=22.6 & BMI<26.9 ~ "Overweight",
                               Gender=="Male" & Age>=14 & Age<15 & BMI>=26.9 ~ "Obese",
                               Gender=="Male" & Age>=15 & Age<16 & BMI<16.5 ~ "Underweight",
                               Gender=="Male" & Age>=15 & Age<16 & BMI>=16.5 & BMI<23.5 ~ "Normal",
                               Gender=="Male" & Age>=15 & Age<16 & BMI>=23.5 & BMI<27.8 ~ "Overweight",
                               Gender=="Male" & Age>=15 & Age<16 & BMI>=27.8 ~ "Obese",
                               Gender=="Male" & Age>=16 & Age<17 & BMI<16.9 ~ "Underweight",
                               Gender=="Male" & Age>=16 & Age<17 & BMI>=16.9 & BMI<24.2 ~ "Normal",
                               Gender=="Male" & Age>=16 & Age<17 & BMI>=24.2 & BMI<28.6 ~ "Overweight",
                               Gender=="Male" & Age>=16 & Age<17 & BMI>=28.6 ~ "Obese",
                               Gender=="Male" & Age>=17 & Age<18 & BMI<17.3 ~ "Underweight",
                               Gender=="Male" & Age>=17 & Age<18 & BMI>=17.3 & BMI<24.9 ~ "Normal",
                               Gender=="Male" & Age>=17 & Age<18 & BMI>=24.9 & BMI<29.2 ~ "Overweight",
                               Gender=="Male" & Age>=17 & Age<18 & BMI>=29.2 ~ "Obese",
                               Gender=="Male" & Age>=18 & Age<19 & BMI<17.5 ~ "Underweight",
                               Gender=="Male" & Age>=18 & Age<19 & BMI>=17.5 & BMI<25.4 ~ "Normal",
                               Gender=="Male" & Age>=18 & Age<19 & BMI>=25.4 & BMI<29.7 ~ "Overweight",
                               Gender=="Male" & Age>=18 & Age<19 & BMI>=29.7 ~ "Obese",
                               Gender=="Male" & Age>=19 & BMI<17.6 ~ "Underweight",
                               Gender=="Male" & Age>=19 & BMI>=17.6 & BMI<25.4 ~ "Normal",
                               Gender=="Male" & Age>=19 & BMI>=25.4 & BMI<29.7 ~ "Overweight",
                               Gender=="Male" & Age>=19 & BMI>=29.7 ~ "Obese"))
mydata$BMI_cat <- ordered(mydata$BMI_cat, levels = c("Underweight", "Normal", "Overweight", "Obese")); summary.factor(mydata$BMI_cat) 
```

# Export processed datasets
```{r export processes dataset, message=F, warning=F}
rio::export(mydata, file="RBC_pfactor_harm_data.Rds")
HBN_data <- mydata %>% dplyr::filter(Study=="HBN")
BHRC_data <- mydata %>% dplyr::filter(Study=="BHRC")
PNC_data <- mydata %>% dplyr::filter(Study=="PNC")
CCNP_data <- mydata %>% dplyr::filter(Study=="CCNP")
NKI_data <- mydata %>% dplyr::filter(Study=="NKI")
ECAS_data <- mydata %>% dplyr::filter(Study=="ECAS")
rio::export(BHRC_data, file="HBN_harm_data.Rds")
rio::export(BHRC_data, file="BHRC_harm_data.Rds")
rio::export(PNC_data, file="PNC_harm_data.Rds")
rio::export(CCNP_data, file="CCNP_harm_data.Rds")
rio::export(NKI_data, file="NKI_harm_data.Rds")
rio::export(ECAS_data, file="ECAS_harm_data.Rds")
```

# Visualizing missing data
```{r missing, message=F, warning=F}

#V isualizing missing data
gg_miss_upset(mydata)

#B y study
gg_miss_fct(x = mydata, fct = Study)
```

# Visualizing correlations
```{r cor, message=F, warning=F}
library(ggcorrplot)
#hbn
HBN_data_nomiss<-na.omit(HBN_data)
HBN_data_cor <- round(cor(HBN_data_nomiss[,20:138]), 2)
HBN_data_cor_plot<-ggcorrplot(HBN_data_cor, tl.cex = 1, show.legend = F, outline.col = "white", title = "HBN data w1", 
                         colors = c("#E46726", "white", "#6D9EC1")); 
HBN_data_cor_plot

#BHRC_data
BHRC_data_w1 <- BHRC_data %>% dplyr::filter(wave==1)
BHRC_data_w1_nomiss<-na.omit(BHRC_data_w1)
BHRC_data_w1_cor <- round(cor(BHRC_data_w1_nomiss[,20:138]), 2)
BHRC_data_w1_cor_plot<-ggcorrplot(BHRC_data_w1_cor, tl.cex = 1, show.legend = F, outline.col = "white", title = "BHRC data w1",
                             colors = c("#E46726", "white", "#6D9EC1")); 
BHRC_data_w1_cor_plot

#Arrange plots
gridExtra::grid.arrange(HBN_data_cor_plot,BHRC_data_w1_cor_plot, ncol=2)
```

